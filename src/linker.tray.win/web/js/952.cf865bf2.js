"use strict";(self["webpackChunklinker_web"]=self["webpackChunklinker_web"]||[]).push([[952],{3363:function(e,t,a){a.d(t,{EQ:function(){return o},QI:function(){return s},ZK:function(){return n},gv:function(){return r}});var l=a(4);const s=e=>(0,l.zG)("access/GetAccesss",e),n=e=>(0,l.zG)("access/SetAccess",e),o=()=>(0,l.zG)("access/refresh"),r=e=>(0,l.zG)("access/SetApiPassword",e)},920:function(e,t,a){a.d(t,{BJ:function(){return d},Ce:function(){return m},NS:function(){return o},PY:function(){return u},UB:function(){return v},Vk:function(){return c},aP:function(){return g},ir:function(){return i},lJ:function(){return n},mK:function(){return s},y2:function(){return p},yN:function(){return r}});var l=a(4);const s=(e="0")=>(0,l.zG)("updater/get",e),n=e=>(0,l.zG)("updater/confirm",e),o=e=>(0,l.zG)("updater/exit",e),r=()=>(0,l.zG)("updater/GetSecretKey"),i=e=>(0,l.zG)("updater/SetSecretKey",e),u=e=>(0,l.zG)("updater/SetInterval",e),c=()=>(0,l.zG)("updater/getcurrent"),d=()=>(0,l.zG)("updater/getserver"),p=e=>(0,l.zG)("updater/confirmserver",e),g=()=>(0,l.zG)("updater/exitserver"),v=()=>(0,l.zG)("updater/Subscribe"),m=e=>(0,l.zG)("updater/check",e)},5962:function(e,t,a){a.d(t,{Y:function(){return r},q:function(){return i}});var l=a(3363),s=a(144),n=a(6768);const o=Symbol(),r=()=>{const e=(0,s.KR)({list:{},timer:0,hashcode:0});(0,n.Gt)(o,e);const t=()=>{(0,l.EQ)()},a=()=>{(0,l.QI)(e.value.hashcode.toString()).then((t=>{e.value.hashcode=t.HashCode,t.List&&(e.value.list=t.List),e.value.timer=setTimeout(a,1e3)})).catch((()=>{e.value.timer=setTimeout(a,1e3)}))},r=()=>{clearTimeout(e.value.timer)};return{access:e,_getAccessInfo:a,clearAccessTimeout:r,handleAccesssRefresh:t}},i=()=>(0,n.WQ)(o)},9383:function(e,t,a){a.d(t,{T:function(){return u},d:function(){return i}});var l=a(920),s=a(3830),n=a(144),o=a(6768);const r=Symbol(),i=()=>{const e=(0,s.B)(),t=(0,n.KR)({timer:0,list:{},hashcode:0,current:{Version:"",Msg:[],DateTime:"",Status:0,Length:0,Current:0},subscribeTimer:0,device:{},show:!1});(0,o.Gt)(r,t);const a=()=>{(0,l.mK)(t.value.hashcode.toString()).then((l=>{if(t.value.hashcode=l.HashCode,l.List){const a=Object.values(l.List).filter((e=>!!e.Version))[0];a&&(Object.assign(t.value.current,{DateTime:a.DateTime,Version:a.Version,Status:a.Status,Length:a.Length,Current:a.Current,Msg:a.Msg}),e.value.updater=t.value.current),t.value.list=l.List}t.value.timer=setTimeout(a,800)})).catch((()=>{t.value.timer=setTimeout(a,800)}))},i=()=>{(0,l.UB)().then((()=>{t.value.subscribeTimer=setTimeout(i,5e3)})).catch((()=>{t.value.subscribeTimer=setTimeout(i,5e3)}))},u=()=>{clearTimeout(t.value.timer),clearTimeout(t.value.subscribeTimer)};return{updater:t,_getUpdater:a,_subscribeUpdater:i,clearUpdaterTimeout:u}},u=()=>(0,o.WQ)(r)},5096:function(e,t,a){a.d(t,{A:function(){return p}});var l=a(6768);const s=e=>((0,l.Qi)("data-v-4892cd3c"),e=e(),(0,l.jt)(),e),n=s((()=>(0,l.Lk)("input",{type:"file",id:"file-input"},null,-1)));function o(e,t,a,s,o,r){const i=(0,l.g2)("PictureRounded"),u=(0,l.g2)("el-icon");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("a",{href:"javascript:;",onClick:t[0]||(t[0]=(...e)=>s.handleBg&&s.handleBg(...e))},[(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(i)])),_:1})]),n],64)}var r=a(7477),i=a(2933),u={components:{PictureRounded:r.syp},props:["name"],setup(e){const t=`bg-${e.name}`,a=()=>{localStorage.getItem(t)?i.s.confirm("清除背景？","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{n()})).catch((()=>{})):document.getElementById("file-input").click()},s=e=>{const t=e.target.files[0];if(t)try{const e=new FileReader;e.onload=function(e){n(e.target.result)},e.readAsDataURL(t)}catch(a){}e.target.value=""},n=e=>{e?(document.body.className="sunny",localStorage.setItem(t,e),document.body.style=`background-image:url(${e})`):(document.body.className="",document.body.style="",localStorage.setItem(t,""))};return(0,l.sV)((()=>{document.getElementById("file-input").addEventListener("change",s),n(localStorage.getItem(t))})),{handleBg:a}}},c=a(1241);const d=(0,c.A)(u,[["render",o],["__scopeId","data-v-4892cd3c"]]);var p=d},6158:function(e,t,a){a.d(t,{A:function(){return d}});var l=a(6768);function s(e,t,a,s,n,o){const r=(0,l.g2)("el-checkbox"),i=(0,l.g2)("el-col"),u=(0,l.g2)("el-row"),c=(0,l.g2)("el-checkbox-group");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(i,{span:8},{default:(0,l.k6)((()=>[(0,l.bF)(r,{modelValue:s.state.checkAll,"onUpdate:modelValue":t[0]||(t[0]=e=>s.state.checkAll=e),onChange:s.handleCheckAllChange,label:"全选",indeterminate:s.state.isIndeterminate},null,8,["modelValue","onChange","indeterminate"])])),_:1})])),_:1}),(0,l.bF)(c,{modelValue:s.state.checkList,"onUpdate:modelValue":t[1]||(t[1]=e=>s.state.checkList=e),onChange:s.handleCheckedChange},{default:(0,l.k6)((()=>[(0,l.bF)(u,null,{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.access,((e,t)=>((0,l.uX)(),(0,l.Wv)(i,{key:t,span:8},{default:(0,l.k6)((()=>[(0,l.bF)(r,{value:e.Value,label:e.Text},null,8,["value","label"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["modelValue","onChange"])],64)}a(4114);var n=a(144),o=a(3830),r=a(5962),i={props:["machineid"],setup(e){const t=(0,o.B)(),a=(0,r.q)(),s=(0,l.EW)((()=>{const e=t.value.config.Client.Accesss;return Object.keys(e).reduce(((a,l,s)=>{if(t.value.hasAccess(l)){const t=e[l];t.Key=l,a.push(t)}return a}),[])})),i=(0,n.Kh)({checkList:[t.value.config.Client.Accesss.Api.Value,t.value.config.Client.Accesss.Web.Value,t.value.config.Client.Accesss.NetManager.Value,t.value.config.Client.Accesss.FullManager.Value,t.value.config.Client.Accesss.Transport.Value,t.value.config.Client.Accesss.Action.Value,t.value.config.Client.Accesss.Group.Value],checkAll:!1,isIndeterminate:!1}),u=()=>+i.checkList.reduce(((e,t)=>e|BigInt(t)),BigInt(0)).toString(),c=e=>{const t=e.length;i.checkAll=t===s.value.length,i.isIndeterminate=t>0&&t<s.value.length},d=e=>{i.checkAll=e,i.checkList=e?s.value.map((e=>e.Value)):[],i.isIndeterminate=!1};return(0,l.sV)((()=>{if(a&&a.value.list[e.machineid]){const t=a.value.list[e.machineid];i.checkList=s.value.reduce(((e,a)=>(+(BigInt(t)&BigInt(a.Value)).toString()==a.Value&&e.push(a.Value),e)),[])}c(i.checkList)})),{state:i,access:s,getValue:u,handleCheckAllChange:d,handleCheckedChange:c}}},u=a(1241);const c=(0,u.A)(i,[["render",s],["__scopeId","data-v-7a697708"]]);var d=c},4001:function(e,t,a){a.d(t,{A:function(){return b}});var l=a(6768),s=a(4232);const n=["title"],o={key:0,class:"progress"},r={key:1,class:"progress"};function i(e,t,a,i,u,c){const d=(0,l.g2)("Loading"),p=(0,l.g2)("el-icon"),g=(0,l.g2)("Download"),v=(0,l.g2)("CircleCheck"),m=(0,l.g2)("Refresh");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("a",{href:"javascript:;",class:(0,s.C4)(["download",i.updaterColor]),onClick:t[0]||(t[0]=e=>i.handleUpdate()),title:i.updaterText},[(0,l.Lk)("span",null,[(0,l.Lk)("span",null,(0,s.v_)(i.item.Version),1),i.updater.list[i.item.MachineId]?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[1==i.updater.list[i.item.MachineId].Status?((0,l.uX)(),(0,l.Wv)(p,{key:0,size:"14",class:"loading"},{default:(0,l.k6)((()=>[(0,l.bF)(d)])),_:1})):2==i.updater.list[i.item.MachineId].Status?((0,l.uX)(),(0,l.Wv)(p,{key:1,size:"14"},{default:(0,l.k6)((()=>[(0,l.bF)(g)])),_:1})):3==i.updater.list[i.item.MachineId].Status||5==i.updater.list[i.item.MachineId].Status?((0,l.uX)(),(0,l.CE)(l.FK,{key:2},[(0,l.bF)(p,{size:"14",class:"loading"},{default:(0,l.k6)((()=>[(0,l.bF)(d)])),_:1}),0==i.updater.list[i.item.MachineId].Length?((0,l.uX)(),(0,l.CE)("span",o,"0%")):((0,l.uX)(),(0,l.CE)("span",r,(0,s.v_)(parseInt(i.updater.list[i.item.MachineId].Current/i.updater.list[i.item.MachineId].Length*100))+"%",1))],64)):6==i.updater.list[i.item.MachineId].Status?((0,l.uX)(),(0,l.Wv)(p,{key:3,size:"14",class:"yellow"},{default:(0,l.k6)((()=>[(0,l.bF)(v)])),_:1})):(0,l.Q3)("",!0)],64)):((0,l.uX)(),(0,l.Wv)(p,{key:1,size:"14"},{default:(0,l.k6)((()=>[(0,l.bF)(g)])),_:1}))])],10,n),(0,l.Lk)("a",{href:"javascript:;",class:"download",title:"检查更新",onClick:t[1]||(t[1]=(...e)=>i.handleCheck&&i.handleCheck(...e))},[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(m)])),_:1})])],64)}var u=a(3830),c=a(144),d=a(1219),p=a(2933),g=a(2248),v=a(920),m=a(7477),f=a(9383),h={props:["item","config"],components:{Download:m.f5X,Loading:m.Rhj,CircleCheck:m.rW7,Refresh:m.C42},setup(e){const t=(0,u.B)(),a=(0,l.EW)((()=>t.value.hasAccess("UpdateSelf"))),s=((0,l.EW)((()=>t.value.hasAccess("UpdateOther"))),(0,f.T)()),n=(0,l.EW)((()=>t.value.signin.Version)),o=(0,l.EW)((()=>s.value.current.Version)),r=(0,l.EW)((()=>`${o.value}->${s.value.current.DateTime}\n${s.value.current.Msg.map(((e,t)=>`${t+1}、${e}`)).join("\n")}`)),i=(0,l.EW)((()=>s.value.list[e.item.MachineId]?s.value.list[e.item.MachineId].Status<=2?e.item.Version!=n.value?`与服务器版本(${n.value})不一致，建议更新`:o.value!=e.item.Version?`不是最新版本(${o.value})，建议更新\n${r.value}`:`是最新版本，但我无法阻止你喜欢更新\n${r.value}`:{3:"正在下载",4:"已下载",5:"正在解压",6:"已解压，请重启"}[s.value.list[e.item.MachineId].Status]:"未检测到更新")),m=(0,l.EW)((()=>e.item.Version!=n.value?"red":s.value.list[e.item.MachineId]&&o.value!=e.item.Version?"yellow":"green")),h=()=>{if(s.value.device=e.item,!e.config)return;if(!a.value)return;const t=s.value.list[e.item.MachineId];t?[0,1,3,5].indexOf(t.Status)>=0?d.nk.error("操作中，请稍后!"):6!=t.Status?s.value.show=2==t.Status:p.s.confirm("确定关闭程序吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{exit(e.item.MachineId)})).catch((()=>{})):d.nk.error("未检测到更新")},w=()=>{const t=(0,c.KR)(e.item.MachineId),a=[(0,l.h)(g.P9,{label:`仅检查[${e.item.MachineName}]`,value:e.item.MachineId}),(0,l.h)(g.P9,{label:"仅检查[本组所有]",value:"g-all"})];(0,p.s)({title:"选择检查对象",message:()=>(0,l.h)(g.AV,{modelValue:t.value,placeholder:"请选择",style:"width:20rem;","onUpdate:modelValue":e=>{t.value=e}},a),confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{(0,v.Ce)(t.value==e.item.MachineId?t.value:"")})).catch((()=>{}))};return{item:(0,l.EW)((()=>e.item)),updater:s,updaterText:i,updaterColor:m,handleUpdate:h,handleCheck:w}}},w=a(1241);const k=(0,w.A)(h,[["render",i],["__scopeId","data-v-90c5041c"]]);var b=k},4195:function(e,t,a){a.d(t,{A:function(){return je}});var l=a(6768),s=a(4232),n=a.p+"img/coin.6431311b.svg",o=a.p+"img/qr.a05c5f6e.jpg";const r=e=>((0,l.Qi)("data-v-81a12f1c"),e=e(),(0,l.jt)(),e),i={class:"status-wrap flex"},u={class:"copy"},c=["title"],d=r((()=>(0,l.Lk)("img",{src:n,alt:"memory"},null,-1))),p={href:"https://github.com/snltty/linker",target:"_blank"},g=r((()=>(0,l.Lk)("div",{class:"flex-1"},null,-1))),v={class:"export"},m={class:"api"},f={class:"server"},h=r((()=>(0,l.Lk)("div",{class:"pay"},[(0,l.Lk)("img",{src:o,alt:""})],-1)));function w(e,t,a,n,o,r){const w=(0,l.g2)("Export"),k=(0,l.g2)("Api"),b=(0,l.g2)("Server"),y=(0,l.g2)("el-dialog");return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.Lk)("div",u,[(0,l.Lk)("a",{href:"javascript:;",class:"memory",title:e.$t("status.support"),onClick:t[0]||(t[0]=e=>n.state.showPay=!0)},[d,(0,l.Lk)("span",null,(0,s.v_)(e.$t("status.support")),1)],8,c),(0,l.Lk)("a",p,"©linker "+(0,s.v_)(n.self.Version),1)]),g,(0,l.Lk)("div",v,[(0,l.bF)(w,{config:n.config},null,8,["config"])]),(0,l.Lk)("div",m,[(0,l.bF)(k,{config:n.config},null,8,["config"])]),(0,l.Lk)("div",f,[(0,l.bF)(b,{config:n.config},null,8,["config"])]),(0,l.bF)(y,{modelValue:n.state.showPay,"onUpdate:modelValue":t[1]||(t[1]=e=>n.state.showPay=e),title:e.$t("status.support"),width:"400"},{default:(0,l.k6)((()=>[h])),_:1},8,["modelValue","title"])])}var k=a(144);const b={href:"javascript:;"};function y(e,t,a,n,o,r){const i=(0,l.g2)("Tools"),u=(0,l.g2)("el-icon"),c=(0,l.g2)("el-popconfirm");return n.config?((0,l.uX)(),(0,l.CE)("div",{key:0,class:(0,s.C4)(["status-api-wrap",{connected:n.connected}])},[(0,l.bF)(c,{"confirm-button-text":e.$t("status.apiClear"),"cancel-button-text":e.$t("status.apiAlter"),title:e.$t("status.apiAlterConfirm"),onCancel:n.handleShow,onConfirm:n.handleResetConnect},{reference:(0,l.k6)((()=>[(0,l.Lk)("a",b,[(0,l.bF)(u,{size:"16"},{default:(0,l.k6)((()=>[(0,l.bF)(i)])),_:1}),(0,l.eW)(" "+(0,s.v_)(e.$t("status.api")),1)])])),_:1},8,["confirm-button-text","cancel-button-text","title","onCancel","onConfirm"])],2)):(0,l.Q3)("",!0)}var S=a(3830),C=a(4),B=a(7477),_={components:{Tools:B.S0q},props:["config"],setup(e){const t=(0,S.B)(),a=(0,l.EW)((()=>t.value.api.connected)),s=()=>{localStorage.setItem("api-cache",""),sessionStorage.setItem("api-cache",""),window.location.reload()},n=()=>{(0,C.e3)(),(0,C.a1)(`ws${"https:"===window.location.protocol?"s":""}://${window.location.hostname}:12345`,"snltty")};return{config:e.config,connected:a,handleShow:n,handleResetConnect:s}}},F=a(1241);const V=(0,F.A)(_,[["render",y],["__scopeId","data-v-439c62dc"]]);var $=V;const T={class:"status-server-wrap"};function x(e,t,a,s,n,o){const r=(0,l.g2)("ServerConfig"),i=(0,l.g2)("ServerVersion"),u=(0,l.g2)("ServerFlow");return(0,l.uX)(),(0,l.CE)("div",T,[(0,l.bF)(r,{config:s.config},null,8,["config"]),(0,l.bF)(i,{config:s.config},null,8,["config"]),s.config&&s.hasFlow?((0,l.uX)(),(0,l.Wv)(u,{key:0,config:s.config},null,8,["config"])):(0,l.Q3)("",!0)])}const L=["title"],I={class:"dialog-footer t-c"};function R(e,t,a,n,o,r){const i=(0,l.g2)("Promotion"),u=(0,l.g2)("el-icon"),c=(0,l.g2)("el-input"),d=(0,l.g2)("el-form-item"),p=(0,l.g2)("el-option"),g=(0,l.g2)("el-select"),v=(0,l.g2)("el-form"),m=(0,l.g2)("el-button"),f=(0,l.g2)("el-dialog");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("a",{href:"javascript:;",class:(0,s.C4)({connected:n.state.connected}),title:e.$t("status.messengerChange"),onClick:t[0]||(t[0]=(...e)=>n.handleConfig&&n.handleConfig(...e))},[(0,l.bF)(u,{size:"16"},{default:(0,l.k6)((()=>[(0,l.bF)(i)])),_:1}),(0,l.eW)(),(0,l.Lk)("span",null,(0,s.v_)(e.$t("status.messenger")),1)],10,L),(0,l.bF)(f,{modelValue:n.state.show,"onUpdate:modelValue":t[4]||(t[4]=e=>n.state.show=e),title:e.$t("common.setting"),width:"300","append-to-body":""},{footer:(0,l.k6)((()=>[(0,l.Lk)("div",I,[(0,l.bF)(m,{onClick:t[3]||(t[3]=e=>n.state.show=!1),loading:n.state.loading},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e.$t("common.cancel")),1)])),_:1},8,["loading"]),(0,l.bF)(m,{type:"primary",onClick:n.handleSave,loading:n.state.loading},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e.$t("common.confirm")),1)])),_:1},8,["onClick","loading"])])])),default:(0,l.k6)((()=>[(0,l.Lk)("div",null,[(0,l.bF)(v,{model:n.state.form,rules:n.state.rules,"label-width":"6rem"},{default:(0,l.k6)((()=>[n.hasRenameSelf?((0,l.uX)(),(0,l.Wv)(d,{key:0,label:e.$t("status.messengerName"),prop:"name"},{default:(0,l.k6)((()=>[(0,l.bF)(c,{modelValue:n.state.form.name,"onUpdate:modelValue":t[1]||(t[1]=e=>n.state.form.name=e),maxlength:"32","show-word-limit":""},null,8,["modelValue"])])),_:1},8,["label"])):(0,l.Q3)("",!0),n.hasGroup?((0,l.uX)(),(0,l.Wv)(d,{key:1,label:e.$t("status.messengerGroup"),prop:"groupid"},{default:(0,l.k6)((()=>[(0,l.bF)(g,{modelValue:n.state.groupid,"onUpdate:modelValue":t[2]||(t[2]=e=>n.state.groupid=e),onChange:n.handleGroupChange},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.state.form.groups,(e=>((0,l.uX)(),(0,l.Wv)(p,{key:e.Id,label:e.Name,value:e.Id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1},8,["label"])):(0,l.Q3)("",!0)])),_:1},8,["model","rules"])])])),_:1},8,["modelValue","title"])],64)}var A=a(9299),W=a(1219),E=a(5931),D={components:{Promotion:B.Yk4,CirclePlus:B.HxT},props:["config"],setup(e){const{t:t}=(0,E.s9)(),a=(0,S.B)(),s=(0,l.EW)((()=>a.value.hasAccess("RenameSelf"))),n=(0,l.EW)((()=>a.value.hasAccess("Group"))),o=(0,k.Kh)({show:!1,loading:!1,connected:(0,l.EW)((()=>a.value.signin.Connected)),groupid:a.value.config.Client.Group.Id,form:{name:a.value.config.Client.Name,groups:a.value.config.Client.Groups},rules:{}}),r=()=>{e.config&&(n.value||s.value)&&(o.form.name=a.value.config.Client.Name,o.form.groups=a.value.config.Client.Groups,o.groupid=a.value.config.Client.Group.Id,o.show=!0)},i=e=>{const t=o.form.groups.map(((e,t)=>(e.$index=t,e))).filter((t=>t.Id==e))[0].$index,a=o.form.groups[t];o.form.groups[t]=o.form.groups[0],o.form.groups[0]=a},u=()=>{o.loading=!0,(0,A.rd)(o.form).then((()=>{o.loading=!1,o.show=!1,W.nk.success(t("common.oper")),setTimeout((()=>{window.location.reload()}),1e3)})).catch((e=>{console.log(e),o.loading=!1,W.nk.error(t("common.operFail"))}))};return{config:e.config,hasRenameSelf:s,hasGroup:n,state:o,handleConfig:r,handleSave:u,handleGroupChange:i}}};const z=(0,F.A)(D,[["render",R],["__scopeId","data-v-4c2d9648"]]);var P=z;const K={key:0,class:"flow-wrap"},U=["title"],G=["title"],M=["title"],X=["title"];function O(e,t,a,n,o,r){const i=(0,l.g2)("el-table-column"),u=(0,l.g2)("el-button"),c=(0,l.g2)("el-table"),d=(0,l.g2)("el-dialog"),p=(0,l.g2)("ServerFlowMessenger"),g=(0,l.g2)("ServerFlowSForward"),v=(0,l.g2)("ServerFlowRelay");return(0,l.uX)(),(0,l.CE)(l.FK,null,[n.config?((0,l.uX)(),(0,l.CE)("div",K,[(0,l.Lk)("p",null,[(0,l.eW)((0,s.v_)(e.$t("status.flowOnline"))+" ",1),(0,l.Lk)("a",{href:"javascript:;",title:`${e.$t("status.flowThisServer")}\r\n${e.$t("status.flowOnline")}/${e.$t("status.flowOnline7Day")}`},(0,s.v_)(n.state.overallOnline),9,U),(0,l.Lk)("a",{href:"javascript:;",title:`${e.$t("status.flowAllServer")}\r\n${e.$t("status.flowOnline")}/${e.$t("status.flowOnline7Day")}/${e.$t("status.flowServer")}`},(0,s.v_)(n.state.serverOnline),9,G)]),(0,l.Lk)("p",null,[(0,l.eW)((0,s.v_)(e.$t("status.flowUpload"))+" ",1),(0,l.Lk)("a",{href:"javascript:;",title:`${e.$t("status.flowThisServer")}\r\n${e.$t("status.flowAllSend")}`,onClick:t[0]||(t[0]=(...e)=>n.handleShow&&n.handleShow(...e))},(0,s.v_)(n.state.overallSendtSpeed)+"/s",9,M)]),(0,l.Lk)("p",null,[(0,l.eW)((0,s.v_)(e.$t("status.flowDownload"))+" ",1),(0,l.Lk)("a",{href:"javascript:;",title:`${e.$t("status.flowThisServer")}\r\n${e.$t("status.flowAllReceive")}`,onClick:t[1]||(t[1]=(...e)=>n.handleShow&&n.handleShow(...e))},(0,s.v_)(n.state.overallReceiveSpeed)+"/s",9,X)])])):(0,l.Q3)("",!0),(0,l.bF)(d,{title:n.state.time,"destroy-on-close":"",modelValue:n.state.show,"onUpdate:modelValue":t[2]||(t[2]=e=>n.state.show=e),width:"640"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,[(0,l.bF)(c,{data:n.state.list,border:"",size:"small",width:"100%"},{default:(0,l.k6)((()=>[(0,l.bF)(i,{prop:"text",label:e.$t("status.flowType")},null,8,["label"]),(0,l.bF)(i,{prop:"sendtBytes",label:e.$t("status.flowUpload"),sortable:""},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.sendtBytesText),1)])),_:1},8,["label"]),(0,l.bF)(i,{prop:"sendtSpeed",label:e.$t("status.flowUpload"),sortable:""},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.sendtSpeedText)+"/s",1)])),_:1},8,["label"]),(0,l.bF)(i,{prop:"receiveBytes",label:e.$t("status.flowDownload"),sortable:""},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.receiveBytesText),1)])),_:1},8,["label"]),(0,l.bF)(i,{prop:"receiveSpeed",label:e.$t("status.flowDownload"),sortable:""},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.receiveSpeedText)+"/s",1)])),_:1},8,["label"]),(0,l.bF)(i,{prop:"oper",label:e.$t("status.flowOper"),width:"70"},{default:(0,l.k6)((t=>[t.row.detail?((0,l.uX)(),(0,l.Wv)(u,{key:0,size:"small",onClick:e=>n.handleShowDetail(t.row.id)},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e.$t("status.flowDetail")),1)])),_:2},1032,["onClick"])):(0,l.Q3)("",!0)])),_:1},8,["label"])])),_:1},8,["data"])])])),_:1},8,["title","modelValue"]),n.state.details.Messenger?((0,l.uX)(),(0,l.Wv)(p,{key:1,config:n.config,modelValue:n.state.details.Messenger,"onUpdate:modelValue":t[3]||(t[3]=e=>n.state.details.Messenger=e)},null,8,["config","modelValue"])):(0,l.Q3)("",!0),n.state.details.SForward?((0,l.uX)(),(0,l.Wv)(g,{key:2,config:n.config,modelValue:n.state.details.SForward,"onUpdate:modelValue":t[4]||(t[4]=e=>n.state.details.SForward=e)},null,8,["config","modelValue"])):(0,l.Q3)("",!0),n.state.details.Relay?((0,l.uX)(),(0,l.Wv)(v,{key:3,config:n.config,modelValue:n.state.details.Relay,"onUpdate:modelValue":t[5]||(t[5]=e=>n.state.details.Relay=e)},null,8,["config","modelValue"])):(0,l.Q3)("",!0)],64)}a(4114);const j=()=>(0,C.zG)("flow/GetFlows"),N=()=>(0,C.zG)("flow/GetMessengerFlows"),Q=e=>(0,C.zG)("flow/GetSForwardFlows",e),Y=e=>(0,C.zG)("flow/GetRelayFlows",e);function q(e,t,a,n,o,r){const i=(0,l.g2)("el-table-column"),u=(0,l.g2)("el-table"),c=(0,l.g2)("el-dialog");return(0,l.uX)(),(0,l.Wv)(c,{title:e.$t("status.flowMessenger"),class:"options-center",top:"1vh","destroy-on-close":"",modelValue:n.state.show,"onUpdate:modelValue":t[0]||(t[0]=e=>n.state.show=e),width:"680"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,[(0,l.bF)(u,{data:n.state.list,stripe:"",border:"",size:"small",width:"100%",height:"60vh"},{default:(0,l.k6)((()=>[(0,l.bF)(i,{prop:"id",label:"id",width:"200"}),(0,l.bF)(i,{prop:"sendtBytes",label:e.$t("status.flowUpload"),sortable:""},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.sendtBytesText),1)])),_:1},8,["label"]),(0,l.bF)(i,{prop:"sendtSpeed",label:e.$t("status.flowUpload"),sortable:""},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.sendtSpeedText)+"/s",1)])),_:1},8,["label"]),(0,l.bF)(i,{prop:"receiveBytes",label:e.$t("status.flowDownload"),sortable:""},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.receiveBytesText),1)])),_:1},8,["label"]),(0,l.bF)(i,{prop:"receiveSpeed",label:e.$t("status.flowDownload"),sortable:""},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.receiveSpeedText)+"/s",1)])),_:1},8,["label"])])),_:1},8,["data"])])])),_:1},8,["title","modelValue"])}var H={props:["modelValue","config"],emits:["update:modelValue"],setup(e,{emit:t}){const a=(0,k.Kh)({show:!0,timer:0,list:[],old:null});(0,l.wB)((()=>a.show),(e=>{e||setTimeout((()=>{t("update:modelValue",e)}),300)}));const s={0:"登入信标",1:"客户端列表",2:"客户端删除",4:"客户端改名(转发)",7:"获取服务器版本",8:"客户端搜索ids",9:"客户端id列表",10:"客户端排序",11:"客户端在线",12:"生成客户端id",13:"登入信标V_1_3_1",2001:"外网端口(转发)",2002:"外网端口(转发)",2003:"开始打洞(转发)",2004:"开始打洞(转发)",2005:"打洞失败(转发)",2006:"打洞失败(转发)",2007:"打洞成功(转发)",2008:"打洞成功(转发)",2009:"隧道配置(转发)",2010:"隧道配置(转发)",2012:"隧道同步(转发)",2101:"中继通知(转发)",2102:"中继通知(转发)",2103:"中继请求",2105:"中继连通测试",2201:"运行网卡(转发)",2203:"停止网卡(转发)",2204:"更新网卡",2205:"更新网卡(转发)",2208:"配置网卡网络",2209:"获取网卡网络",2210:"分配IP",2211:"网卡变化",2212:"网卡变化(转发)",2213:"IP续约",2214:"网卡端口转发检测",2215:"网卡端口转发检测(转发)",2301:"添加内网穿透",2302:"移除内网穿透",2303:"通知内网穿透(转发)",2304:"通知内网穿透UDP(转发)",2305:"获取穿透列表(转发)",2401:"测试端口转发(转发)",2403:"获取端口转发(转发)",2507:"同步配置",2508:"同步配置(转发)",2601:"更新信息(转发)",2602:"更新信息(转发)",2603:"确认更新(转发)",2604:"确认更新(转发)",2605:"重启(转发)",2606:"重启",2607:"服务器更新信息",2608:"确认服务器更新",2609:"服务器重启",2610:"订阅更新信息(转发)",2611:"订阅更新信息(转发)",2612:"检查更新",2613:"检查更新(转发)",2701:"服务器流量",2702:"服务器信标流量",2703:"服务器中继流量",2704:"服务器内网穿透流量",2807:"同步配置",2808:"同步配置(转发)",2900:"运行socks5",2901:"运行socks5(转发)",2902:"停止socks5",2903:"停止socks5(转发)",2904:"更新socks5",2905:"更新socks5(转发)",3003:"获取权限",3004:"获取权限(转发)",3005:"更新权限",3006:"更新权限(转发)"},n=()=>{N().then((e=>{const t=a.old||e,l=[];for(let a in e){const n=e[a],r=t[a],i=`[${a}]${s[`${a}`]||"未知"}`;l.push({id:i,sendtBytes:n.SendtBytes,sendtBytesText:o(n.SendtBytes),sendtSpeed:n.SendtBytes-r.SendtBytes,sendtSpeedText:o(n.SendtBytes-r.SendtBytes),receiveBytes:n.ReceiveBytes,receiveBytesText:o(n.ReceiveBytes),receiveSpeed:n.ReceiveBytes-r.ReceiveBytes,receiveSpeedText:o(n.ReceiveBytes-r.ReceiveBytes)})}a.list=l.filter((e=>!!e.id)),a.old=e,a.timer=setTimeout(n,1e3)})).catch((e=>{a.timer=setTimeout(n,1e3)}))},o=e=>{let t=0;while(e>=1024)e/=1024,t++;return`${e.toFixed(2)}${["B","KB","MB","GB","TB"][t]}`};return(0,l.sV)((()=>{n()})),(0,l.hi)((()=>{clearTimeout(a.timer)})),{config:e.config,state:a}}};const J=(0,F.A)(H,[["render",q],["__scopeId","data-v-6cee4920"]]);var Z=J;const ee={class:"head"},te={class:"page t-c"},ae={class:"page-wrap"};function le(e,t,a,n,o,r){const i=(0,l.g2)("el-input"),u=(0,l.g2)("el-table-column"),c=(0,l.g2)("el-table"),d=(0,l.g2)("el-pagination"),p=(0,l.g2)("el-dialog");return(0,l.uX)(),(0,l.Wv)(p,{title:e.$t("status.flowServerForward"),class:"options-center",top:"1vh","destroy-on-close":"",modelValue:n.state.show,"onUpdate:modelValue":t[1]||(t[1]=e=>n.state.show=e),width:"680"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,[(0,l.Lk)("div",ee,[(0,l.bF)(i,{modelValue:n.state.page.Key,"onUpdate:modelValue":t[0]||(t[0]=e=>n.state.page.Key=e),placeholder:e.$t("status.flowSearchDomainPort")},null,8,["modelValue","placeholder"])]),(0,l.bF)(c,{data:n.state.list,stripe:"",border:"",size:"small",width:"100%",height:"60vh",onSortChange:n.handleSort},{default:(0,l.k6)((()=>[(0,l.bF)(u,{prop:"Key",label:e.$t("status.flowSearchDomainPort"),width:"200"},null,8,["label"]),(0,l.bF)(u,{prop:"SendtBytes",label:e.$t("status.flowUpload"),sortable:"custom"},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.SendtBytesText),1)])),_:1},8,["label"]),(0,l.bF)(u,{prop:"DiffSendtBytes",label:e.$t("status.flowUpload"),sortable:"custom"},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.DiffSendtBytesText)+"/s",1)])),_:1},8,["label"]),(0,l.bF)(u,{prop:"ReceiveBytes",label:e.$t("status.flowDownload"),sortable:"custom"},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.ReceiveBytesText),1)])),_:1},8,["label"]),(0,l.bF)(u,{prop:"DiffReceiveBytes",label:e.$t("status.flowDownload"),sortable:"custom"},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.DiffReceiveBytesText)+"/s",1)])),_:1},8,["label"])])),_:1},8,["data","onSortChange"]),(0,l.Lk)("div",te,[(0,l.Lk)("div",ae,[(0,l.bF)(d,{small:"",background:"",layout:"total,prev,pager, next",total:n.state.page.Count,"page-size":n.state.page.PageSize,"current-page":n.state.page.Page,onCurrentChange:n.handlePageChange},null,8,["total","page-size","current-page","onCurrentChange"])])])])])),_:1},8,["title","modelValue"])}var se={props:["modelValue","config"],emits:["update:modelValue"],setup(e,{emit:t}){const a=(0,k.Kh)({show:!0,timer:0,list:[],page:{Key:"",Page:1,PageSize:15,Count:0,Order:1,OrderType:0}});(0,l.wB)((()=>a.show),(e=>{e||setTimeout((()=>{t("update:modelValue",e)}),300)}));const s=()=>{Q({Key:a.page.Key,Page:a.page.Page,PageSize:a.page.PageSize,Order:a.page.Order,OrderType:a.page.OrderType}).then((e=>{try{a.page.Page=e.Page,a.page.PageSize=e.PageSize,a.page.Count=e.Count;const t=[];for(let a=0;a<e.Data.length;a++){const l=e.Data[a];Object.assign(l,{SendtBytesText:n(l.SendtBytes),ReceiveBytesText:n(l.ReceiveBytes),DiffSendtBytesText:n(l.DiffSendtBytes),DiffReceiveBytesText:n(l.DiffReceiveBytes)}),t.push(l)}a.list=t}catch(t){console.log(t)}a.timer=setTimeout(s,1e3)})).catch((e=>{a.timer=setTimeout(s,1e3)}))},n=e=>{let t=0;while(e>=1024)e/=1024,t++;return`${e.toFixed(2)}${["B","KB","MB","GB","TB"][t]}`},o=e=>{e&&(a.page.Page=e)},r=e=>{const t={ascending:1,descending:0}[e.order],l={SendtBytes:1,DiffSendtBytes:2,ReceiveBytes:3,DiffReceiveBytes:4}[e.prop];a.page.Order=l,a.page.OrderType=t};return(0,l.sV)((()=>{s()})),(0,l.hi)((()=>{clearTimeout(a.timer)})),{config:e.config,state:a,handlePageChange:o,handleSort:r}}};const ne=(0,F.A)(se,[["render",le],["__scopeId","data-v-bd2e39b0"]]);var oe=ne;const re={class:"head"},ie={class:"page t-c"},ue={class:"page-wrap"};function ce(e,t,a,n,o,r){const i=(0,l.g2)("el-input"),u=(0,l.g2)("el-table-column"),c=(0,l.g2)("el-table"),d=(0,l.g2)("el-pagination"),p=(0,l.g2)("el-dialog");return(0,l.uX)(),(0,l.Wv)(p,{title:e.$t("status.flowRelay"),class:"options-center",top:"1vh","destroy-on-close":"",modelValue:n.state.show,"onUpdate:modelValue":t[1]||(t[1]=e=>n.state.show=e),width:"680"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,[(0,l.Lk)("div",re,[(0,l.bF)(i,{modelValue:n.state.page.Key,"onUpdate:modelValue":t[0]||(t[0]=e=>n.state.page.Key=e),placeholder:"名字搜索"},null,8,["modelValue"])]),(0,l.bF)(c,{data:n.state.list,stripe:"",border:"",size:"small",width:"100%",height:"60vh",onSortChange:n.handleSort},{default:(0,l.k6)((()=>[(0,l.bF)(u,{prop:"FromName",label:e.$t("status.flowRelaySource"),width:"120"},null,8,["label"]),(0,l.bF)(u,{prop:"ToName",label:e.$t("status.flowRelayTarget"),width:"120"},null,8,["label"]),(0,l.bF)(u,{prop:"SendtBytes",label:e.$t("status.flowUpload"),sortable:"custom"},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.SendtBytesText),1)])),_:1},8,["label"]),(0,l.bF)(u,{prop:"DiffSendtBytes",label:e.$t("status.flowUpload"),sortable:"custom"},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.DiffSendtBytesText)+"/s",1)])),_:1},8,["label"]),(0,l.bF)(u,{prop:"ReceiveBytes",label:e.$t("status.flowDownload"),sortable:"custom"},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.ReceiveBytesText),1)])),_:1},8,["label"]),(0,l.bF)(u,{prop:"DiffReceiveBytes",label:e.$t("status.flowDownload"),sortable:"custom"},{default:(0,l.k6)((e=>[(0,l.Lk)("span",null,(0,s.v_)(e.row.DiffReceiveBytesText)+"/s",1)])),_:1},8,["label"])])),_:1},8,["data","onSortChange"]),(0,l.Lk)("div",ie,[(0,l.Lk)("div",ue,[(0,l.bF)(d,{small:"",background:"",layout:"total,prev,pager, next",total:n.state.page.Count,"page-size":n.state.page.PageSize,"current-page":n.state.page.Page,onCurrentChange:n.handlePageChange},null,8,["total","page-size","current-page","onCurrentChange"])])])])])),_:1},8,["title","modelValue"])}var de={props:["modelValue","config"],emits:["update:modelValue"],setup(e,{emit:t}){const a=(0,k.Kh)({show:!0,timer:0,list:[],page:{Key:"",Page:1,PageSize:15,Count:0,Order:1,OrderType:0}});(0,l.wB)((()=>a.show),(e=>{e||setTimeout((()=>{t("update:modelValue",e)}),300)}));const s=()=>{Y({Key:a.page.Key,Page:a.page.Page,PageSize:a.page.PageSize,Order:a.page.Order,OrderType:a.page.OrderType}).then((e=>{try{a.page.Page=e.Page,a.page.PageSize=e.PageSize,a.page.Count=e.Count;const t=[];for(let a=0;a<e.Data.length;a++){const l=e.Data[a];Object.assign(l,{SendtBytesText:n(l.SendtBytes),ReceiveBytesText:n(l.ReceiveBytes),DiffSendtBytesText:n(l.DiffSendtBytes),DiffReceiveBytesText:n(l.DiffReceiveBytes)}),t.push(l)}a.list=t}catch(t){console.log(t)}a.timer=setTimeout(s,1e3)})).catch((e=>{a.timer=setTimeout(s,1e3)}))},n=e=>{let t=0;while(e>=1024)e/=1024,t++;return`${e.toFixed(2)}${["B","KB","MB","GB","TB"][t]}`},o=e=>{e&&(a.page.Page=e)},r=e=>{const t={ascending:1,descending:0}[e.order],l={SendtBytes:1,DiffSendtBytes:2,ReceiveBytes:3,DiffReceiveBytes:4}[e.prop];a.page.Order=l,a.page.OrderType=t};return(0,l.sV)((()=>{s()})),(0,l.hi)((()=>{clearTimeout(a.timer)})),{config:e.config,state:a,handlePageChange:o,handleSort:r}}};const pe=(0,F.A)(de,[["render",ce],["__scopeId","data-v-e241ce02"]]);var ge=pe,ve={props:["config"],components:{ServerFlowMessenger:Z,ServerFlowSForward:oe,ServerFlowRelay:ge},setup(e){const{t:t}=(0,E.s9)(),a=(0,S.B)(),s=(0,l.EW)((()=>a.value.hasAccess("SForwardFlow"))),n=(0,l.EW)((()=>a.value.hasAccess("RelayFlow"))),o=(0,l.EW)((()=>a.value.hasAccess("SigninFlow"))),r=(0,k.Kh)({show:!1,timer:0,overallSendtSpeed:"0000.00KB",overallReceiveSpeed:"0000.00KB",overallOnline:"0/0",serverOnline:"",time:"",list:[],old:null,details:{Messenger:!1,SForward:!1,Relay:!1}}),i=()=>{r.show=!0},u=e=>{r.details[e]=!0},c={External:{text:t("status.flowWanPort"),detail:!1},RelayReport:{text:t("status.flowRelayNode"),detail:!1},Relay:{text:t("status.flowRelay"),detail:n.value},Messenger:{text:t("status.flowMessenger"),detail:o.value},SForward:{text:t("status.flowServerForward"),detail:s.value},flow:{text:"",detail:!1}},d=()=>{j().then((e=>{const t=r.old||e;if(e.Items["_"]&&(r.overallOnline=`${e.Items["_"].SendtBytes}/${e.Items["_"].ReceiveBytes}`,delete e.Items["_"]),e.Items["flow"]&&e.Items["flow"].ReceiveBytes>0){const t=(BigInt(e.Items["flow"].ReceiveBytes)>>BigInt(32)).toString(),a=(BigInt(e.Items["flow"].ReceiveBytes)&BigInt(4294967295)).toString(),l=e.Items["flow"].SendtBytes;r.serverOnline=`、${t}/${a}/${l}`,delete e.Items["flow"]}let a=0,l=0,s=0,n=0;for(let r in t.Items)a+=t.Items[r].ReceiveBytes,l+=t.Items[r].SendtBytes;for(let r in e.Items)s+=e.Items[r].ReceiveBytes,n+=e.Items[r].SendtBytes;r.overallSendtSpeed=p(n-l),r.overallReceiveSpeed=p(s-a),r.time=`${e.Start}`;const o=[];for(let r in e.Items){const a=e.Items[r],l=t.Items[r],s=c[`${r}`]||{text:`Unknow${r}`,detail:!1};o.push({id:r,text:s.text,detail:s.detail,sendtBytes:a.SendtBytes,sendtBytesText:p(a.SendtBytes),sendtSpeed:a.SendtBytes-l.SendtBytes,sendtSpeedText:p(a.SendtBytes-l.SendtBytes),receiveBytes:a.ReceiveBytes,receiveBytesText:p(a.ReceiveBytes),receiveSpeed:a.ReceiveBytes-l.ReceiveBytes,receiveSpeedText:p(a.ReceiveBytes-l.ReceiveBytes)})}r.list=o.filter((e=>!!e.id)),r.old=e,r.timer=setTimeout(d,1e3)})).catch((e=>{r.timer=setTimeout(d,1e3)}))},p=e=>{let t=0;while(e>=1024)e/=1024,t++;return`${e.toFixed(2)}${["B","KB","MB","GB","TB"][t]}`};return(0,l.sV)((()=>{d()})),(0,l.hi)((()=>{clearTimeout(r.timer)})),{hasSForwardFlow:s,config:e.config,state:r,handleShow:i,handleShowDetail:u}}};const me=(0,F.A)(ve,[["render",O],["__scopeId","data-v-db6a4002"]]);var fe=me;const he=["title"],we={key:0,class:"progress"},ke={key:1,class:"progress"};function be(e,t,a,n,o,r){const i=(0,l.g2)("Loading"),u=(0,l.g2)("el-icon"),c=(0,l.g2)("Download"),d=(0,l.g2)("CircleCheck");return(0,l.uX)(),(0,l.CE)("a",{href:"javascript:;",onClick:t[0]||(t[0]=(...e)=>n.handleUpdate&&n.handleUpdate(...e)),class:(0,s.C4)(["download",n.updateColor()]),title:n.updateText()},[(0,l.Lk)("span",null,(0,s.v_)(n.state.version),1),n.updaterCurrent.Version?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[1==n.updaterCurrent.Status?((0,l.uX)(),(0,l.Wv)(u,{key:0,size:"14",class:"loading"},{default:(0,l.k6)((()=>[(0,l.bF)(i)])),_:1})):2==n.updaterServer.Status?((0,l.uX)(),(0,l.Wv)(u,{key:1,size:"14"},{default:(0,l.k6)((()=>[(0,l.bF)(c)])),_:1})):3==n.updaterServer.Status||5==n.updaterServer.Status?((0,l.uX)(),(0,l.CE)(l.FK,{key:2},[(0,l.bF)(u,{size:"14",class:"loading"},{default:(0,l.k6)((()=>[(0,l.bF)(i)])),_:1}),0==n.updaterServer.Length?((0,l.uX)(),(0,l.CE)("span",we,"0%")):((0,l.uX)(),(0,l.CE)("span",ke,(0,s.v_)(parseInt(n.updaterServer.Current/n.updaterServer.Length*100))+"%",1))],64)):6==n.updaterServer.Status?((0,l.uX)(),(0,l.Wv)(u,{key:3,size:"14",class:"yellow"},{default:(0,l.k6)((()=>[(0,l.bF)(d)])),_:1})):(0,l.Q3)("",!0)],64)):((0,l.uX)(),(0,l.Wv)(u,{key:1,size:"14"},{default:(0,l.k6)((()=>[(0,l.bF)(c)])),_:1}))],10,he)}var ye=a(2933),Se=a(920),Ce={components:{Promotion:B.Yk4,Download:B.f5X,Loading:B.Rhj,CircleCheck:B.rW7,ServerFlow:fe},props:["config"],setup(e){const{t:t}=(0,E.s9)(),a=(0,S.B)(),s=(0,l.EW)((()=>a.value.hasAccess("UpdateServer"))),n=(0,k.KR)({Version:"",Msg:[],DateTime:"",Status:0,Length:0,Current:0}),o=(0,k.KR)({Version:"",Status:0,Length:0,Current:0}),r=(0,l.EW)((()=>`${n.value.Version}->${n.value.DateTime}\n${n.value.Msg.map(((e,t)=>`${t+1}、${e}`)).join("\n")}`)),i=(0,k.Kh)({show:!1,loading:!1,connected:(0,l.EW)((()=>a.value.signin.Connected)),version:(0,l.EW)((()=>a.value.signin.Version))}),u=()=>{(0,Se.Vk)().then((e=>{n.value.DateTime=e.DateTime,n.value.Version=e.Version,n.value.Status=e.Status,n.value.Length=e.Length,n.value.Current=e.Current,n.value.Msg=e.Msg,setTimeout((()=>{u()}),1e3)})).catch((()=>{setTimeout((()=>{u()}),1e3)}))},c=()=>{(0,Se.BJ)().then((e=>{o.value.Version=e.Version,o.value.Status=e.Status,o.value.Length=e.Length,o.value.Current=e.Current,o.value.Status>2&&o.value.Status<6&&setTimeout((()=>{c()}),1e3)})).catch((()=>{setTimeout((()=>{c()}),1e3)}))},d=()=>n.value.Version?o.value.Status<=2?i.version!=n.value.Version?`${t("status.serverNotNew")}(${n.value.Version})\n${r.value}`:`${t("status.serverNew")}\n${r.value}`:{3:t("status.serverDownloading"),4:t("status.serverDownloaded"),5:t("status.serverUnZipIng"),6:t("status.serverUnZip")}[o.value.Status]:t("status.serverNoUpdate"),p=()=>i.version!=n.value.Version?"yellow":"green",g=()=>{e.config&&s.value&&([0,1,3,5].indexOf(o.value.Status)>=0?W.nk.error(t("common.operating")):6!=o.value.Status?2==n.value.Status&&ye.s.confirm(t("status.serverConfirm"),t("common.tips"),{confirmButtonText:t("common.confirm"),cancelButtonText:t("common.cancel"),type:"warning"}).then((()=>{(0,Se.y2)(n.value.Version||a.value.signin.Version).then((()=>{setTimeout((()=>{c()}),1e3)}))})).catch((()=>{})):ye.s.confirm(t("status.serverCloseConfirm"),t("common.tips"),{confirmButtonText:t("common.confirm"),cancelButtonText:t("common.cancel"),type:"warning"}).then((()=>{(0,Se.aP)()})).catch((()=>{})))};return(0,l.sV)((()=>{u(),c()})),{config:e.config,state:i,updaterCurrent:n,updaterServer:o,handleUpdate:g,updateText:d,updateColor:p}}};const Be=(0,F.A)(Ce,[["render",be],["__scopeId","data-v-1b4c7f6e"]]);var _e=Be,Fe={components:{ServerConfig:P,ServerFlow:fe,ServerVersion:_e},props:["config"],setup(e){const t=(0,S.B)(),a=(0,l.EW)((()=>t.value.hasAccess("Flow"))),s=(0,k.Kh)({show:!1,loading:!1});return{config:e.config,hasFlow:a,state:s}}};const Ve=(0,F.A)(Fe,[["render",x],["__scopeId","data-v-2d85a782"]]);var $e=Ve;const Te={key:0,class:"status-export-wrap"},xe=["title"],Le={class:"port-wrap"},Ie={class:"text"},Re={class:"body"},Ae={class:"card-header"},We={class:"flex"},Ee={style:{"margin-left":"2rem"}};function De(e,t,a,n,o,r){const i=(0,l.g2)("Share"),u=(0,l.g2)("el-icon"),c=(0,l.g2)("el-checkbox"),d=(0,l.g2)("el-input"),p=(0,l.g2)("Access"),g=(0,l.g2)("el-card"),v=(0,l.g2)("el-button"),m=(0,l.g2)("el-dialog");return n.config&&n.hasExport?((0,l.uX)(),(0,l.CE)("div",Te,[(0,l.Lk)("a",{href:"javascript:;",title:e.$t("status.export"),onClick:t[0]||(t[0]=e=>n.state.show=!0)},[(0,l.bF)(u,{size:"16"},{default:(0,l.k6)((()=>[(0,l.bF)(i)])),_:1}),(0,l.eW)(" "+(0,s.v_)(e.$t("status.export")),1)],8,xe),(0,l.bF)(m,{class:"options-center",title:e.$t("status.export"),"destroy-on-close":"",modelValue:n.state.show,"onUpdate:modelValue":t[5]||(t[5]=e=>n.state.show=e),center:"",width:"580",top:"1vh"},{footer:(0,l.k6)((()=>[(0,l.bF)(v,{plain:"",onClick:t[4]||(t[4]=e=>n.state.show=!1),loading:n.state.loading},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e.$t("common.cancel")),1)])),_:1},8,["loading"]),(0,l.bF)(v,{type:"success",plain:"",onClick:n.handleExport,loading:n.state.loading},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e.$t("common.confirm")),1)])),_:1},8,["onClick","loading"])])),default:(0,l.k6)((()=>[(0,l.Lk)("div",Le,[(0,l.Lk)("div",Ie,(0,s.v_)(e.$t("status.exportText")),1),(0,l.Lk)("div",Re,[(0,l.bF)(g,{shadow:"never"},{header:(0,l.k6)((()=>[(0,l.Lk)("div",Ae,[(0,l.Lk)("div",We,[(0,l.Lk)("div",null,[(0,l.bF)(c,{disabled:n.onlyNode,modelValue:n.state.single,"onUpdate:modelValue":t[1]||(t[1]=e=>n.state.single=e),label:e.$t("status.exportSingle")},null,8,["disabled","modelValue","label"])]),(0,l.Lk)("div",Ee,[(0,l.Lk)("span",null,(0,s.v_)(e.$t("status.exportName"))+" : ",1),(0,l.bF)(d,{disabled:!n.state.single,modelValue:n.state.name,"onUpdate:modelValue":t[2]||(t[2]=e=>n.state.name=e),maxlength:"32","show-word-limit":"",style:{width:"15rem"}},null,8,["disabled","modelValue"])]),(0,l.Lk)("div",null,[(0,l.Lk)("span",null,(0,s.v_)(e.$t("status.exportApiPassword"))+" : ",1),(0,l.bF)(d,{type:"password","show-password":"",disabled:n.onlyNode,modelValue:n.state.apipassword,"onUpdate:modelValue":t[3]||(t[3]=e=>n.state.apipassword=e),maxlength:"36","show-word-limit":"",style:{width:"15rem"}},null,8,["disabled","modelValue"])])])])])),default:(0,l.k6)((()=>[(0,l.bF)(p,{ref:"accessDom",machineid:n.machineId},null,8,["machineid"])])),_:1})])])])),_:1},8,["title","modelValue"])])):(0,l.Q3)("",!0)}var ze=a(8835),Pe=a(6158),Ke={components:{Share:B.SYj,Access:Pe.A},props:["config"],setup(e){const{t:t}=(0,E.s9)(),a=(0,S.B)(),s=(0,l.EW)((()=>a.value.hasAccess("Export"))),n=(0,l.EW)((()=>a.value.config.Client.OnlyNode)),o=(0,l.EW)((()=>a.value.config.Client.Id)),r=(0,k.Kh)({show:!1,loading:!1,single:!0,name:"",apipassword:""}),i=(0,k.KR)(null),u=()=>{if(!s.value)return;const e={access:i.value.getValue(),single:r.single,name:r.name,apipassword:r.apipassword};if(e.single){if(!e.name)return void W.nk.error(t("status.exportNamePlease"))}else e.name="";if(r.apipassword)return e;W.nk.error(t("status.exportApiPasswordPlease"))},c=()=>{const e=document.createElement("a");r.single?e.download=`client-node-export-${r.name}.zip`:e.download="client-node-export.zip",e.href="/client-node-export.zip",document.body.appendChild(e),e.click(),document.body.removeChild(e)},d=()=>{const e=u();e&&(r.loading=!0,(0,ze.P$)(e).then((()=>{r.loading=!1,r.show=!1,W.nk.success(t("common.oper")),c()})).catch((()=>{W.nk.error(t("common.operFail")),r.loading=!1})))};return{config:e.config,onlyNode:n,hasExport:s,machineId:o,state:r,accessDom:i,handleExport:d}}};const Ue=(0,F.A)(Ke,[["render",De],["__scopeId","data-v-844ab17c"]]);var Ge=Ue,Me=a(4001),Xe={components:{Api:$,Server:$e,Export:Ge,UpdaterBtn:Me.A},props:["config"],setup(e){const t=(0,S.B)(),a=(0,l.EW)((()=>t.value.self)),s=(0,k.Kh)({showPay:!1});return{state:s,config:e.config,self:a}}};const Oe=(0,F.A)(Xe,[["render",w],["__scopeId","data-v-81a12f1c"]]);var je=Oe}}]);