"use strict";(self["webpackChunklinker_web"]=self["webpackChunklinker_web"]||[]).push([[870],{5241:function(e,t,n){n.d(t,{AE:function(){return m},Jd:function(){return d},Nj:function(){return h},PR:function(){return c},Yh:function(){return o},ac:function(){return r},en:function(){return u},kl:function(){return a},vB:function(){return s},zi:function(){return l}});var i=n(4);const a=(e="0")=>(0,i.zG)("tuntapclient/connections",e),s=e=>(0,i.zG)("tuntapclient/removeconnection",e),l=(e="0")=>(0,i.zG)("tuntapclient/get",e),u=e=>(0,i.zG)("tuntapclient/run",e),c=e=>(0,i.zG)("tuntapclient/stop",e),r=e=>(0,i.zG)("tuntapclient/update",e),o=()=>(0,i.zG)("tuntapclient/refresh"),d=()=>(0,i.zG)("tuntapclient/SubscribePing"),h=()=>(0,i.zG)("tuntapclient/GetNetwork"),m=e=>(0,i.zG)("tuntapclient/AddNetwork",e)},7985:function(e,t,n){n.d(t,{r:function(){return c}});n(4114);var i=n(9299),a=n(3830),s=n(6768),l=n(144);const u=[],c=()=>{const e=(0,a.B)(),t=(0,s.EW)((()=>e.value.config.Client.Id)),n=(0,l.Kh)({timer:0,page:{Request:{Page:1,Size:+(localStorage.getItem("ps")||"10"),Name:"",Ids:[],Prop:"",Asc:!0},Count:0,List:[]},showDeviceEdit:!1,showAccessEdit:!1,deviceInfo:null}),c=()=>{(0,i.nD)(n.page.Request).then((i=>{n.page.Request=i.Request,n.page.Count=i.Count;for(let n in i.List)Object.assign(i.List[n],{showDel:t.value!=i.List[n].MachineId&&0==i.List[n].Connected,showAccess:t.value!=i.List[n].MachineId&&i.List[n].Connected,showReboot:i.List[n].Connected,isSelf:t.value==i.List[n].MachineId,showip:!1}),i.List[n].isSelf&&(e.value.self=i.List[n]);n.page.List=i.List;for(let e=0;e<n.page.List.length;e++)u.push(n.page.List[e])})).catch((e=>{}))},r=()=>{(0,i.nD)(n.page.Request).then((i=>{for(let a in i.List){const s=n.page.List.filter((e=>e.MachineId==i.List[a].MachineId))[0];s&&(Object.assign(s,{Connected:i.List[a].Connected,Version:i.List[a].Version,LastSignIn:i.List[a].LastSignIn,Args:i.List[a].Args,showDel:t.value!=i.List[a].MachineId&&0==i.List[a].Connected,showAccess:t.value!=i.List[a].MachineId&&i.List[a].Connected,showReboot:i.List[a].Connected,isSelf:t.value==i.List[a].MachineId}),s.isSelf&&(e.value.self=s))}n.timer=setTimeout(r,5e3)})).catch((e=>{n.timer=setTimeout(r,5e3)}))},o=()=>{try{if(0==u.length)return void setTimeout(o,1e3);const e=u.shift();fetch(`http://ip-api.com/json/${e.IP.split(":")[0]}`).then((async t=>{try{const n=await t.json();e.countryFlag=`https://unpkg.com/flag-icons@7.2.3/flags/4x3/${n.countryCode.toLowerCase()}.svg`}catch(n){}setTimeout(o,1e3)})).catch((()=>{setTimeout(o,1e3)}))}catch(e){setTimeout(o,1e3)}};o();const d=e=>{n.deviceInfo=e,n.showDeviceEdit=!0},h=e=>{n.deviceInfo=e,n.showAccessEdit=!0},m=e=>{e&&(n.page.Request.Page=e),c()},f=e=>{e&&(n.page.Request.Size=e,localStorage.setItem("ps",e)),c()},p=e=>{(0,i.Se)(e).then((()=>{c()}))},g=()=>{clearTimeout(n.timer),n.timer=0},v=e=>(0,i.VN)(e);return{devices:n,machineId:t,_getSignList:c,_getSignList1:r,handleDeviceEdit:d,handleAccessEdit:h,handlePageChange:m,handlePageSizeChange:f,handleDel:p,clearDevicesTimeout:g,setSort:v}}},8104:function(e,t,n){n.d(t,{O:function(){return u},W:function(){return c}});var i=n(144),a=n(6768),s=n(5241);const l=Symbol(),u=()=>{const e=(0,i.KR)({timer:0,showEdit:!1,current:null,list:{},hashcode:0,showLease:!1});(0,a.Gt)(l,e);const t={linux:["debian","ubuntu","alpine","rocky","centos"],windows:["windows"],android:["android"],ios:["ios"]},n=()=>{clearTimeout(e.value.timer),(0,s.zi)(e.value.hashcode.toString()).then((i=>{if(e.value.hashcode=i.HashCode,i.List){for(let e in i.List){let n="system";const a=i.List[e].SystemInfo.toLowerCase();for(let e in t)if(a.indexOf(e)>=0){const i=t[e];if(1==i.length)n=i[0];else for(let e=0;e<i.length;e++)if(a.indexOf(i[e])>=0){n=i[e];break}break}Object.assign(i.List[e],{running:2==i.List[e].Status,loading:1==i.List[e].Status,system:n,systemDocker:a.indexOf("docker")>=0})}e.value.list=i.List}e.value.timer=setTimeout(n,1100),(0,s.Jd)()})).catch((t=>{e.value.timer=setTimeout(n,1100)}))},u=t=>{e.value.current=t,e.value.showEdit=!0},c=()=>{(0,s.Yh)()},r=()=>{clearTimeout(e.value.timer),e.value.timer=0},o=t=>Object.values(e.value.list).filter((e=>e.IP.indexOf(t)>=0||e.Lans.filter((e=>e.IP.indexOf(t)>=0)).length>0)).map((e=>e.MachineId)),d=t=>{const n=Object.values(e.value.list).filter((e=>e.IP)).sort(((e,t)=>{const n=e.IP.split(".").map((e=>Number(e))),i=t.IP.split(".").map((e=>Number(e)));for(let a=0;a<n.length;a++)if(n[a]!=i[a])return n[a]-i[a];return 0}));return n.map((e=>e.MachineId))};return{tuntap:e,_getTuntapInfo:n,handleTuntapEdit:u,handleTuntapRefresh:c,clearTuntapTimeout:r,getTuntapMachines:o,sortTuntapIP:d}},c=()=>(0,a.WQ)(l)},6674:function(e,t,n){n.d(t,{A:function(){return v}});var i=n(6768),a=n(4232);const s=["title"],l=["src"],u=["src"],c={key:1,class:"system",src:"/docker.svg"},r={key:1};function o(e,t,n,o,d,h){const m=(0,i.g2)("StarFilled"),f=(0,i.g2)("el-icon");return(0,i.uX)(),(0,i.CE)("div",null,[o.tuntap.list[o.item.MachineId]&&o.tuntap.list[o.item.MachineId].system?((0,i.uX)(),(0,i.CE)("span",{key:0,title:o.tuntap.list[o.item.MachineId].SystemInfo},[o.item.countryFlag?((0,i.uX)(),(0,i.CE)("img",{key:0,class:"system",src:o.item.countryFlag},null,8,l)):(0,i.Q3)("",!0),(0,i.Lk)("img",{class:"system",src:`/${o.tuntap.list[o.item.MachineId].system}.svg`},null,8,u),o.tuntap.list[o.item.MachineId].systemDocker?((0,i.uX)(),(0,i.CE)("img",c)):(0,i.Q3)("",!0)],8,s)):(0,i.Q3)("",!0),(0,i.Lk)("a",{href:"javascript:;",onClick:t[0]||(t[0]=(...e)=>o.handleEdit&&o.handleEdit(...e)),title:"此客户端的设备名",class:(0,a.C4)({green:o.item.Connected,gateway:o.item.isSelf})},(0,a.v_)(o.item.MachineName),3),o.item.isSelf?((0,i.uX)(),(0,i.CE)("strong",r,[(0,i.eW)("("),(0,i.bF)(f,null,{default:(0,i.k6)((()=>[(0,i.bF)(m)])),_:1}),(0,i.eW)(") ")])):(0,i.Q3)("",!0)])}var d=n(3830),h=n(8104),m=n(7477),f={props:["item","config"],emits:["edit","refresh"],components:{StarFilled:m.BQ2},setup(e,{emit:t}){const n=(0,h.W)(),a=(0,d.B)(),s=(0,i.EW)((()=>a.value.hasAccess("RenameSelf"))),l=(0,i.EW)((()=>a.value.hasAccess("RenameOther"))),u=(0,i.EW)((()=>a.value.config.Client.Id)),c=()=>{if(e.config){if(u.value===e.item.MachineId){if(!s.value)return}else if(!l.value)return;t("edit",e.item)}};return{item:(0,i.EW)((()=>e.item)),tuntap:n,handleEdit:c}}},p=n(1241);const g=(0,p.A)(f,[["render",o],["__scopeId","data-v-ac66308a"]]);var v=g},3089:function(e,t,n){n.d(t,{A:function(){return E}});var i=n(6768),a=n(4232);const s={class:"flex"},l={class:"flex-1"},u=["title"],c=["title"],r={key:1},o={key:0},d={key:0,class:"flex yellow",title:"已禁用"},h={key:1,class:"flex yellow",title:"与其它设备填写IP、或本机局域网IP有冲突"},m={class:"delay yellow"};function f(e,t,n,f,p,g){const v=(0,i.g2)("Loading"),I=(0,i.g2)("el-icon"),L=(0,i.g2)("el-switch");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("div",s,[(0,i.Lk)("div",l,[(0,i.Lk)("a",{href:"javascript:;",class:"a-line",onClick:t[0]||(t[0]=e=>f.handleTuntapIP(f.tuntap.list[f.item.MachineId])),title:"此设备的虚拟网卡IP"},[f.tuntap.list[f.item.MachineId].SetupError?((0,i.uX)(),(0,i.CE)("strong",{key:0,class:"red",title:f.tuntap.list[f.item.MachineId].SetupError},(0,a.v_)(f.tuntap.list[f.item.MachineId].IP),9,u)):f.tuntap.list[f.item.MachineId].Upgrade&&f.tuntap.list[f.item.MachineId].NatError?((0,i.uX)(),(0,i.CE)("strong",{key:1,class:"yellow",title:f.tuntap.list[f.item.MachineId].NatError},(0,a.v_)(f.tuntap.list[f.item.MachineId].IP),9,c)):((0,i.uX)(),(0,i.CE)(i.FK,{key:2},[f.tuntap.list[f.item.MachineId].running?((0,i.uX)(),(0,i.CE)("strong",{key:0,class:(0,a.C4)(["green",{gateway:f.item.isSelf}])},(0,a.v_)(f.tuntap.list[f.item.MachineId].IP),3)):((0,i.uX)(),(0,i.CE)("strong",r,(0,a.v_)(f.tuntap.list[f.item.MachineId].IP),1))],64))])]),f.tuntap.list[f.item.MachineId].loading?((0,i.uX)(),(0,i.CE)("div",o,[(0,i.bF)(I,{size:"14",class:"loading"},{default:(0,i.k6)((()=>[(0,i.bF)(v)])),_:1})])):((0,i.uX)(),(0,i.Wv)(L,{key:1,modelValue:f.tuntap.list[f.item.MachineId].running,"onUpdate:modelValue":t[1]||(t[1]=e=>f.tuntap.list[f.item.MachineId].running=e),loading:f.tuntap.list[f.item.MachineId].loading,disabled:"",onClick:t[2]||(t[2]=e=>f.handleTuntap(f.tuntap.list[f.item.MachineId])),size:"small","inline-prompt":"","active-text":"😀","inactive-text":"😣"},null,8,["modelValue","loading"]))]),(0,i.Lk)("div",null,[(0,i.Lk)("div",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(f.tuntap.list[f.item.MachineId].Lans,((e,t)=>((0,i.uX)(),(0,i.CE)(i.FK,{key:t},[e.Disabled?((0,i.uX)(),(0,i.CE)("div",d,(0,a.v_)(e.IP)+" / "+(0,a.v_)(e.PrefixLength),1)):e.Exists?((0,i.uX)(),(0,i.CE)("div",h,(0,a.v_)(e.IP)+" / "+(0,a.v_)(e.PrefixLength),1)):((0,i.uX)(),(0,i.CE)("div",{key:2,class:(0,a.C4)(["flex",{green:f.tuntap.list[f.item.MachineId].running,gateway:f.item.isSelf}]),title:"正常使用"},(0,a.v_)(e.IP)+" / "+(0,a.v_)(e.PrefixLength),3))],64)))),128))]),f.showDelay?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[f.tuntap.list[f.item.MachineId].Delay>=0&&f.tuntap.list[f.item.MachineId].Delay<=100?((0,i.uX)(),(0,i.CE)("div",{key:0,class:(0,a.C4)(["delay green",{gateway:f.item.isSelf}])},(0,a.v_)(f.tuntap.list[f.item.MachineId].Delay)+"ms",3)):(0,i.Q3)("",!0),(0,i.Lk)("template",null,[(0,i.Lk)("div",m,(0,a.v_)(f.tuntap.list[f.item.MachineId].Delay)+"ms",1)])],64)):(0,i.Q3)("",!0)])])}var p=n(5241),g=n(1219),v=n(8104),I=n(7477),L=n(3830),y={props:["item","config"],emits:["edit","refresh"],components:{Loading:I.Rhj},setup(e,{emit:t}){const n=(0,v.W)(),a=(0,L.B)(),s=(0,i.EW)((()=>a.value.config.Client.Id)),l=(0,i.EW)((()=>a.value.hasAccess("TuntapChangeSelf"))),u=(0,i.EW)((()=>a.value.hasAccess("TuntapChangeOther"))),c=(0,i.EW)((()=>a.value.hasAccess("TuntapStatusSelf"))),r=(0,i.EW)((()=>a.value.hasAccess("TuntapStatusOther"))),o=(0,i.EW)((()=>2==(2&(a.value.config.Running.Tuntap||{Switch:0}).Switch))),d=t=>{if(!e.config)return;if(s.value===t.MachineId){if(!c.value)return}else if(!r.value)return;const n=t.running?(0,p.PR)(t.MachineId):(0,p.en)(t.MachineId);t.loading=!0,n.then((()=>{g.nk.success("操作成功！")})).catch((()=>{g.nk.error("操作失败！")}))},h=n=>{if(e.config||s.value==n.MachineId){if(s.value===n.MachineId){if(!l.value)return}else if(!u.value)return;n.device=e.item,t("edit",n)}},m=()=>{t("refresh")};return{item:(0,i.EW)((()=>e.item)),tuntap:n,showDelay:o,handleTuntap:d,handleTuntapIP:h,handleTuntapRefresh:m}}},C=n(1241);const k=(0,C.A)(y,[["render",f],["__scopeId","data-v-875f1f70"]]);var E=k}}]);