"use strict";(self["webpackChunklinker_web"]=self["webpackChunklinker_web"]||[]).push([[726],{920:function(e,t,n){n.d(t,{BJ:function(){return u},NS:function(){return o},Vk:function(){return c},aP:function(){return v},ir:function(){return r},lJ:function(){return s},mK:function(){return l},y2:function(){return d},yN:function(){return i}});var a=n(4);const l=(e="0")=>(0,a.zG)("updaterclient/get",e),s=e=>(0,a.zG)("updaterclient/confirm",e),o=e=>(0,a.zG)("updaterclient/exit",e),i=()=>(0,a.zG)("updaterclient/GetSecretKey"),r=e=>(0,a.zG)("updaterclient/SetSecretKey",e),c=()=>(0,a.zG)("updaterclient/getcurrent"),u=()=>(0,a.zG)("updaterclient/getserver"),d=e=>(0,a.zG)("updaterclient/confirmserver",e),v=()=>(0,a.zG)("updaterclient/exitserver")},5962:function(e,t,n){n.d(t,{Y:function(){return i},q:function(){return r}});var a=n(8835),l=n(144),s=n(6768);const o=Symbol(),i=()=>{const e=(0,l.KR)({list:{},timer:0,hashcode:0});(0,s.Gt)(o,e);const t=()=>{(0,a.QI)(e.value.hashcode.toString()).then((n=>{e.value.hashcode=n.HashCode,n.List&&(e.value.list=n.List),e.value.timer=setTimeout(t,1e3)})).catch((()=>{e.value.timer=setTimeout(t,1e3)}))},n=()=>{clearTimeout(e.value.timer)};return{access:e,_getAccessInfo:t,clearAccessTimeout:n}},r=()=>(0,s.WQ)(o)},9383:function(e,t,n){n.d(t,{T:function(){return c},d:function(){return r}});var a=n(920),l=n(3830),s=n(144),o=n(6768);const i=Symbol(),r=()=>{const e=(0,l.B)(),t=(0,s.KR)({timer:0,list:{},hashcode:0,current:{Version:"",Msg:[],DateTime:"",Status:0,Length:0,Current:0}});(0,o.Gt)(i,t);const n=()=>{(0,a.mK)(t.value.hashcode.toString()).then((a=>{if(t.value.hashcode=a.HashCode,a.List){const n=Object.values(a.List).filter((e=>!!e.Version))[0];n&&(Object.assign(t.value.current,{DateTime:n.DateTime,Version:n.Version,Status:n.Status,Length:n.Length,Current:n.Current,Msg:n.Msg}),e.value.updater=t.value.current),t.value.list=a.List}t.value.timer=setTimeout(n,800)})).catch((()=>{t.value.timer=setTimeout(n,800)}))},r=()=>{clearTimeout(t.value.timer)};return{updater:t,_getUpdater:n,clearUpdaterTimeout:r}},c=()=>(0,o.WQ)(i)},5096:function(e,t,n){n.d(t,{A:function(){return v}});var a=n(6768);const l=e=>((0,a.Qi)("data-v-4892cd3c"),e=e(),(0,a.jt)(),e),s=l((()=>(0,a.Lk)("input",{type:"file",id:"file-input"},null,-1)));function o(e,t,n,l,o,i){const r=(0,a.g2)("PictureRounded"),c=(0,a.g2)("el-icon");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("a",{href:"javascript:;",onClick:t[0]||(t[0]=(...e)=>l.handleBg&&l.handleBg(...e))},[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(r)])),_:1})]),s],64)}var i=n(7477),r=n(2933),c={components:{PictureRounded:i.syp},props:["name"],setup(e){const t=`bg-${e.name}`,n=()=>{localStorage.getItem(t)?r.s.confirm("清除背景？","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{s()})).catch((()=>{})):document.getElementById("file-input").click()},l=e=>{const t=e.target.files[0];if(t)try{const e=new FileReader;e.onload=function(e){s(e.target.result)},e.readAsDataURL(t)}catch(n){}e.target.value=""},s=e=>{e?(document.body.className="sunny",localStorage.setItem(t,e),document.body.style=`background-image:url(${e})`):(document.body.className="",document.body.style="",localStorage.setItem(t,""))};return(0,a.sV)((()=>{document.getElementById("file-input").addEventListener("change",l),s(localStorage.getItem(t))})),{handleBg:n}}},u=n(1241);const d=(0,u.A)(c,[["render",o],["__scopeId","data-v-4892cd3c"]]);var v=d},6611:function(e,t,n){n.d(t,{A:function(){return d}});var a=n(6768);function l(e,t,n,l,s,o){const i=(0,a.g2)("el-checkbox"),r=(0,a.g2)("el-col"),c=(0,a.g2)("el-row"),u=(0,a.g2)("el-checkbox-group");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(r,{span:8},{default:(0,a.k6)((()=>[(0,a.bF)(i,{modelValue:l.state.checkAll,"onUpdate:modelValue":t[0]||(t[0]=e=>l.state.checkAll=e),onChange:l.handleCheckAllChange,label:"全选",indeterminate:l.state.isIndeterminate},null,8,["modelValue","onChange","indeterminate"])])),_:1})])),_:1}),(0,a.bF)(u,{modelValue:l.state.checkList,"onUpdate:modelValue":t[1]||(t[1]=e=>l.state.checkList=e),onChange:l.handleCheckedChange},{default:(0,a.k6)((()=>[(0,a.bF)(c,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.access,((e,t)=>((0,a.uX)(),(0,a.Wv)(r,{key:t,span:8},{default:(0,a.k6)((()=>[(0,a.bF)(i,{value:e.Value,label:e.Text},null,8,["value","label"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["modelValue","onChange"])],64)}n(4114);var s=n(144),o=n(3830),i=n(5962),r={props:["machineid"],setup(e){const t=(0,o.B)(),n=(0,i.q)(),l=(0,a.EW)((()=>{const e=t.value.config.Client.Accesss;return Object.keys(e).reduce(((n,a,l)=>{if(t.value.hasAccess(a)){const t=e[a];t.Key=a,n.push(t)}return n}),[])})),r=(0,s.Kh)({checkList:[t.value.config.Client.Accesss.Api.Value,t.value.config.Client.Accesss.Web.Value,t.value.config.Client.Accesss.NetManager.Value,t.value.config.Client.Accesss.FullManager.Value,t.value.config.Client.Accesss.Transport.Value,t.value.config.Client.Accesss.Action.Value],checkAll:!1,isIndeterminate:!1}),c=()=>r.checkList.reduce(((e,t)=>(e|t)>>>0),0),u=e=>{const t=e.length;r.checkAll=t===l.value.length,r.isIndeterminate=t>0&&t<l.value.length},d=e=>{r.checkAll=e,r.checkList=e?l.value.map((e=>e.Value)):[],r.isIndeterminate=!1};return(0,a.sV)((()=>{if(n&&n.value.list[e.machineid]){const t=n.value.list[e.machineid];r.checkList=l.value.reduce(((e,n)=>((t&n.Value)>>>0==n.Value&&e.push(n.Value),e)),[])}u(r.checkList)})),{state:r,access:l,getValue:c,handleCheckAllChange:d,handleCheckedChange:u}}},c=n(1241);const u=(0,c.A)(r,[["render",l],["__scopeId","data-v-bdd023b0"]]);var d=u},2126:function(e,t,n){n.d(t,{A:function(){return y}});var a=n(6768),l=n(4232);const s=["title"],o={key:0,class:"progress"},i={key:1,class:"progress"};function r(e,t,n,r,c,u){const d=(0,a.g2)("Loading"),v=(0,a.g2)("el-icon"),p=(0,a.g2)("Download"),g=(0,a.g2)("CircleCheck");return(0,a.uX)(),(0,a.CE)("a",{href:"javascript:;",class:(0,l.C4)(["download",r.updaterColor]),onClick:t[0]||(t[0]=e=>r.handleUpdate()),title:r.updaterText},[(0,a.Lk)("span",null,[(0,a.Lk)("span",null,(0,l.v_)(r.item.Version),1),r.updater.list[r.item.MachineId]?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[1==r.updater.list[r.item.MachineId].Status?((0,a.uX)(),(0,a.Wv)(v,{key:0,size:"14",class:"loading"},{default:(0,a.k6)((()=>[(0,a.bF)(d)])),_:1})):2==r.updater.list[r.item.MachineId].Status?((0,a.uX)(),(0,a.Wv)(v,{key:1,size:"14"},{default:(0,a.k6)((()=>[(0,a.bF)(p)])),_:1})):3==r.updater.list[r.item.MachineId].Status||5==r.updater.list[r.item.MachineId].Status?((0,a.uX)(),(0,a.CE)(a.FK,{key:2},[(0,a.bF)(v,{size:"14",class:"loading"},{default:(0,a.k6)((()=>[(0,a.bF)(d)])),_:1}),0==r.updater.list[r.item.MachineId].Length?((0,a.uX)(),(0,a.CE)("span",o,"0%")):((0,a.uX)(),(0,a.CE)("span",i,(0,l.v_)(parseInt(r.updater.list[r.item.MachineId].Current/r.updater.list[r.item.MachineId].Length*100))+"%",1))],64)):6==r.updater.list[r.item.MachineId].Status?((0,a.uX)(),(0,a.Wv)(v,{key:3,size:"14",class:"yellow"},{default:(0,a.k6)((()=>[(0,a.bF)(g)])),_:1})):(0,a.Q3)("",!0)],64)):((0,a.uX)(),(0,a.Wv)(v,{key:1,size:"14"},{default:(0,a.k6)((()=>[(0,a.bF)(p)])),_:1}))])],10,s)}n(4114);var c=n(3830),u=n(144),d=n(1219),v=n(2933),p=n(2248),g=n(920),h=n(7477),m=n(9383),f={props:["item","config"],components:{Download:h.f5X,Loading:h.Rhj,CircleCheck:h.rW7},setup(e){const t=(0,c.B)(),n=(0,a.EW)((()=>t.value.hasAccess("UpdateSelf"))),l=(0,a.EW)((()=>t.value.hasAccess("UpdateOther"))),s=(0,m.T)(),o=(0,a.EW)((()=>t.value.signin.Version)),i=(0,a.EW)((()=>s.value.current.Version)),r=(0,a.EW)((()=>`${i.value}->${s.value.current.DateTime}\n${s.value.current.Msg.map(((e,t)=>`${t+1}、${e}`)).join("\n")}`)),h=(0,a.EW)((()=>s.value.list[e.item.MachineId]?s.value.list[e.item.MachineId].Status<=2?e.item.Version!=o.value?`与服务器版本(${o.value})不一致，建议更新`:i.value!=e.item.Version?`不是最新版本(${i.value})，建议更新\n${r.value}`:`是最新版本，但我无法阻止你喜欢更新\n${r.value}`:{3:"正在下载",4:"已下载",5:"正在解压",6:"已解压，请重启"}[s.value.list[e.item.MachineId].Status]:"未检测到更新")),f=(0,a.EW)((()=>e.item.Version!=o.value?"red":s.value.list[e.item.MachineId]&&i.value!=e.item.Version?"yellow":"green")),k=()=>{if(!e.config)return;if(!n.value)return;const t=s.value.list[e.item.MachineId];if(t)if([0,1,3,5].indexOf(t.Status)>=0)d.nk.error("操作中，请稍后!");else if(6!=t.Status){if(2==t.Status){const t=(0,u.KR)(i.value),n=[(0,a.h)(p.P9,{label:`仅[${e.item.MachineName}] -> ${i.value}(最新版本)`,value:i.value})];e.config&&l.value&&n.push((0,a.h)(p.P9,{label:`[所有] -> ${i.value}(最新版本)`,value:`all->${i.value}`})),e.item.Version!=o.value&&i.value!=o.value&&(n.push((0,a.h)(p.P9,{label:`仅[${e.item.MachineName}] -> ${o.value}(服务器版本)`,value:o.value})),e.config&&l.value&&n.push((0,a.h)(p.P9,{label:`[所有] -> ${o.value}(服务器版本)`,value:`all->${o.value}`}))),(0,v.s)({title:"选择版本",message:()=>(0,a.h)(p.AV,{modelValue:t.value,placeholder:"请选择",style:"width:20rem;","onUpdate:modelValue":e=>{t.value=e}},n),confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{const n={MachineId:e.item.MachineId,Version:t.value.replace("all->",""),All:t.value.indexOf("all->")>=0};n.All&&(n.MachineId=""),(0,g.lJ)(n)})).catch((()=>{}))}}else v.s.confirm("确定关闭程序吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{exit(e.item.MachineId)})).catch((()=>{}));else d.nk.error("未检测到更新")};return{item:(0,a.EW)((()=>e.item)),updater:s,updaterText:h,updaterColor:f,handleUpdate:k}}},k=n(1241);const b=(0,k.A)(f,[["render",r],["__scopeId","data-v-56d38c60"]]);var y=b},3179:function(e,t,n){n.d(t,{A:function(){return Ve}});var a=n(6768),l=n(4232),s=n.p+"img/memory.a28433e5.svg",o=n.p+"img/wechat.5c371c5d.jpg",i=n.p+"img/alipay.ff9b1e7c.jpg";const r=e=>((0,a.Qi)("data-v-da8e5ef0"),e=e(),(0,a.jt)(),e),c={class:"status-wrap flex"},u={class:"copy"},d=r((()=>(0,a.Lk)("img",{src:s,alt:"memory"},null,-1))),v=r((()=>(0,a.Lk)("span",null,"赞助",-1))),p=[d,v],g={href:"https://github.com/snltty/linker",target:"_blank"},h=r((()=>(0,a.Lk)("div",{class:"flex-1"},null,-1))),m={class:"export"},f={class:"api"},k={class:"server"},b=r((()=>(0,a.Lk)("div",{class:"pay"},[(0,a.Lk)("img",{src:o,alt:""}),(0,a.Lk)("img",{src:i,alt:""})],-1)));function y(e,t,n,s,o,i){const r=(0,a.g2)("Export"),d=(0,a.g2)("Api"),v=(0,a.g2)("Server"),y=(0,a.g2)("el-dialog");return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",u,[(0,a.Lk)("a",{href:"javascript:;",class:"memory",title:"赞助一笔，让作者饱餐一顿",onClick:t[0]||(t[0]=e=>s.state.showPay=!0)},p),(0,a.Lk)("a",g,"©linker "+(0,l.v_)(s.self.Version),1)]),h,(0,a.Lk)("div",m,[(0,a.bF)(r,{config:s.config},null,8,["config"])]),(0,a.Lk)("div",f,[(0,a.bF)(d,{config:s.config},null,8,["config"])]),(0,a.Lk)("div",k,[(0,a.bF)(v,{config:s.config},null,8,["config"])]),(0,a.bF)(y,{modelValue:s.state.showPay,"onUpdate:modelValue":t[1]||(t[1]=e=>s.state.showPay=e),title:"赞助linker",width:"300",top:"1vh"},{default:(0,a.k6)((()=>[b])),_:1},8,["modelValue"])])}var C=n(144);const S={href:"javascript:;",title:"此设备的管理接口"};function w(e,t,n,s,o,i){const r=(0,a.g2)("Tools"),c=(0,a.g2)("el-icon"),u=(0,a.g2)("el-popconfirm");return s.config?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,l.C4)(["status-api-wrap",{connected:s.connected}])},[(0,a.bF)(u,{"confirm-button-text":"清除","cancel-button-text":"更改",title:"确定你的操作？",onCancel:s.handleShow,onConfirm:s.handleResetConnect},{reference:(0,a.k6)((()=>[(0,a.Lk)("a",S,[(0,a.bF)(c,{size:"16"},{default:(0,a.k6)((()=>[(0,a.bF)(r)])),_:1}),(0,a.eW)(" 管理接口 ")])])),_:1},8,["onCancel","onConfirm"])],2)):(0,a.Q3)("",!0)}var V=n(3830),F=n(4),_=n(7477),L={components:{Tools:_.S0q},props:["config"],setup(e){const t=(0,V.B)(),n=(0,a.EW)((()=>t.value.api.connected)),l=()=>{localStorage.setItem("api-cache",""),window.location.reload()},s=()=>{(0,F.e3)(),(0,F.a1)(`ws://${window.location.hostname}:12345`,"snltty")};return{config:e.config,connected:n,handleShow:s,handleResetConnect:l}}},B=n(1241);const x=(0,B.A)(L,[["render",w],["__scopeId","data-v-4470fcde"]]);var E=x;const A={class:"status-server-wrap"};function I(e,t,n,l,s,o){const i=(0,a.g2)("ServerConfig"),r=(0,a.g2)("ServerVersion"),c=(0,a.g2)("ServerFlow");return(0,a.uX)(),(0,a.CE)("div",A,[(0,a.bF)(i,{config:l.config},null,8,["config"]),(0,a.bF)(r,{config:l.config},null,8,["config"]),(0,a.bF)(c,{config:l.config},null,8,["config"])])}const R=e=>((0,a.Qi)("data-v-0bd6e783"),e=e(),(0,a.jt)(),e),T=R((()=>(0,a.Lk)("span",null,"信标服务器",-1))),M={class:"dialog-footer t-c"};function W(e,t,n,s,o,i){const r=(0,a.g2)("Promotion"),c=(0,a.g2)("el-icon"),u=(0,a.g2)("el-input"),d=(0,a.g2)("el-form-item"),v=(0,a.g2)("el-form"),p=(0,a.g2)("el-button"),g=(0,a.g2)("el-dialog");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("a",{href:"javascript:;",class:(0,l.C4)({connected:s.state.connected}),title:"更改你的连接设置",onClick:t[0]||(t[0]=(...e)=>s.handleConfig&&s.handleConfig(...e))},[(0,a.bF)(c,{size:"16"},{default:(0,a.k6)((()=>[(0,a.bF)(r)])),_:1}),(0,a.eW)(),T],2),(0,a.bF)(g,{modelValue:s.state.show,"onUpdate:modelValue":t[4]||(t[4]=e=>s.state.show=e),title:"连接设置",width:"300","append-to-body":""},{footer:(0,a.k6)((()=>[(0,a.Lk)("div",M,[(0,a.bF)(p,{onClick:t[3]||(t[3]=e=>s.state.show=!1),loading:s.state.loading},{default:(0,a.k6)((()=>[(0,a.eW)("取消")])),_:1},8,["loading"]),(0,a.bF)(p,{type:"primary",onClick:s.handleSave,loading:s.state.loading},{default:(0,a.k6)((()=>[(0,a.eW)("确定保存")])),_:1},8,["onClick","loading"])])])),default:(0,a.k6)((()=>[(0,a.Lk)("div",null,[(0,a.bF)(v,{model:s.state.form,rules:s.state.rules,"label-width":"6rem"},{default:(0,a.k6)((()=>[(0,a.bF)(d,{label:"机器名",prop:"name"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:s.state.form.name,"onUpdate:modelValue":t[1]||(t[1]=e=>s.state.form.name=e),maxlength:"12","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,a.bF)(d,{label:"分组名",prop:"groupid"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:s.state.form.groupid,"onUpdate:modelValue":t[2]||(t[2]=e=>s.state.form.groupid=e),type:"password","show-password":"",maxlength:"36","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue"])],64)}var $=n(9299),X=n(1219),K={components:{Promotion:_.Yk4},props:["config"],setup(e){const t=(0,V.B)(),n=(0,a.EW)((()=>t.value.hasAccess("Config"))),l=(0,C.Kh)({show:!1,loading:!1,connected:(0,a.EW)((()=>t.value.signin.Connected)),form:{name:t.value.config.Client.Name,groupid:t.value.config.Client.GroupId},rules:{}}),s=()=>{e.config&&n.value&&(l.form.name=t.value.config.Client.Name,l.form.groupid=t.value.config.Client.GroupId,l.show=!0)},o=()=>{l.loading=!0,(0,$.rd)(l.form).then((()=>{l.loading=!1,l.show=!1,X.nk.success("已操作")})).catch((e=>{l.loading=!1,X.nk.success("操作失败!")}))};return{config:e.config,state:l,handleConfig:s,handleSave:o}}};const z=(0,B.A)(K,[["render",W],["__scopeId","data-v-0bd6e783"]]);var U=z;function j(e,t,n,s,o,i){const r=(0,a.g2)("el-table-column"),c=(0,a.g2)("el-table"),u=(0,a.g2)("el-dialog");return(0,a.uX)(),(0,a.CE)(a.FK,null,[s.config?((0,a.uX)(),(0,a.CE)("a",{key:0,href:"javascript:;",title:"linker服务端网速，点击查看详细信息",onClick:t[0]||(t[0]=(...e)=>s.handleShow&&s.handleShow(...e))},[(0,a.Lk)("p",null,"上传 "+(0,l.v_)(s.state.overallSendtSpeed),1),(0,a.Lk)("p",null,"下载 "+(0,l.v_)(s.state.overallReceiveSpeed),1)])):(0,a.Q3)("",!0),(0,a.bF)(u,{class:"options-center",title:s.state.time,"destroy-on-close":"",modelValue:s.state.show,"onUpdate:modelValue":t[1]||(t[1]=e=>s.state.show=e),center:"",width:"680",top:"1vh"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",null,[(0,a.bF)(c,{data:s.state.list,border:"",size:"small",width:"100%",height:"60vh"},{default:(0,a.k6)((()=>[(0,a.bF)(r,{prop:"id",label:"信标id"}),(0,a.bF)(r,{prop:"sendtBytes",label:"总上传字节",sortable:""}),(0,a.bF)(r,{prop:"sendtText",label:"上传速度",sortable:""}),(0,a.bF)(r,{prop:"receiveBytes",label:"总下载字节",sortable:""}),(0,a.bF)(r,{prop:"receiveText",label:"下载速度",sortable:""})])),_:1},8,["data"])])])),_:1},8,["title","modelValue"])],64)}n(4114);const G=()=>(0,F.zG)("serverClient/GetFlows");var P={props:["config"],setup(e){const t=(0,C.Kh)({show:!1,timer:0,overallSendtSpeed:"0000.00KB/s",overallReceiveSpeed:"0000.00KB/s",time:"",list:[],old:null}),n=()=>{t.show=!0},l={External:"外网端口(解析器)",Relay:"中继(解析器+流量)",Messenger:"信标(解析器)",0:"登入信标",1:"客户端列表",2:"客户端删除",4:"客户端改名(转发)",7:"服务器版本",8:"客户端搜索ids",9:"客户端id列表",10:"客户端排序",11:"客户端在线",12:"生成客户端id",13:"登入信标V_1_3_1",2002:"外网端口(转发)",2004:"开始打洞(转发)",2006:"打洞失败(转发)",2008:"打洞成功(转发)",2010:"隧道配置(转发)",2012:"隧道同步(转发)",2102:"中继通知(转发)",2103:"中继请求",2105:"中继测试",2201:"运行网卡(转发)",2203:"停止网卡(转发)",2205:"更新网卡(转发)",2207:"同步网卡(转发)",2301:"添加穿透",2302:"移除穿透",2305:"获取穿透列表(转发)",2401:"测试端口转发(转发)",2403:"获取端口转发(转发)",2504:"获取权限(转发)",2506:"更新权限(转发)",2508:"同步密钥(转发)",2510:"同步服务器(转发)",2601:"更新信息(转发)",2603:"确认更新(转发)",2605:"重启(转发)",2607:"服务器更新信息",2608:"确认服务器更新",2609:"服务器重启"},s=()=>{G().then((e=>{const n=t.old||e;let a=0,i=0,r=0,c=0;for(let t in n.Resolvers)a+=n.Resolvers[t].ReceiveBytes,i+=n.Resolvers[t].SendtBytes;for(let t in e.Resolvers)r+=e.Resolvers[t].ReceiveBytes,c+=e.Resolvers[t].SendtBytes;t.overallSendtSpeed=o(c-i),t.overallReceiveSpeed=o(r-a),t.time=`从 ${e.Start}启动 至今`;const u=[];for(let t in e.Resolvers)u.push({id:l[`${t}`],sendtBytes:e.Resolvers[t].ReceiveBytes,sendtSpeed:e.Resolvers[t].ReceiveBytes-n.Resolvers[t].ReceiveBytes,sendtText:o(e.Resolvers[t].SendtBytes-n.Resolvers[t].SendtBytes),receiveBytes:e.Resolvers[t].ReceiveBytes,receiveSpeed:e.Resolvers[t].ReceiveBytes-n.Resolvers[t].ReceiveBytes,receiveText:o(e.Resolvers[t].ReceiveBytes-n.Resolvers[t].ReceiveBytes)});for(let t in e.Messangers)u.push({id:l[`${t}`],sendtBytes:e.Messangers[t].SendtBytes,sendtSpeed:e.Messangers[t].SendtBytes-n.Messangers[t].SendtBytes,sendtText:o(e.Messangers[t].SendtBytes-n.Messangers[t].SendtBytes),receiveBytes:e.Messangers[t].ReceiveBytes,receiveSpeed:e.Messangers[t].ReceiveBytes-n.Messangers[t].ReceiveBytes,receiveText:o(e.Messangers[t].ReceiveBytes-n.Messangers[t].ReceiveBytes)});t.list=u.filter((e=>!!e.id)),t.old=e,t.timer=setTimeout(s,1e3)})).catch((e=>{t.timer=setTimeout(s,1e3)}))},o=e=>{let t=0;while(e>=1024)e/=1024,t++;return`${e.toFixed(2)}${["B/s","KB/s","MB/s","GB/s","TB/s"][t]}`};return(0,a.sV)((()=>{s()})),(0,a.hi)((()=>{clearTimeout(t.timer)})),{config:e.config,state:t,handleShow:n}}};const D=(0,B.A)(P,[["render",j],["__scopeId","data-v-c2475b98"]]);var N=D;const Q=["title"],O={key:0,class:"progress"},J={key:1,class:"progress"};function Y(e,t,n,s,o,i){const r=(0,a.g2)("Loading"),c=(0,a.g2)("el-icon"),u=(0,a.g2)("Download"),d=(0,a.g2)("CircleCheck");return(0,a.uX)(),(0,a.CE)("a",{href:"javascript:;",title:"服务端的程序版本",onClick:t[0]||(t[0]=(...e)=>s.handleUpdate&&s.handleUpdate(...e)),class:(0,l.C4)(["download",s.updateColor()])},[(0,a.Lk)("span",null,(0,l.v_)(s.state.version),1),s.updaterCurrent.Version?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[1==s.updaterCurrent.Status?((0,a.uX)(),(0,a.Wv)(c,{key:0,size:"14",class:"loading"},{default:(0,a.k6)((()=>[(0,a.bF)(r)])),_:1})):2==s.updaterServer.Status?((0,a.uX)(),(0,a.Wv)(c,{key:1,size:"14"},{default:(0,a.k6)((()=>[(0,a.bF)(u)])),_:1})):3==s.updaterServer.Status||5==s.updaterServer.Status?((0,a.uX)(),(0,a.CE)(a.FK,{key:2},[(0,a.bF)(c,{size:"14",class:"loading"},{default:(0,a.k6)((()=>[(0,a.bF)(r)])),_:1}),0==s.updaterServer.Length?((0,a.uX)(),(0,a.CE)("span",O,"0%")):((0,a.uX)(),(0,a.CE)("span",J,(0,l.v_)(parseInt(s.updaterServer.Current/s.updaterServer.Length*100))+"%",1))],64)):6==s.updaterServer.Status?((0,a.uX)(),(0,a.Wv)(c,{key:3,size:"14",class:"yellow"},{default:(0,a.k6)((()=>[(0,a.bF)(d)])),_:1})):(0,a.Q3)("",!0)],64)):((0,a.uX)(),(0,a.Wv)(c,{key:1,size:"14"},{default:(0,a.k6)((()=>[(0,a.bF)(u)])),_:1}))],10,Q)}var q=n(2933),H=n(920),Z={components:{Promotion:_.Yk4,Download:_.f5X,Loading:_.Rhj,CircleCheck:_.rW7,ServerFlow:N},props:["config"],setup(e){const t=(0,V.B)(),n=(0,a.EW)((()=>t.value.hasAccess("UpdateServer"))),l=(0,C.KR)({Version:"",Msg:[],DateTime:"",Status:0,Length:0,Current:0}),s=(0,C.KR)({Version:"",Status:0,Length:0,Current:0}),o=(0,a.EW)((()=>`${l.value.Version}->${l.value.DateTime}\n${l.value.Msg.map(((e,t)=>`${t+1}、${e}`)).join("\n")}`)),i=(0,C.Kh)({show:!1,loading:!1,connected:(0,a.EW)((()=>t.value.signin.Connected)),version:(0,a.EW)((()=>t.value.signin.Version))}),r=()=>{(0,H.Vk)().then((e=>{l.value.DateTime=e.DateTime,l.value.Version=e.Version,l.value.Status=e.Status,l.value.Length=e.Length,l.value.Current=e.Current,l.value.Msg=e.Msg,setTimeout((()=>{r()}),1e3)})).catch((()=>{setTimeout((()=>{r()}),1e3)}))},c=()=>{(0,H.BJ)().then((e=>{s.value.Version=e.Version,s.value.Status=e.Status,s.value.Length=e.Length,s.value.Current=e.Current,s.value.Status>2&&s.value.Status<6&&setTimeout((()=>{c()}),1e3)})).catch((()=>{setTimeout((()=>{c()}),1e3)}))},u=()=>l.value.Version?s.value.Status<=2?i.version!=l.value.Version?`不是最新版本(${l.value.Version})，建议更新\n${o.value}`:`是最新版本，但我无法阻止你喜欢更新\n${o.value}`:{3:"正在下载",4:"已下载",5:"正在解压",6:"已解压，请重启"}[s.value.Status]:"未检测到更新",d=()=>i.version!=l.value.Version?"yellow":"green",v=()=>{e.config&&n.value&&(l.value.Version?[0,1,3,5].indexOf(s.value.Status)>=0?X.nk.error("操作中，请稍后!"):6!=s.value.Status?2==l.value.Status&&q.s.confirm("确定更新服务端吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,H.y2)(l.value.Version).then((()=>{setTimeout((()=>{c()}),1e3)}))})).catch((()=>{})):q.s.confirm("确定关闭服务端吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,H.aP)()})).catch((()=>{})):X.nk.error("未检测到更新"))};return(0,a.sV)((()=>{r(),c()})),{config:e.config,state:i,updaterCurrent:l,updaterServer:s,handleUpdate:v,updateText:u,updateColor:d}}};const ee=(0,B.A)(Z,[["render",Y],["__scopeId","data-v-543a912e"]]);var te=ee,ne={components:{ServerConfig:U,ServerFlow:N,ServerVersion:te},props:["config"],setup(e){const t=(0,C.Kh)({show:!1,loading:!1});return{config:e.config,state:t}}};const ae=(0,B.A)(ne,[["render",I],["__scopeId","data-v-67a4cbd2"]]);var le=ae;const se=e=>((0,a.Qi)("data-v-117ef7b0"),e=e(),(0,a.jt)(),e),oe={key:0,class:"status-export-wrap"},ie={class:"port-wrap"},re=se((()=>(0,a.Lk)("div",{class:"text"}," 导出配置，作为子设备运行，如果使用docker，容器映射configs文件夹即可 ",-1))),ce={class:"body"},ue={class:"card-header"},de={class:"flex"},ve={style:{"margin-left":"2rem"}},pe=se((()=>(0,a.Lk)("span",null,"设备名 : ",-1))),ge=se((()=>(0,a.Lk)("span",null,"管理密码 : ",-1)));function he(e,t,n,l,s,o){const i=(0,a.g2)("Share"),r=(0,a.g2)("el-icon"),c=(0,a.g2)("el-checkbox"),u=(0,a.g2)("el-popover"),d=(0,a.g2)("el-input"),v=(0,a.g2)("Access"),p=(0,a.g2)("el-card"),g=(0,a.g2)("el-button"),h=(0,a.g2)("el-dialog");return l.config&&l.hasExport?((0,a.uX)(),(0,a.CE)("div",oe,[(0,a.Lk)("a",{href:"javascript:;",title:"此设备的管理接口",onClick:t[0]||(t[0]=e=>l.state.show=!0)},[(0,a.bF)(r,{size:"16"},{default:(0,a.k6)((()=>[(0,a.bF)(i)])),_:1}),(0,a.eW)(" 导出配置 ")]),(0,a.bF)(h,{class:"options-center",title:"导出配置","destroy-on-close":"",modelValue:l.state.show,"onUpdate:modelValue":t[5]||(t[5]=e=>l.state.show=e),center:"",width:"580",top:"1vh"},{footer:(0,a.k6)((()=>[(0,a.bF)(g,{plain:"",onClick:t[4]||(t[4]=e=>l.state.show=!1),loading:l.state.loading},{default:(0,a.k6)((()=>[(0,a.eW)("取消")])),_:1},8,["loading"]),(0,a.bF)(g,{type:"success",plain:"",onClick:l.handleExport,loading:l.state.loading},{default:(0,a.k6)((()=>[(0,a.eW)("确定导出")])),_:1},8,["onClick","loading"])])),default:(0,a.k6)((()=>[(0,a.Lk)("div",ie,[re,(0,a.Lk)("div",ce,[(0,a.bF)(p,{shadow:"never"},{header:(0,a.k6)((()=>[(0,a.Lk)("div",ue,[(0,a.Lk)("div",de,[(0,a.Lk)("div",null,[(0,a.bF)(u,{placement:"top-start",title:"tips",width:200,trigger:"hover",content:"这将生成唯一ID，多台设备使用产生冲突，挤压下线"},{reference:(0,a.k6)((()=>[(0,a.bF)(c,{disabled:l.onlyNode,modelValue:l.state.single,"onUpdate:modelValue":t[1]||(t[1]=e=>l.state.single=e),label:"单设备"},null,8,["disabled","modelValue"])])),_:1})]),(0,a.Lk)("div",ve,[pe,(0,a.bF)(d,{disabled:!l.state.single,modelValue:l.state.name,"onUpdate:modelValue":t[2]||(t[2]=e=>l.state.name=e),maxlength:"12","show-word-limit":"",style:{width:"15rem"}},null,8,["disabled","modelValue"])]),(0,a.Lk)("div",null,[ge,(0,a.bF)(d,{type:"password","show-password":"",disabled:l.onlyNode,modelValue:l.state.apipassword,"onUpdate:modelValue":t[3]||(t[3]=e=>l.state.apipassword=e),maxlength:"36","show-word-limit":"",style:{width:"15rem"}},null,8,["disabled","modelValue"])])])])])),default:(0,a.k6)((()=>[(0,a.bF)(v,{ref:"accessDom",machineid:l.machineId},null,8,["machineid"])])),_:1})])])])),_:1},8,["modelValue"])])):(0,a.Q3)("",!0)}var me=n(8835),fe=n(6611),ke={components:{Share:_.SYj,Access:fe.A},props:["config"],setup(e){const t=(0,V.B)(),n=(0,a.EW)((()=>t.value.hasAccess("Export"))),l=(0,a.EW)((()=>t.value.config.Client.OnlyNode)),s=(0,a.EW)((()=>t.value.config.Client.Id)),o=(0,C.Kh)({show:!1,loading:!1,single:!0,name:"",apipassword:t.value.config.Client.CApi.ApiPassword}),i=(0,C.KR)(null),r=()=>{if(!n.value)return;const e={access:i.value.getValue(),single:o.single,name:o.name,apipassword:o.apipassword};if(e.single){if(!e.name)return void X.nk.error("请输入设备名")}else e.name="";if(!e.single||o.name)return e;X.nk.error("请输入管理密码")},c=()=>{const e=document.createElement("a");o.single?e.download=`client-node-export-${o.name}.zip`:e.download="client-node-export.zip",e.href="/client-node-export.zip",document.body.appendChild(e),e.click(),document.body.removeChild(e)},u=()=>{const e=r();e&&(o.loading=!0,(0,me.P$)(e).then((()=>{o.loading=!1,o.show=!1,X.nk.success("导出成功"),c()})).catch((()=>{o.loading=!1})))};return{config:e.config,onlyNode:l,hasExport:n,machineId:s,state:o,accessDom:i,handleExport:u}}};const be=(0,B.A)(ke,[["render",he],["__scopeId","data-v-117ef7b0"]]);var ye=be,Ce=n(2126),Se={components:{Api:E,Server:le,Export:ye,UpdaterBtn:Ce.A},props:["config"],setup(e){const t=(0,V.B)(),n=(0,a.EW)((()=>t.value.self)),l=(0,C.Kh)({showPay:!1});return{state:l,config:e.config,self:n}}};const we=(0,B.A)(Se,[["render",y],["__scopeId","data-v-da8e5ef0"]]);var Ve=we}}]);