"use strict";(self["webpackChunklinker_web"]=self["webpackChunklinker_web"]||[]).push([[343],{4:function(e,t,r){r.d(t,{a1:function(){return g},e3:function(){return F},jH:function(){return S},zG:function(){return k}});r(4114),r(6573),r(8100),r(7936);var l=r(1219);let a=0,n=null,o="",u=1,s="";const d={},i={connected:!1,connecting:!1},m=()=>{const e=Date.now();for(let t in d){const r=d[t];e-r.time>r.timeout&&(r.reject("超时~"),delete d[t])}setTimeout(m,1e3)};m();const c={subs:{},add:function(e,t){"function"==typeof t&&(this.subs[e]||(this.subs[e]=[]),this.subs[e].push(t))},remove(e,t){let r=this.subs[e]||[];for(let l=r.length-1;l>=0;l--)r[l]==t&&r.splice(l,1)},push(e,t){let r=this.subs[e]||[];for(let l=r.length-1;l>=0;l--)r[l](t)}},f=()=>{i.connected=!0,i.connecting=!1,c.push(w,i.connected)},p=e=>{i.connected=!1,i.connecting=!1,c.push(w,i.connected),setTimeout((()=>{g()}),1e3)},b=e=>{if("string"!=typeof e.data)return void e.data.arrayBuffer().then((t=>{const r=new DataView(t).getInt8(),l=new FileReader;l.readAsText(e.data.slice(4,4+r),"utf8"),l.onload=()=>{let a=JSON.parse(l.result);a.Content={Name:a.Content,Img:e.data.slice(4+r,e.data.length),ArrayBuffer:t},v(a)}}));let t=JSON.parse(e.data);v(t)},v=e=>{let t=d[e.RequestId];t?(0==e.Code?t.resolve(e.Content):1==e.Code?t.reject(e.Content):255==e.Code?(t.reject(e.Content),t.errHandle||l.nk.error(`${t.path}:${e.Content}`)):c.push(e.Path,e.Content),delete d[e.RequestId]):c.push(e.Path,e.Content)},g=(e=o,t=s)=>{if(s=t,o=e,i.connecting||i.connected)return;null!=n&&n.close(),i.connecting=!0;const r=t||"snltty";n=new WebSocket(o,[r]),n.iddd=++u,n.onopen=f,n.onclose=p,n.onmessage=b},F=()=>{n&&n.close()},k=(e,t={},r=!1,l=15e3)=>new Promise(((o,u)=>{let s=++a;try{d[s]={resolve:o,reject:u,errHandle:r,path:e,time:Date.now(),timeout:l};let a=JSON.stringify({Path:e,RequestId:s,Content:"string"==typeof t?t:JSON.stringify(t)});i.connected&&1==n.readyState?n.send(a):u("网络错误~")}catch(m){console.log(m),u("网络错误~"),delete d[s]}})),w=Symbol(),S=e=>{c.add(w,e)}},9299:function(e,t,r){r.d(t,{BS:function(){return d},SZ:function(){return o},Se:function(){return i},VN:function(){return u},gC:function(){return m},jU:function(){return n},nD:function(){return s},rd:function(){return a}});var l=r(4);const a=e=>(0,l.zG)("signInclient/set",e),n=e=>(0,l.zG)("signInclient/setservers",e),o=()=>(0,l.zG)("signInclient/info"),u=e=>(0,l.zG)("signInclient/setorder",e),s=e=>(0,l.zG)("signInclient/List",e),d=e=>(0,l.zG)("signInclient/ids",e),i=e=>(0,l.zG)("signInclient/del",e),m=e=>(0,l.zG)("signInclient/setname",e)},920:function(e,t,r){r.d(t,{BJ:function(){return i},NS:function(){return o},Vk:function(){return d},aP:function(){return c},ir:function(){return s},lJ:function(){return n},mK:function(){return a},y2:function(){return m},yN:function(){return u}});var l=r(4);const a=(e="0")=>(0,l.zG)("updaterclient/get",e),n=e=>(0,l.zG)("updaterclient/confirm",e),o=e=>(0,l.zG)("updaterclient/exit",e),u=()=>(0,l.zG)("updaterclient/GetSecretKey"),s=e=>(0,l.zG)("updaterclient/SetSecretKey",e),d=()=>(0,l.zG)("updaterclient/getcurrent"),i=()=>(0,l.zG)("updaterclient/getserver"),m=e=>(0,l.zG)("updaterclient/confirmserver",e),c=()=>(0,l.zG)("updaterclient/exitserver")},3830:function(e,t,r){r.d(t,{B:function(){return s},v:function(){return u}});var l=r(4),a=r(144),n=r(6768);const o=Symbol(),u=()=>{const e=(0,a.KR)({api:{connected:!1},height:0,config:{Common:{},Client:{Servers:[]},Server:{},Running:{Relay:{Servers:[]},Tuntap:{IP:"",PrefixLength:24},Client:{Servers:[]}},configed:!1},signin:{Connected:!1,Connecting:!1,Version:"v1.0.0.0"},bufferSize:["1KB","2KB","4KB","8KB","16KB","32KB","64KB","128KB","256KB","512KB","1024KB"],updater:{},self:{}});return(0,l.jH)((t=>{e.value.api.connected=t})),(0,n.Gt)(o,e),e},s=()=>(0,n.WQ)(o)},6469:function(e,t,r){r.r(t),r.d(t,{default:function(){return re}});var l=r(6768);const a={class:"app-wrap flex flex-column flex-nowrap"},n={class:"head"},o={class:"body flex-1 relative",ref:"wrap"},u={class:"home absolute"},s={class:"status"};function d(e,t,r,d,i,m){const c=(0,l.g2)("Head"),f=(0,l.g2)("router-view"),p=(0,l.g2)("Status"),b=(0,l.g2)("Install");return(0,l.uX)(),(0,l.CE)("div",a,[(0,l.Lk)("div",n,[(0,l.bF)(c)]),(0,l.Lk)("div",o,[(0,l.Lk)("div",u,[(0,l.bF)(f)])],512),(0,l.Lk)("div",s,[(0,l.bF)(p,{config:!0}),(0,l.bF)(b)])])}var i=r.p+"img/logo.892cb2fb.png";const m=e=>((0,l.Qi)("data-v-0672251e"),e=e(),(0,l.jt)(),e),c={class:"head flex"},f={class:"logo"},p=m((()=>(0,l.Lk)("img",{src:i,alt:""},null,-1))),b={class:"menu flex-1"},v={class:"flex"};function g(e,t,r,a,n,o){const u=(0,l.g2)("router-link"),s=(0,l.g2)("StarFilled"),d=(0,l.g2)("el-icon"),i=(0,l.g2)("Tools"),m=(0,l.g2)("WarnTriangleFilled");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.Lk)("div",c,[(0,l.Lk)("div",f,[(0,l.bF)(u,{to:{name:"FullIndex"}},{default:(0,l.k6)((()=>[p])),_:1})]),(0,l.Lk)("div",b,[(0,l.Lk)("ul",v,[(0,l.Lk)("li",null,[(0,l.bF)(u,{to:{name:"FullIndex"}},{default:(0,l.k6)((()=>[(0,l.bF)(d,{size:"16"},{default:(0,l.k6)((()=>[(0,l.bF)(s)])),_:1}),(0,l.eW)(" 首页")])),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(u,{to:{name:"FullSettings"}},{default:(0,l.k6)((()=>[(0,l.bF)(d,{size:"16"},{default:(0,l.k6)((()=>[(0,l.bF)(i)])),_:1}),(0,l.eW)(" 配置")])),_:1})]),(0,l.Lk)("li",null,[(0,l.bF)(u,{to:{name:"FullLogger"}},{default:(0,l.k6)((()=>[(0,l.bF)(d,{size:"16"},{default:(0,l.k6)((()=>[(0,l.bF)(m)])),_:1}),(0,l.eW)(" 日志")])),_:1})])])])])])}var F=r(7477),k={components:{Tools:F.S0q,StarFilled:F.BQ2,WarnTriangleFilled:F.DtC},setup(){return{}}},w=r(1241);const S=(0,w.A)(k,[["render",g],["__scopeId","data-v-0672251e"]]);var y=S,h=r(445);const _=e=>((0,l.Qi)("data-v-fb770d2e"),e=e(),(0,l.jt)(),e),K={class:"head"},V={class:"body"},C=_((()=>(0,l.Lk)("div",{class:"t-c"},"完成保存后，请重启软件",-1))),P={class:"footer t-c"};function x(e,t,r,a,n,o){const u=(0,l.g2)("el-step"),s=(0,l.g2)("el-steps"),d=(0,l.g2)("Common"),i=(0,l.g2)("el-card"),m=(0,l.g2)("Server"),c=(0,l.g2)("Client"),f=(0,l.g2)("el-button"),p=(0,l.g2)("el-dialog");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(p,{modelValue:a.state.show,"onUpdate:modelValue":t[0]||(t[0]=e=>a.state.show=e),title:"初始化配置",width:"600",top:"2vh"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,[(0,l.Lk)("div",K,[(0,l.bF)(s,{active:a.step.step,"finish-status":"success"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.state.steps,((e,t)=>((0,l.uX)(),(0,l.Wv)(u,{title:e},null,8,["title"])))),256))])),_:1},8,["active"])]),(0,l.Lk)("div",V,[1==a.step.step?((0,l.uX)(),(0,l.Wv)(i,{key:0,shadow:"never"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{ref:"currentDom"},null,512)])),_:1})):(0,l.Q3)("",!0),2==a.step.step?((0,l.uX)(),(0,l.Wv)(i,{key:1,shadow:"never"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{ref:"currentDom"},null,512)])),_:1})):(0,l.Q3)("",!0),3==a.step.step?((0,l.uX)(),(0,l.Wv)(i,{key:2,shadow:"never"},{default:(0,l.k6)((()=>[(0,l.bF)(c,{ref:"currentDom"},null,512)])),_:1})):(0,l.Q3)("",!0),4==a.step.step?((0,l.uX)(),(0,l.Wv)(i,{key:3,shadow:"never"},{default:(0,l.k6)((()=>[C])),_:1})):(0,l.Q3)("",!0)]),(0,l.Lk)("div",P,[(0,l.bF)(f,{disabled:a.step.step<=1,onClick:a.handlePrev},{default:(0,l.k6)((()=>[(0,l.eW)("上一步")])),_:1},8,["disabled","onClick"]),a.step.step<a.state.steps.length?((0,l.uX)(),(0,l.Wv)(f,{key:0,type:"primary",onClick:a.handleNext},{default:(0,l.k6)((()=>[(0,l.eW)("下一步")])),_:1},8,["onClick"])):((0,l.uX)(),(0,l.Wv)(f,{key:1,type:"primary",onClick:a.handleSave},{default:(0,l.k6)((()=>[(0,l.eW)("完成")])),_:1},8,["onClick"]))])])])),_:1},8,["modelValue"])])}var j=r(3830),I=r(8835),z=r(144),L=r(1219);const W={class:"t-c"};function U(e,t,r,a,n,o){const u=(0,l.g2)("el-checkbox");return(0,l.uX)(),(0,l.CE)("div",W,[(0,l.bF)(u,{modelValue:a.state.form.client,"onUpdate:modelValue":t[0]||(t[0]=e=>a.state.form.client=e),label:"作为客户端"},null,8,["modelValue"]),(0,l.bF)(u,{modelValue:a.state.form.server,"onUpdate:modelValue":t[1]||(t[1]=e=>a.state.form.server=e),label:"作为服务端"},null,8,["modelValue"])])}var N={name:"Common",setup(){const e=(0,l.WQ)("step"),t=(0,z.Kh)({form:{client:e.value.form.common.client||e.value.json.Common&&e.value.json.Common.client||!1,server:e.value.form.common.server||e.value.json.Common&&e.value.json.Common.server||!1}}),r=e=>new Promise(((e,r)=>{t.form.client||t.form.server?e({json:{Common:{client:t.form.client,server:t.form.server,modes:[t.form.client?"client":"",t.form.server?"server":""].filter((e=>!!e))}},form:{common:JSON.parse(JSON.stringify(t.form))}}):(L.nk.error("请选择客户端或服务端"),r())}));return{state:t,handleValidate:r}}};const G=(0,w.A)(N,[["render",U]]);var B=G;const R=e=>((0,l.Qi)("data-v-ae9b37da"),e=e(),(0,l.jt)(),e),X=R((()=>(0,l.Lk)("div",{class:"t-c w-100"},[(0,l.Lk)("p",null,"端口为0则不监听，相同分组名之间的客户端相互可见")],-1)));function q(e,t,r,a,n,o){const u=(0,l.g2)("el-form-item"),s=(0,l.g2)("el-input"),d=(0,l.g2)("el-col"),i=(0,l.g2)("el-row"),m=(0,l.g2)("el-checkbox"),c=(0,l.g2)("el-form");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(c,{ref:"formDom",model:a.state.form,rules:a.state.rules,"label-width":"8rem"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"","label-width":"0"},{default:(0,l.k6)((()=>[X])),_:1}),(0,l.bF)(u,{label:"","label-width":"0"},{default:(0,l.k6)((()=>[(0,l.bF)(i,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"机器名",prop:"name"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>a.state.form.name=e),maxlength:"12","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"分组名",prop:"groupid"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.groupid,"onUpdate:modelValue":t[1]||(t[1]=e=>a.state.form.groupid=e),maxlength:"36","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.bF)(u,{label:"","label-width":"0"},{default:(0,l.k6)((()=>[(0,l.bF)(i,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"接口端口",prop:"api"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.api,"onUpdate:modelValue":t[2]||(t[2]=e=>a.state.form.api=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"网页端口",prop:"web"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.web,"onUpdate:modelValue":t[3]||(t[3]=e=>a.state.form.web=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.bF)(u,{label:"","label-width":"0"},{default:(0,l.k6)((()=>[(0,l.bF)(i,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"接口密码",prop:"password"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{style:{width:"42rem"},type:"password",modelValue:a.state.form.password,"onUpdate:modelValue":t[4]||(t[4]=e=>a.state.form.password=e),"show-password":"",maxlength:"36","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{"label-width":"8rem",prop:"hasServer"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{modelValue:a.state.form.hasServer,"onUpdate:modelValue":t[5]||(t[5]=e=>a.state.form.hasServer=e),label:"我有服务器",size:"large"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),a.state.form.hasServer?((0,l.uX)(),(0,l.Wv)(u,{key:0,label:"","label-width":"0"},{default:(0,l.k6)((()=>[(0,l.bF)(i,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"服务器",prop:"server"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.server,"onUpdate:modelValue":t[6]||(t[6]=e=>a.state.form.server=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"更新密钥",prop:"updaterSecretKey"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.updaterSecretKey,"onUpdate:modelValue":t[7]||(t[7]=e=>a.state.form.updaterSecretKey=e),maxlength:"36","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})):(0,l.Q3)("",!0),a.state.form.hasServer?((0,l.uX)(),(0,l.Wv)(u,{key:1,label:"","label-width":"0"},{default:(0,l.k6)((()=>[(0,l.bF)(i,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"穿透密钥",prop:"sForwardSecretKey"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.sForwardSecretKey,"onUpdate:modelValue":t[8]||(t[8]=e=>a.state.form.sForwardSecretKey=e),maxlength:"36","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"中继密钥",prop:"relaySecretKey"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.relaySecretKey,"onUpdate:modelValue":t[9]||(t[9]=e=>a.state.form.relaySecretKey=e),maxlength:"36","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})):(0,l.Q3)("",!0)])),_:1},8,["model","rules"])])}var Q={setup(e){const t=(0,l.WQ)("step"),r=(0,j.B)(),a=(0,z.Kh)({form:{name:t.value.form.client.name||r.value.config.Client.Name,groupid:t.value.form.client.groupid||r.value.config.Client.GroupId,api:t.value.form.client.api||r.value.config.Client.CApi.ApiPort,web:t.value.form.client.web||r.value.config.Client.CApi.WebPort,password:t.value.form.client.password||r.value.config.Client.CApi.ApiPassword,hasServer:t.value.form.client.hasServer||!1,server:t.value.form.client.server||r.value.config.Client.Server,sForwardSecretKey:t.value.form.client.sForwardSecretKey||r.value.config.Running.SForwardSecretKey,relaySecretKey:t.value.form.client.relaySecretKey||(r.value.config.Running.Relay.Servers[0]||{SecretKey:"snltty"}).SecretKey,updaterSecretKey:t.value.form.client.updaterSecretKey||r.value.config.Running.UpdaterSecretKey},rules:{name:[{required:!0,message:"必填",trigger:"blur"}],groupid:[{required:!0,message:"必填",trigger:"blur"}],password:[{required:!0,message:"必填",trigger:"blur"}],api:[{required:!0,message:"必填",trigger:"blur"},{type:"number",min:0,max:65535,message:"数字 0-65535",trigger:"blur",transform(e){return Number(e)}}],web:[{required:!0,message:"必填",trigger:"blur"},{type:"number",min:0,max:65535,message:"数字 0-65535",trigger:"blur",transform(e){return Number(e)}}]}}),n=(0,z.KR)(null),o=()=>new Promise(((e,t)=>{n.value.validate((r=>{r?e({json:{Client:{name:a.form.name,groupid:a.form.groupid,api:+a.form.api,web:+a.form.web,password:a.form.password,hasServer:a.form.hasServer,server:a.form.server,sForwardSecretKey:a.form.sForwardSecretKey,relaySecretKey:a.form.relaySecretKey,updaterSecretKey:a.form.updaterSecretKey}},form:{client:JSON.parse(JSON.stringify(a.form))}}):t()}))}));return(0,l.sV)((()=>{0==t.value.json.Common.client&&(t.value.step+=t.value.increment)})),{state:a,handleValidate:o,formDom:n}}};const A=(0,w.A)(Q,[["render",q],["__scopeId","data-v-ae9b37da"]]);var D=A;const J=e=>((0,l.Qi)("data-v-674f9540"),e=e(),(0,l.jt)(),e),O=J((()=>(0,l.Lk)("div",{class:"t-c w-100"},"端口为0则不监听",-1)));function T(e,t,r,a,n,o){const u=(0,l.g2)("el-form-item"),s=(0,l.g2)("el-input"),d=(0,l.g2)("el-col"),i=(0,l.g2)("el-row"),m=(0,l.g2)("el-form");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(m,{ref:"formDom",model:a.state.form,rules:a.state.rules,"label-width":"10rem"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"","label-width":"0"},{default:(0,l.k6)((()=>[O])),_:1}),(0,l.bF)(u,{label:"","label-width":"0"},{default:(0,l.k6)((()=>[(0,l.bF)(i,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"服务端口",prop:"servicePort"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.servicePort,"onUpdate:modelValue":t[0]||(t[0]=e=>a.state.form.servicePort=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"web穿透端口",prop:"webPort"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.webPort,"onUpdate:modelValue":t[1]||(t[1]=e=>a.state.form.webPort=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.bF)(u,{label:"","label-width":"0"},{default:(0,l.k6)((()=>[(0,l.bF)(i,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"开放最小端口",prop:"tunnelPort1"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.tunnelPort1,"onUpdate:modelValue":t[2]||(t[2]=e=>a.state.form.tunnelPort1=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"开放最大端口",prop:"tunnelPort2"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.tunnelPort2,"onUpdate:modelValue":t[3]||(t[3]=e=>a.state.form.tunnelPort2=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.bF)(u,{label:"","label-width":"0"},{default:(0,l.k6)((()=>[(0,l.bF)(i,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"穿透密钥",prop:"sForwardSecretKey"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.sForwardSecretKey,"onUpdate:modelValue":t[4]||(t[4]=e=>a.state.form.sForwardSecretKey=e),maxlength:"36","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.bF)(d,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"中继密钥",prop:"relaySecretKey"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.relaySecretKey,"onUpdate:modelValue":t[5]||(t[5]=e=>a.state.form.relaySecretKey=e),maxlength:"36","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.bF)(u,{label:"更新密钥",prop:"updaterSecretKey"},{default:(0,l.k6)((()=>[(0,l.bF)(s,{modelValue:a.state.form.updaterSecretKey,"onUpdate:modelValue":t[6]||(t[6]=e=>a.state.form.updaterSecretKey=e),maxlength:"36","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])}var E={setup(e){const t=(0,l.WQ)("step"),r=(0,j.B)(),a=(0,z.Kh)({show:!1,form:{relaySecretKey:t.value.form.server.relaySecretKey||r.value.config.Server.Relay.SecretKey,sForwardSecretKey:t.value.form.server.sForwardSecretKey||r.value.config.Server.SForward.SecretKey,servicePort:t.value.form.server.servicePort||r.value.config.Server.ServicePort,webPort:t.value.form.server.webPort||r.value.config.Server.SForward.WebPort,tunnelPort1:t.value.form.server.tunnelPort1||r.value.config.Server.SForward.TunnelPortRange[0],tunnelPort2:t.value.form.server.tunnelPort2||r.value.config.Server.SForward.TunnelPortRange[1],updaterSecretKey:t.value.form.server.updaterSecretKey||r.value.config.Server.Updater.SecretKey},rules:{relaySecretKey:[{required:!0,message:"必填",trigger:"blur"}],sForwardSecretKey:[{required:!0,message:"必填",trigger:"blur"}],servicePort:[{required:!0,message:"必填",trigger:"blur"},{type:"number",min:0,max:65535,message:"数字 0-65535",trigger:"blur",transform(e){return Number(e)}}],webPort:[{required:!0,message:"必填",trigger:"blur"},{type:"number",min:0,max:65535,message:"数字 0-65535",trigger:"blur",transform(e){return Number(e)}}],tunnelPort1:[{required:!0,message:"必填",trigger:"blur"},{type:"number",min:0,max:65535,message:"数字 0-65535",trigger:"blur",transform(e){return Number(e)}}],tunnelPort2:[{required:!0,message:"必填",trigger:"blur"},{type:"number",min:0,max:65535,message:"数字 0-65535",trigger:"blur",transform(e){return Number(e)}}]}}),n=(0,z.KR)(null),o=()=>new Promise(((e,t)=>{n.value.validate((r=>{0==r?t():e({json:{Server:{ServicePort:+a.form.servicePort,Relay:{SecretKey:a.form.relaySecretKey},SForward:{SecretKey:a.form.sForwardSecretKey,WebPort:+a.form.webPort,TunnelPortRange:[+a.form.tunnelPort1,+a.form.tunnelPort2]},Updater:{SecretKey:a.form.updaterSecretKey}}},form:{server:JSON.parse(JSON.stringify(a.form))}})}))}));return(0,l.sV)((()=>{0==t.value.json.Common.server&&(t.value.step+=t.value.increment)})),{state:a,handleValidate:o,formDom:n}}};const H=(0,w.A)(E,[["render",T],["__scopeId","data-v-674f9540"]]);var $=H,Y={components:{Common:B,Client:D,Server:$},setup(e){const t=(0,j.B)(),r=(0,z.Kh)({show:!1,steps:["选择模式","服务端","客户端","完成"]});(0,l.wB)((()=>t.value.config.configed),(e=>{e&&(r.show=t.value.api.connected&&t.value.config.configed&&0==t.value.config.Common.Install)}));const a=(0,z.KR)(null),n=(0,z.KR)({step:1,increment:1,json:{},form:{server:{},client:{},common:{}}});(0,l.Gt)("step",n);const o=()=>{n.value.step--,n.value.increment=-1},u=()=>{n.value.increment=1,a.value.handleValidate().then((e=>{n.value.json=Object.assign(n.value.json,e.json),n.value.form=Object.assign(n.value.form,e.form),n.value.step++})).catch((()=>{}))},s=()=>{(0,I.a)(n.value.json).then((()=>{L.nk.success("保存成功")})).catch((()=>{L.nk.error("保存失败")}))};return{state:r,currentDom:a,step:n,handlePrev:o,handleNext:u,handleSave:s}}};const Z=(0,w.A)(Y,[["render",x],["__scopeId","data-v-fb770d2e"]]);var M=Z,ee={name:"Index",components:{Head:y,Status:h.A,Install:M},setup(e){const t=(0,j.v)(),r=(0,z.KR)(null),a=()=>{(0,l.dY)((()=>{t.value.height=r.value.offsetHeight}))};return(0,l.sV)((()=>{window.addEventListener("resize",a),a()})),(0,l.hi)((()=>{window.removeEventListener("resize",a)})),{wrap:r}}};const te=(0,w.A)(ee,[["render",d],["__scopeId","data-v-0200d849"]]);var re=te}}]);