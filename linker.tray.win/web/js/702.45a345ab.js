"use strict";(self["webpackChunklinker_web"]=self["webpackChunklinker_web"]||[]).push([[702],{5702:function(e,a,l){l.r(a),l.d(a,{default:function(){return V}});var t=l(6768),o=l(4232);const n=e=>((0,t.Qi)("data-v-17f6d082"),e=e(),(0,t.jt)(),e),r={class:"logger-setting-wrap flex flex-column h-100",ref:"wrap"},g={class:"inner"},s={class:"head flex"},i=n((()=>(0,t.Lk)("span",{class:"flex-1"},null,-1))),d={class:"body flex-1 relative"},u={class:"pages t-c"},c={class:"page-wrap"};function b(e,a,l,n,b,p){const f=(0,t.g2)("el-option"),m=(0,t.g2)("el-select"),h=(0,t.g2)("el-button"),k=(0,t.g2)("el-table-column"),v=(0,t.g2)("el-table"),w=(0,t.g2)("el-pagination"),y=(0,t.g2)("el-tab-pane"),F=(0,t.g2)("Setting"),L=(0,t.g2)("el-tabs");return(0,t.uX)(),(0,t.CE)("div",r,[(0,t.bF)(L,{type:"border-card"},{default:(0,t.k6)((()=>[n.hasLogger?((0,t.uX)(),(0,t.Wv)(y,{key:0,label:"主页"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",g,[(0,t.Lk)("div",s,[(0,t.Lk)("div",null,[(0,t.bF)(m,{modelValue:n.state.type,"onUpdate:modelValue":a[0]||(a[0]=e=>n.state.type=e),onChange:n.loadData,size:"small",class:"m-r-1",style:{width:"6rem"}},{default:(0,t.k6)((()=>[(0,t.bF)(f,{value:-1,label:"all"}),(0,t.bF)(f,{value:0,label:"debug"}),(0,t.bF)(f,{value:1,label:"info"}),(0,t.bF)(f,{value:2,label:"warning"}),(0,t.bF)(f,{value:3,label:"error"}),(0,t.bF)(f,{value:4,label:"fatal"})])),_:1},8,["modelValue","onChange"])]),(0,t.bF)(h,{type:"warning",size:"small",loading:n.state.loading,onClick:n.clearData},{default:(0,t.k6)((()=>[(0,t.eW)("清空")])),_:1},8,["loading","onClick"]),(0,t.bF)(h,{size:"small",loading:n.state.loading,onClick:n.loadData},{default:(0,t.k6)((()=>[(0,t.eW)("刷新列表")])),_:1},8,["loading","onClick"]),i]),(0,t.Lk)("div",d,[(0,t.bF)(v,{border:"",data:n.state.page.List,size:"small",height:`${n.state.height}px`,onRowClick:n.handleRowClick,"row-class-name":n.tableRowClassName},{default:(0,t.k6)((()=>[(0,t.bF)(k,{type:"index",width:"50"}),(0,t.bF)(k,{prop:"Type",label:"类别",width:"80"},{default:(0,t.k6)((e=>[(0,t.Lk)("span",null,(0,o.v_)(n.state.types[e.row.Type]),1)])),_:1}),(0,t.bF)(k,{prop:"Time",label:"时间",width:"160"}),(0,t.bF)(k,{prop:"content",label:"内容"})])),_:1},8,["data","height","onRowClick","row-class-name"])]),(0,t.Lk)("div",u,[(0,t.Lk)("div",c,[(0,t.bF)(w,{small:"",total:n.state.page.Count,currentPage:n.state.page.Page,"onUpdate:currentPage":a[1]||(a[1]=e=>n.state.page.Page=e),"page-size":n.state.page.Size,onCurrentChange:n.handlePageChange,background:"",layout:"total,prev, pager, next"},null,8,["total","currentPage","page-size","onCurrentChange"])])])])])),_:1})):(0,t.Q3)("",!0),n.hasLoggerLevel?((0,t.uX)(),(0,t.Wv)(y,{key:1,label:"配置"},{default:(0,t.k6)((()=>[(0,t.bF)(F)])),_:1})):(0,t.Q3)("",!0)])),_:1})],512)}var p=l(144),f=l(4);const m=e=>(0,f.zG)("loggerclient/get",e),h=()=>(0,f.zG)("loggerclient/clear"),k=()=>(0,f.zG)("loggerclient/getconfig"),v=e=>(0,f.zG)("loggerclient/setconfig",e),w={class:"t-c w-100"};function y(e,a,l,o,n,r){const g=(0,t.g2)("el-input"),s=(0,t.g2)("el-form-item"),i=(0,t.g2)("el-col"),d=(0,t.g2)("el-option"),u=(0,t.g2)("el-select"),c=(0,t.g2)("el-row"),b=(0,t.g2)("el-button"),p=(0,t.g2)("el-form");return(0,t.uX)(),(0,t.Wv)(p,{"label-width":"8rem",ref:"formDom",model:o.state.form,rules:o.state.rules},{default:(0,t.k6)((()=>[(0,t.bF)(s,{label:"","label-width":"0"},{default:(0,t.k6)((()=>[(0,t.bF)(c,null,{default:(0,t.k6)((()=>[(0,t.bF)(i,{xs:24,sm:8,md:8,lg:8,xl:8},{default:(0,t.k6)((()=>[(0,t.bF)(s,{label:"显示数量",prop:"Size"},{default:(0,t.k6)((()=>[(0,t.bF)(g,{size:"default",modelValue:o.state.form.Size,"onUpdate:modelValue":a[0]||(a[0]=e=>o.state.form.Size=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.bF)(i,{xs:24,sm:8,md:8,lg:8,xl:8},{default:(0,t.k6)((()=>[(0,t.bF)(s,{label:"日志等级",prop:"LoggerType"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:o.state.form.LoggerType,"onUpdate:modelValue":a[1]||(a[1]=e=>o.state.form.LoggerType=e)},{default:(0,t.k6)((()=>[(0,t.bF)(d,{value:0,label:"debug"}),(0,t.bF)(d,{value:1,label:"info"}),(0,t.bF)(d,{value:2,label:"warning"}),(0,t.bF)(d,{value:3,label:"error"}),(0,t.bF)(d,{value:4,label:"fatal"})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,t.bF)(s,{"label-width":"0"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",w,[(0,t.bF)(b,{type:"primary",loading:o.state.loading,onClick:o.submit},{default:(0,t.k6)((()=>[(0,t.eW)("确 定")])),_:1},8,["loading","onClick"])])])),_:1})])),_:1},8,["model","rules"])}var F=l(1219),L={setup(){const e=(0,p.KR)(null),a=(0,p.Kh)({loading:!1,configInfo:{},form:{Size:0,LoggerType:-1},rules:{Size:[{required:!0,message:"必填",trigger:"blur"},{type:"number",min:1,max:1e4,message:"数字 1-10000",trigger:"blur",transform(e){return Number(e)}}]}}),l=()=>{k().then((e=>{a.configInfo=e,a.form.Size=e.Size,a.form.LoggerType=e.LoggerType})).catch((e=>{}))},o=()=>{let e=JSON.parse(JSON.stringify(a.configInfo));return e.Size=+a.form.Size,e.LoggerType=+a.form.LoggerType,e},n=()=>new Promise(((l,t)=>{e.value.validate((e=>{if(0==e)return t(),!1;a.loading=!0;const n=o();v(n).then((e=>{a.loading=!1,l(),e?F.nk.success("操作成功!"):F.nk.error("操作失败!")})).catch((()=>{a.loading=!1,l()}))}))}));return(0,t.sV)((()=>{l()})),{state:a,formDom:e,submit:n}}},C=l(1241);const z=(0,C.A)(L,[["render",y],["__scopeId","data-v-3f5e3a69"]]);var _=z,x=l(2933),S=l(3830),T={components:{Setting:_},setup(){const e=(0,S.B)(),a=(0,p.EW)((()=>e.value.hasAccess("LoggerShow"))),l=(0,p.EW)((()=>e.value.hasAccess("LoggerLevel"))),o=(0,p.KR)(null),n=(0,p.Kh)({loading:!0,type:-1,page:{Page:1,Size:20,Count:0,List:[]},types:["debug","info","warning","error","fatal"],height:(0,p.EW)((()=>e.value.height-180))}),r=()=>{n.loading=!0,m({Page:n.page.Page,Size:n.page.Size,Type:n.type}).then((e=>{n.loading=!1,e.List.map((e=>{e.content=e.Content.substring(0,50)})),n.page=e})).catch((e=>{console.log(e),n.loading=!1}))},g=e=>{e&&(n.page.Page=e,r())},s=()=>{n.loading=!0,h().then((()=>{n.loading=!1,r()})).catch((()=>{n.loading=!1}))},i=({row:e,rowIndex:a})=>`type-${e.Type}`,d=(e,a,l)=>{let t="padding:1rem;border:1px solid #ddd; resize:none;width:39rem;box-sizing: border-box;white-space: nowrap; height:30rem;";x.s.alert(`<textarea class="scrollbar-4" style="${t}">${e.Content}</textarea>`,"内容",{dangerouslyUseHTMLString:!0}).catch((()=>{}))};return(0,t.sV)((()=>{r()})),{hasLogger:a,hasLoggerLevel:l,wrap:o,state:n,loadData:r,clearData:s,tableRowClassName:i,handleRowClick:d,handlePageChange:g}}};const P=(0,C.A)(T,[["render",b],["__scopeId","data-v-17f6d082"]]);var V=P}}]);