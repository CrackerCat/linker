"use strict";(self["webpackChunklinker_web"]=self["webpackChunklinker_web"]||[]).push([[772],{4:function(e,t,n){n.d(t,{a1:function(){return v},e3:function(){return I},jH:function(){return y},zG:function(){return k}});n(4114),n(6573),n(8100),n(7936);var i=n(1219);let a=0,s=null,l="",u=1,r="";const o={},c={connected:!1,connecting:!1},d=()=>{const e=Date.now();for(let t in o){const n=o[t];e-n.time>n.timeout&&(n.reject("超时~"),delete o[t])}setTimeout(d,1e3)};d();const m={subs:{},add:function(e,t){"function"==typeof t&&(this.subs[e]||(this.subs[e]=[]),this.subs[e].push(t))},remove(e,t){let n=this.subs[e]||[];for(let i=n.length-1;i>=0;i--)n[i]==t&&n.splice(i,1)},push(e,t){let n=this.subs[e]||[];for(let i=n.length-1;i>=0;i--)n[i](t)}},h=()=>{c.connected=!0,c.connecting=!1,m.push(C,c.connected)},p=e=>{c.connected=!1,c.connecting=!1,m.push(C,c.connected),setTimeout((()=>{v()}),1e3)},f=e=>{if("string"!=typeof e.data)return void e.data.arrayBuffer().then((t=>{const n=new DataView(t).getInt8(),i=new FileReader;i.readAsText(e.data.slice(4,4+n),"utf8"),i.onload=()=>{let a=JSON.parse(i.result);a.Content={Name:a.Content,Img:e.data.slice(4+n,e.data.length),ArrayBuffer:t},g(a)}}));let t=JSON.parse(e.data);g(t)},g=e=>{let t=o[e.RequestId];t?(0==e.Code?t.resolve(e.Content):1==e.Code?t.reject(e.Content):255==e.Code?(t.reject(e.Content),t.errHandle||i.nk.error(`${t.path}:${e.Content}`)):m.push(e.Path,e.Content),delete o[e.RequestId]):m.push(e.Path,e.Content)},v=(e=l,t=r)=>{if(r=t,l=e,c.connecting||c.connected)return;null!=s&&s.close(),c.connecting=!0;const n=t||"snltty";s=new WebSocket(l,[n]),s.iddd=++u,s.onopen=h,s.onclose=p,s.onmessage=f},I=()=>{s&&s.close()},k=(e,t={},n=!1,i=15e3)=>new Promise(((l,u)=>{let r=++a;try{o[r]={resolve:l,reject:u,errHandle:n,path:e,time:Date.now(),timeout:i};let a=JSON.stringify({Path:e,RequestId:r,Content:"string"==typeof t?t:JSON.stringify(t)});c.connected&&1==s.readyState?s.send(a):u("网络错误~")}catch(d){console.log(d),u("网络错误~"),delete o[r]}})),C=Symbol(),y=e=>{m.add(C,e)}},9299:function(e,t,n){n.d(t,{BS:function(){return o},SZ:function(){return l},Se:function(){return c},VN:function(){return u},gC:function(){return d},jU:function(){return s},nD:function(){return r},rd:function(){return a}});var i=n(4);const a=e=>(0,i.zG)("signInclient/set",e),s=e=>(0,i.zG)("signInclient/setservers",e),l=()=>(0,i.zG)("signInclient/info"),u=e=>(0,i.zG)("signInclient/setorder",e),r=e=>(0,i.zG)("signInclient/List",e),o=e=>(0,i.zG)("signInclient/ids",e),c=e=>(0,i.zG)("signInclient/del",e),d=e=>(0,i.zG)("signInclient/setname",e)},5241:function(e,t,n){n.d(t,{PR:function(){return r},Yh:function(){return c},ac:function(){return o},en:function(){return u},kl:function(){return a},vB:function(){return s},zi:function(){return l}});var i=n(4);const a=(e="0")=>(0,i.zG)("tuntapclient/connections",e),s=e=>(0,i.zG)("tuntapclient/removeconnection",e),l=(e="0")=>(0,i.zG)("tuntapclient/get",e),u=e=>(0,i.zG)("tuntapclient/run",e),r=e=>(0,i.zG)("tuntapclient/stop",e),o=e=>(0,i.zG)("tuntapclient/update",e),c=()=>(0,i.zG)("tuntapclient/refresh")},920:function(e,t,n){n.d(t,{BJ:function(){return c},NS:function(){return l},Vk:function(){return o},aP:function(){return m},ir:function(){return r},lJ:function(){return s},mK:function(){return a},y2:function(){return d},yN:function(){return u}});var i=n(4);const a=(e="0")=>(0,i.zG)("updaterclient/get",e),s=e=>(0,i.zG)("updaterclient/confirm",e),l=e=>(0,i.zG)("updaterclient/exit",e),u=()=>(0,i.zG)("updaterclient/GetSecretKey"),r=e=>(0,i.zG)("updaterclient/SetSecretKey",e),o=()=>(0,i.zG)("updaterclient/getcurrent"),c=()=>(0,i.zG)("updaterclient/getserver"),d=e=>(0,i.zG)("updaterclient/confirmserver",e),m=()=>(0,i.zG)("updaterclient/exitserver")},3830:function(e,t,n){n.d(t,{B:function(){return r},v:function(){return u}});var i=n(4),a=n(144),s=n(6768);const l=Symbol(),u=()=>{const e=(0,a.KR)({api:{connected:!1},height:0,config:{Common:{},Client:{Servers:[]},Server:{},Running:{Relay:{Servers:[]},Tuntap:{IP:"",PrefixLength:24},Client:{Servers:[]}},configed:!1},signin:{Connected:!1,Connecting:!1,Version:"v1.0.0.0"},bufferSize:["1KB","2KB","4KB","8KB","16KB","32KB","64KB","128KB","256KB","512KB","1024KB"],updater:{},self:{}});return(0,i.jH)((t=>{e.value.api.connected=t})),(0,s.Gt)(l,e),e},r=()=>(0,s.WQ)(l)},7985:function(e,t,n){n.d(t,{r:function(){return r}});n(4114);var i=n(9299),a=n(3830),s=n(6768),l=n(144);const u=[],r=()=>{const e=(0,a.B)(),t=(0,s.EW)((()=>e.value.config.Client.Id)),n=(0,l.Kh)({timer:0,page:{Request:{Page:1,Size:+(localStorage.getItem("ps")||"10"),Name:"",Ids:[],Prop:"",Asc:!0},Count:0,List:[]},showDeviceEdit:!1,deviceInfo:null}),r=()=>{(0,i.nD)(n.page.Request).then((i=>{n.page.Request=i.Request,n.page.Count=i.Count;for(let n in i.List)Object.assign(i.List[n],{showDel:t.value!=i.List[n].MachineId&&0==i.List[n].Connected,showReboot:i.List[n].Connected,isSelf:t.value==i.List[n].MachineId,showip:!1}),i.List[n].isSelf&&(e.value.self=i.List[n]);n.page.List=i.List;for(let e=0;e<n.page.List.length;e++)u.push(n.page.List[e])})).catch((e=>{}))},o=()=>{e.value.api.connected?(0,i.nD)(n.page.Request).then((i=>{for(let a in i.List){const s=n.page.List.filter((e=>e.MachineId==i.List[a].MachineId))[0];s&&(Object.assign(s,{Connected:i.List[a].Connected,Version:i.List[a].Version,LastSignIn:i.List[a].LastSignIn,Args:i.List[a].Args,showDel:t.value!=i.List[a].MachineId&&0==i.List[a].Connected,showReboot:i.List[a].Connected,isSelf:t.value==i.List[a].MachineId}),s.isSelf&&(e.value.self=s))}n.timer=setTimeout(o,5e3)})).catch((e=>{n.timer=setTimeout(o,5e3)})):n.timer=setTimeout(o,5e3)},c=()=>{try{if(0==u.length)return void setTimeout(c,1e3);const e=u.shift();fetch(`http://ip-api.com/json/${e.IP.split(":")[0]}`).then((async t=>{try{const n=await t.json();e.countryFlag=`https://unpkg.com/flag-icons@7.2.3/flags/4x3/${n.countryCode.toLowerCase()}.svg`}catch(n){}setTimeout(c,1e3)})).catch((()=>{setTimeout(c,1e3)}))}catch(e){setTimeout(c,1e3)}};c();const d=e=>{n.deviceInfo=e,n.showDeviceEdit=!0},m=e=>{e&&(n.page.Request.Page=e),r()},h=e=>{e&&(n.page.Request.Size=e,localStorage.setItem("ps",e)),r()},p=e=>{(0,i.Se)(e).then((()=>{r()}))},f=()=>{clearTimeout(n.timer),n.timer=0},g=e=>(0,i.VN)(e);return{devices:n,machineId:t,_getSignList:r,_getSignList1:o,handleDeviceEdit:d,handlePageChange:m,handlePageSizeChange:h,handleDel:p,clearDevicesTimeout:f,setSort:g}}},8104:function(e,t,n){n.d(t,{O:function(){return o},W:function(){return c}});var i=n(3830),a=n(1219),s=n(144),l=n(6768),u=n(5241);const r=Symbol(),o=()=>{const e=(0,i.B)(),t=(0,s.KR)({timer:0,showEdit:!1,current:null,list:{},hashcode:0});(0,l.Gt)(r,t);const n={linux:["debian","ubuntu","alpine","rocky","centos"],windows:["windows"],android:["android"],ios:["ios"]},o=()=>{clearTimeout(t.value.timer),e.value.api.connected?(0,u.zi)(t.value.hashcode.toString()).then((e=>{if(t.value.hashcode=e.HashCode,e.List){for(let t in e.List){let i="system";const a=e.List[t].SystemInfo.toLowerCase();for(let e in n)if(a.indexOf(e)>=0){const t=n[e];if(1==t.length)i=t[0];else for(let e=0;e<t.length;e++)if(a.indexOf(t[e])>=0){i=t[e];break}break}Object.assign(e.List[t],{running:2==e.List[t].Status,loading:1==e.List[t].Status,system:i,systemDocker:a.indexOf("docker")>=0})}t.value.list=e.List}t.value.timer=setTimeout(o,1100)})).catch((e=>{t.value.timer=setTimeout(o,1100)})):t.value.timer=setTimeout(o,50)},c=e=>{console.log(e),t.value.current=e,t.value.showEdit=!0},d=()=>{(0,u.Yh)(),a.nk.success({message:"刷新成功",grouping:!0})},m=()=>{clearTimeout(t.value.timer),t.value.timer=0},h=e=>Object.values(t.value.list).filter((t=>t.IP.indexOf(e)>=0||t.LanIPs.filter((t=>t.indexOf(e)>=0)).length>0)).map((e=>e.MachineId)),p=e=>{const n=Object.values(t.value.list).filter((e=>e.IP)).sort(((e,t)=>{const n=e.IP.split(".").map((e=>Number(e))),i=t.IP.split(".").map((e=>Number(e)));for(let a=0;a<n.length;a++)if(n[a]!=i[a])return n[a]-i[a];return 0}));return n.map((e=>e.MachineId))};return{tuntap:t,_getTuntapInfo:o,handleTuntapEdit:c,handleTuntapRefresh:d,clearTuntapTimeout:m,getTuntapMachines:h,sortTuntapIP:p}},c=()=>(0,l.WQ)(r)},9383:function(e,t,n){n.d(t,{T:function(){return o},d:function(){return r}});var i=n(920),a=n(3830),s=n(144),l=n(6768);const u=Symbol(),r=()=>{const e=(0,a.B)(),t=(0,s.KR)({timer:0,list:{},hashcode:0,current:{Version:"",Msg:[],DateTime:"",Status:0,Length:0,Current:0}});(0,l.Gt)(u,t);const n=()=>{e.value.api.connected?(0,i.mK)(t.value.hashcode.toString()).then((i=>{if(t.value.hashcode=i.HashCode,i.List){const n=Object.values(i.List).filter((e=>!!e.Version))[0];n&&(Object.assign(t.value.current,{DateTime:n.DateTime,Version:n.Version,Status:n.Status,Length:n.Length,Current:n.Current,Msg:n.Msg}),e.value.updater=t.value.current),t.value.list=i.List}t.value.timer=setTimeout(n,800)})).catch((()=>{t.value.timer=setTimeout(n,800)})):t.value.timer=setTimeout(n,800)},r=()=>{clearTimeout(t.value.timer)};return{updater:t,_getUpdater:n,clearUpdaterTimeout:r}},o=()=>(0,l.WQ)(u)},8809:function(e,t,n){n.d(t,{A:function(){return h}});var i=n(6768);const a=(0,i.Lk)("div",null,"修改后最好能重启一次客户端",-1),s={class:"t-c w-100"};function l(e,t,n,l,u,r){const o=(0,i.g2)("el-form-item"),c=(0,i.g2)("el-input"),d=(0,i.g2)("el-button"),m=(0,i.g2)("el-form"),h=(0,i.g2)("el-dialog");return(0,i.uX)(),(0,i.Wv)(h,{modelValue:l.state.show,"onUpdate:modelValue":t[2]||(t[2]=e=>l.state.show=e),"close-on-click-modal":!1,"append-to":".app-wrap",title:"设置设备",width:"300"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",null,[(0,i.bF)(m,{ref:"ruleFormRef",model:l.state.ruleForm,rules:l.state.rules,"label-width":"auto"},{default:(0,i.k6)((()=>[(0,i.bF)(o,{label:""},{default:(0,i.k6)((()=>[a])),_:1}),(0,i.bF)(o,{label:"设备名",prop:"MachineName"},{default:(0,i.k6)((()=>[(0,i.bF)(c,{maxlength:"12","show-word-limit":"",modelValue:l.state.ruleForm.MachineName,"onUpdate:modelValue":t[0]||(t[0]=e=>l.state.ruleForm.MachineName=e)},null,8,["modelValue"])])),_:1}),(0,i.bF)(o,{label:"",prop:"Btns"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",s,[(0,i.bF)(d,{onClick:t[1]||(t[1]=e=>l.state.show=!1)},{default:(0,i.k6)((()=>[(0,i.eW)("取消")])),_:1}),(0,i.bF)(d,{type:"primary",onClick:l.handleSave},{default:(0,i.k6)((()=>[(0,i.eW)("确认")])),_:1},8,["onClick"])])])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue"])}var u=n(9299),r=n(1219),o=n(144),c={props:["data","modelValue"],emits:["change","update:modelValue"],setup(e,{emit:t}){const n=(0,o.KR)(null),a=(0,o.Kh)({show:!0,ruleForm:{MachineName:e.data.MachineName},rules:{}});(0,i.wB)((()=>a.show),(e=>{e||setTimeout((()=>{t("update:modelValue",e)}),300)}));const s=()=>{e.data.MachineName!=a.ruleForm.MachineName&&(0,u.gC)({Id:e.data.MachineId,newName:a.ruleForm.MachineName}).then((()=>{a.show=!1,r.nk.success("已操作！"),t("change")})).catch((()=>{r.nk.error("操作失败！")}))};return{state:a,ruleFormRef:n,handleSave:s}}},d=n(1241);const m=(0,d.A)(c,[["render",l]]);var h=m},5649:function(e,t,n){n.d(t,{A:function(){return v}});var i=n(6768),a=n(4232);const s=["title"],l=["src"],u=["src"],r={key:1,class:"system",src:"/docker.svg"},o={key:1};function c(e,t,n,c,d,m){const h=(0,i.g2)("StarFilled"),p=(0,i.g2)("el-icon");return(0,i.uX)(),(0,i.CE)("div",null,[c.tuntap.list[c.item.MachineId]&&c.tuntap.list[c.item.MachineId].system?((0,i.uX)(),(0,i.CE)("span",{key:0,title:c.tuntap.list[c.item.MachineId].SystemInfo},[c.item.countryFlag?((0,i.uX)(),(0,i.CE)("img",{key:0,class:"system",src:c.item.countryFlag},null,8,l)):(0,i.Q3)("",!0),(0,i.Lk)("img",{class:"system",src:`/${c.tuntap.list[c.item.MachineId].system}.svg`},null,8,u),c.tuntap.list[c.item.MachineId].systemDocker?((0,i.uX)(),(0,i.CE)("img",r)):(0,i.Q3)("",!0)],8,s)):(0,i.Q3)("",!0),(0,i.Lk)("a",{href:"javascript:;",onClick:t[0]||(t[0]=(...e)=>c.handleEdit&&c.handleEdit(...e)),title:"此客户端的设备名",class:(0,a.C4)({green:c.item.Connected})},(0,a.v_)(c.item.MachineName),3),c.item.isSelf?((0,i.uX)(),(0,i.CE)("strong",o,[(0,i.eW)(" - ("),(0,i.bF)(p,null,{default:(0,i.k6)((()=>[(0,i.bF)(h)])),_:1}),(0,i.eW)(" 本机) ")])):(0,i.Q3)("",!0)])}var d=n(3830),m=n(8104),h=n(7477),p={props:["item","config"],emits:["edit","refresh"],components:{StarFilled:h.BQ2},setup(e,{emit:t}){const n=(0,m.W)(),a=(0,d.B)(),s=(0,i.EW)((()=>a.value.config.Client.Id)),l=()=>{(e.config||s.value==e.item.MachineId)&&t("edit",e.item)};return{item:(0,i.EW)((()=>e.item)),tuntap:n,handleEdit:l}}},f=n(1241);const g=(0,f.A)(p,[["render",c],["__scopeId","data-v-43ee8088"]]);var v=g},9120:function(e,t,n){n.d(t,{A:function(){return L}});var i=n(6768),a=n(4232);const s={class:"flex"},l={class:"flex-1"},u=["title"],r={class:"red"},o={key:0},c={class:"yellow"},d={key:1},m={key:0,class:"delay green"},h={class:"delay yellow"};function p(e,t,n,p,f,g){const v=(0,i.g2)("el-popover"),I=(0,i.g2)("Loading"),k=(0,i.g2)("el-icon"),C=(0,i.g2)("el-switch");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.Lk)("div",s,[(0,i.Lk)("div",l,[(0,i.Lk)("a",{href:"javascript:;",class:"a-line",onClick:t[0]||(t[0]=e=>p.handleTuntapIP(p.tuntap.list[p.item.MachineId])),title:p.tuntap.list[p.item.MachineId].Gateway?"我在路由器上，所以略有不同":"此设备的虚拟网卡IP"},[p.tuntap.list[p.item.MachineId].Error?((0,i.uX)(),(0,i.Wv)(v,{key:0,placement:"top",title:"msg",width:"20rem",trigger:"hover",content:p.tuntap.list[p.item.MachineId].Error},{reference:(0,i.k6)((()=>[(0,i.Lk)("strong",r,(0,a.v_)(p.tuntap.list[p.item.MachineId].IP),1)])),_:1},8,["content"])):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[p.tuntap.list[p.item.MachineId].running?((0,i.uX)(),(0,i.CE)("strong",{key:0,class:(0,a.C4)(["green",{gateway:p.tuntap.list[p.item.MachineId].Gateway}])},(0,a.v_)(p.tuntap.list[p.item.MachineId].IP),3)):((0,i.uX)(),(0,i.CE)("strong",{key:1,class:(0,a.C4)({gateway:p.tuntap.list[p.item.MachineId].Gateway})},(0,a.v_)(p.tuntap.list[p.item.MachineId].IP),3))],64))],8,u)]),p.tuntap.list[p.item.MachineId].loading?((0,i.uX)(),(0,i.CE)("div",o,[(0,i.bF)(k,{size:"14",class:"loading"},{default:(0,i.k6)((()=>[(0,i.bF)(I)])),_:1})])):((0,i.uX)(),(0,i.Wv)(C,{key:1,modelValue:p.tuntap.list[p.item.MachineId].running,"onUpdate:modelValue":t[1]||(t[1]=e=>p.tuntap.list[p.item.MachineId].running=e),loading:p.tuntap.list[p.item.MachineId].loading,disabled:"",onClick:t[2]||(t[2]=e=>p.handleTuntap(p.tuntap.list[p.item.MachineId])),size:"small","inline-prompt":"","active-text":"😀","inactive-text":"😣"},null,8,["modelValue","loading"]))]),(0,i.Lk)("div",null,[p.tuntap.list[p.item.MachineId].Error1?((0,i.uX)(),(0,i.Wv)(v,{key:0,placement:"top",title:"msg",width:"20rem",trigger:"hover",content:p.tuntap.list[p.item.MachineId].Error1},{reference:(0,i.k6)((()=>[(0,i.Lk)("div",c,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.tuntap.list[p.item.MachineId].LanIPs,((e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:t},(0,a.v_)(e)+" / "+(0,a.v_)(p.tuntap.list[p.item.MachineId].Masks[t]),1)))),128))])])),_:1},8,["content"])):((0,i.uX)(),(0,i.CE)("div",d,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.tuntap.list[p.item.MachineId].LanIPs,((e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:t},(0,a.v_)(e)+" / "+(0,a.v_)(p.tuntap.list[p.item.MachineId].Masks[t]),1)))),128))])),p.showDelay?((0,i.uX)(),(0,i.CE)(i.FK,{key:2},[p.tuntap.list[p.item.MachineId].Delay>=0&&p.tuntap.list[p.item.MachineId].Delay<=100?((0,i.uX)(),(0,i.CE)("div",m,(0,a.v_)(p.tuntap.list[p.item.MachineId].Delay)+"ms",1)):(0,i.Q3)("",!0),(0,i.Lk)("template",null,[(0,i.Lk)("div",h,(0,a.v_)(p.tuntap.list[p.item.MachineId].Delay)+"ms",1)])],64)):(0,i.Q3)("",!0)])])}var f=n(5241),g=n(1219),v=n(8104),I=n(7477),k=n(3830),C={props:["item","config"],emits:["edit","refresh"],components:{Loading:I.Rhj},setup(e,{emit:t}){const n=(0,v.W)(),a=(0,k.B)(),s=(0,i.EW)((()=>a.value.config.Client.Id)),l=(0,i.EW)((()=>2==(2&(a.value.config.Running.Tuntap||{Switch:0}).Switch))),u=t=>{if(!e.config&&s.value!=t.MachineId)return;const n=t.running?(0,f.PR)(t.MachineId):(0,f.en)(t.MachineId);t.loading=!0,n.then((()=>{g.nk.success("操作成功！")})).catch((()=>{g.nk.error("操作失败！")}))},r=n=>{(e.config||s.value==n.MachineId)&&t("edit",n)},o=()=>{t("refresh")};return{item:(0,i.EW)((()=>e.item)),tuntap:n,showDelay:l,handleTuntap:u,handleTuntapIP:r,handleTuntapRefresh:o}}},y=n(1241);const M=(0,y.A)(C,[["render",p],["__scopeId","data-v-4aa9109b"]]);var L=M},3929:function(e,t,n){n.d(t,{A:function(){return C}});var i=n(6768),a=n(4232);const s=["title"],l={key:0,class:"progress"},u={key:1,class:"progress"};function r(e,t,n,r,o,c){const d=(0,i.g2)("Loading"),m=(0,i.g2)("el-icon"),h=(0,i.g2)("Download"),p=(0,i.g2)("CircleCheck");return(0,i.uX)(),(0,i.CE)("a",{href:"javascript:;",class:(0,a.C4)(["download",r.updaterColor]),onClick:t[0]||(t[0]=e=>r.handleUpdate()),title:r.updaterText},[(0,i.Lk)("span",null,[(0,i.Lk)("span",null,(0,a.v_)(r.item.Version),1),r.updater.list[r.item.MachineId]?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[1==r.updater.list[r.item.MachineId].Status?((0,i.uX)(),(0,i.Wv)(m,{key:0,size:"14",class:"loading"},{default:(0,i.k6)((()=>[(0,i.bF)(d)])),_:1})):2==r.updater.list[r.item.MachineId].Status?((0,i.uX)(),(0,i.Wv)(m,{key:1,size:"14"},{default:(0,i.k6)((()=>[(0,i.bF)(h)])),_:1})):3==r.updater.list[r.item.MachineId].Status||5==r.updater.list[r.item.MachineId].Status?((0,i.uX)(),(0,i.CE)(i.FK,{key:2},[(0,i.bF)(m,{size:"14",class:"loading"},{default:(0,i.k6)((()=>[(0,i.bF)(d)])),_:1}),0==r.updater.list[r.item.MachineId].Length?((0,i.uX)(),(0,i.CE)("span",l,"0%")):((0,i.uX)(),(0,i.CE)("span",u,(0,a.v_)(parseInt(r.updater.list[r.item.MachineId].Current/r.updater.list[r.item.MachineId].Length*100))+"%",1))],64)):6==r.updater.list[r.item.MachineId].Status?((0,i.uX)(),(0,i.Wv)(m,{key:3,size:"14",class:"yellow"},{default:(0,i.k6)((()=>[(0,i.bF)(p)])),_:1})):(0,i.Q3)("",!0)],64)):((0,i.uX)(),(0,i.Wv)(m,{key:1,size:"14"},{default:(0,i.k6)((()=>[(0,i.bF)(h)])),_:1}))])],10,s)}n(4114);var o=n(3830),c=n(9383),d=n(144),m=n(1219),h=n(2933),p=n(2248),f=n(920),g=n(7477),v={props:["item","config"],components:{Download:g.f5X,Loading:g.Rhj,CircleCheck:g.rW7},setup(e){const t=(0,o.B)(),n=(0,i.EW)((()=>t.value.config.Client.Id)),a=(0,c.T)(),s=(0,i.EW)((()=>t.value.signin.Version)),l=(0,i.EW)((()=>a.value.current.Version)),u=(0,i.EW)((()=>`${l.value}->${a.value.current.DateTime}\n${a.value.current.Msg.map(((e,t)=>`${t+1}、${e}`)).join("\n")}`)),r=(0,i.EW)((()=>a.value.list[e.item.MachineId]?a.value.list[e.item.MachineId].Status<=2?e.item.Version!=s.value?`与服务器版本(${s.value})不一致，建议更新`:l.value!=e.item.Version?`不是最新版本(${l.value})，建议更新\n${u.value}`:`是最新版本，但我无法阻止你喜欢更新\n${u.value}`:{3:"正在下载",4:"已下载",5:"正在解压",6:"已解压，请重启"}[a.value.list[e.item.MachineId].Status]:"未检测到更新")),g=(0,i.EW)((()=>e.item.Version!=s.value?"red":a.value.list[e.item.MachineId]&&l.value!=e.item.Version?"yellow":"green")),v=()=>{if(!e.config&&n.value!=e.item.MachineId)return;const t=a.value.list[e.item.MachineId];if(t)if([0,1,3,5].indexOf(t.Status)>=0)m.nk.error("操作中，请稍后!");else if(6!=t.Status){if(2==t.Status){const t=(0,d.KR)(l.value),n=[(0,i.h)(p.P9,{label:`仅[${e.item.MachineName}] -> ${l.value}(最新版本)`,value:l.value})];e.config&&n.push((0,i.h)(p.P9,{label:`[所有] -> ${l.value}(最新版本)`,value:`all->${l.value}`})),e.item.Version!=s.value&&l.value!=s.value&&(n.push((0,i.h)(p.P9,{label:`仅[${e.item.MachineName}] -> ${s.value}(服务器版本)`,value:s.value})),e.config&&n.push((0,i.h)(p.P9,{label:`[所有] -> ${s.value}(服务器版本)`,value:`all->${s.value}`}))),(0,h.s)({title:"选择版本",message:()=>(0,i.h)(p.AV,{modelValue:t.value,placeholder:"请选择",style:"width:20rem;","onUpdate:modelValue":e=>{t.value=e}},n),confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{const n={MachineId:e.item.MachineId,Version:t.value.replace("all->",""),All:t.value.indexOf("all->")>=0};n.All&&(n.MachineId=""),(0,f.lJ)(n)})).catch((()=>{}))}}else h.s.confirm("确定关闭程序吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{exit(e.item.MachineId)})).catch((()=>{}));else m.nk.error("未检测到更新")};return{item:(0,i.EW)((()=>e.item)),updater:a,updaterText:r,updaterColor:g,handleUpdate:v}}},I=n(1241);const k=(0,I.A)(v,[["render",r],["__scopeId","data-v-260a68e5"]]);var C=k}}]);