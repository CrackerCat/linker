"use strict";(self["webpackChunklinker_web"]=self["webpackChunklinker_web"]||[]).push([[625],{920:function(e,t,a){a.d(t,{BJ:function(){return c},NS:function(){return s},Vk:function(){return u},aP:function(){return p},ir:function(){return r},lJ:function(){return o},mK:function(){return l},y2:function(){return d},yN:function(){return i}});var n=a(4);const l=(e="0")=>(0,n.zG)("updaterclient/get",e),o=e=>(0,n.zG)("updaterclient/confirm",e),s=e=>(0,n.zG)("updaterclient/exit",e),i=()=>(0,n.zG)("updaterclient/GetSecretKey"),r=e=>(0,n.zG)("updaterclient/SetSecretKey",e),u=()=>(0,n.zG)("updaterclient/getcurrent"),c=()=>(0,n.zG)("updaterclient/getserver"),d=e=>(0,n.zG)("updaterclient/confirmserver",e),p=()=>(0,n.zG)("updaterclient/exitserver")},5962:function(e,t,a){a.d(t,{Y:function(){return i},q:function(){return r}});var n=a(8835),l=a(144),o=a(6768);const s=Symbol(),i=()=>{const e=(0,l.KR)({list:{},timer:0,hashcode:0});(0,o.Gt)(s,e);const t=()=>{(0,n.QI)(e.value.hashcode.toString()).then((a=>{e.value.hashcode=a.HashCode,a.List&&(e.value.list=a.List),e.value.timer=setTimeout(t,1e3)})).catch((()=>{e.value.timer=setTimeout(t,1e3)}))},a=()=>{clearTimeout(e.value.timer)};return{access:e,_getAccessInfo:t,clearAccessTimeout:a}},r=()=>(0,o.WQ)(s)},9383:function(e,t,a){a.d(t,{T:function(){return u},d:function(){return r}});var n=a(920),l=a(3830),o=a(144),s=a(6768);const i=Symbol(),r=()=>{const e=(0,l.B)(),t=(0,o.KR)({timer:0,list:{},hashcode:0,current:{Version:"",Msg:[],DateTime:"",Status:0,Length:0,Current:0}});(0,s.Gt)(i,t);const a=()=>{(0,n.mK)(t.value.hashcode.toString()).then((n=>{if(t.value.hashcode=n.HashCode,n.List){const a=Object.values(n.List).filter((e=>!!e.Version))[0];a&&(Object.assign(t.value.current,{DateTime:a.DateTime,Version:a.Version,Status:a.Status,Length:a.Length,Current:a.Current,Msg:a.Msg}),e.value.updater=t.value.current),t.value.list=n.List}t.value.timer=setTimeout(a,800)})).catch((()=>{t.value.timer=setTimeout(a,800)}))},r=()=>{clearTimeout(t.value.timer)};return{updater:t,_getUpdater:a,clearUpdaterTimeout:r}},u=()=>(0,s.WQ)(i)},5096:function(e,t,a){a.d(t,{A:function(){return p}});var n=a(6768);const l=e=>((0,n.Qi)("data-v-4892cd3c"),e=e(),(0,n.jt)(),e),o=l((()=>(0,n.Lk)("input",{type:"file",id:"file-input"},null,-1)));function s(e,t,a,l,s,i){const r=(0,n.g2)("PictureRounded"),u=(0,n.g2)("el-icon");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("a",{href:"javascript:;",onClick:t[0]||(t[0]=(...e)=>l.handleBg&&l.handleBg(...e))},[(0,n.bF)(u,null,{default:(0,n.k6)((()=>[(0,n.bF)(r)])),_:1})]),o],64)}var i=a(7477),r=a(2933),u={components:{PictureRounded:i.syp},props:["name"],setup(e){const t=`bg-${e.name}`,a=()=>{localStorage.getItem(t)?r.s.confirm("清除背景？","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{o()})).catch((()=>{})):document.getElementById("file-input").click()},l=e=>{const t=e.target.files[0];if(t)try{const e=new FileReader;e.onload=function(e){o(e.target.result)},e.readAsDataURL(t)}catch(a){}e.target.value=""},o=e=>{e?(document.body.className="sunny",localStorage.setItem(t,e),document.body.style=`background-image:url(${e})`):(document.body.className="",document.body.style="",localStorage.setItem(t,""))};return(0,n.sV)((()=>{document.getElementById("file-input").addEventListener("change",l),o(localStorage.getItem(t))})),{handleBg:a}}},c=a(1241);const d=(0,c.A)(u,[["render",s],["__scopeId","data-v-4892cd3c"]]);var p=d},2348:function(e,t,a){a.d(t,{A:function(){return d}});var n=a(6768);function l(e,t,a,l,o,s){const i=(0,n.g2)("el-checkbox"),r=(0,n.g2)("el-col"),u=(0,n.g2)("el-row"),c=(0,n.g2)("el-checkbox-group");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(u,null,{default:(0,n.k6)((()=>[(0,n.bF)(r,{span:8},{default:(0,n.k6)((()=>[(0,n.bF)(i,{modelValue:l.state.checkAll,"onUpdate:modelValue":t[0]||(t[0]=e=>l.state.checkAll=e),onChange:l.handleCheckAllChange,label:"全选",indeterminate:l.state.isIndeterminate},null,8,["modelValue","onChange","indeterminate"])])),_:1})])),_:1}),(0,n.bF)(c,{modelValue:l.state.checkList,"onUpdate:modelValue":t[1]||(t[1]=e=>l.state.checkList=e),onChange:l.handleCheckedChange},{default:(0,n.k6)((()=>[(0,n.bF)(u,null,{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.access,((e,t)=>((0,n.uX)(),(0,n.Wv)(r,{key:t,span:8},{default:(0,n.k6)((()=>[(0,n.bF)(i,{value:e.Value,label:e.Text},null,8,["value","label"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["modelValue","onChange"])],64)}a(4114);var o=a(144),s=a(3830),i=a(5962),r={props:["machineid"],setup(e){const t=(0,s.B)(),a=(0,i.q)(),l=(0,n.EW)((()=>{const e=t.value.config.Client.Accesss;return Object.keys(e).reduce(((a,n,l)=>{if(t.value.hasAccess(n)){const t=e[n];t.Key=n,a.push(t)}return a}),[])})),r=(0,o.Kh)({checkList:[t.value.config.Client.Accesss.Api.Value,t.value.config.Client.Accesss.Web.Value,t.value.config.Client.Accesss.NetManager.Value],checkAll:!1,isIndeterminate:!1}),u=()=>r.checkList.reduce(((e,t)=>(e|t)>>>0),0),c=e=>{const t=e.length;r.checkAll=t===l.value.length,r.isIndeterminate=t>0&&t<l.value.length},d=e=>{r.checkAll=e,r.checkList=e?l.value.map((e=>e.Value)):[],r.isIndeterminate=!1};return(0,n.sV)((()=>{if(a&&a.value.list[e.machineid]){const t=a.value.list[e.machineid];r.checkList=l.value.reduce(((e,a)=>((t&a.Value)>>>0==a.Value&&e.push(a.Value),e)),[])}c(r.checkList)})),{state:r,access:l,getValue:u,handleCheckAllChange:d,handleCheckedChange:c}}},u=a(1241);const c=(0,u.A)(r,[["render",l],["__scopeId","data-v-5b9d3bc4"]]);var d=c},2126:function(e,t,a){a.d(t,{A:function(){return C}});var n=a(6768),l=a(4232);const o=["title"],s={key:0,class:"progress"},i={key:1,class:"progress"};function r(e,t,a,r,u,c){const d=(0,n.g2)("Loading"),p=(0,n.g2)("el-icon"),g=(0,n.g2)("Download"),v=(0,n.g2)("CircleCheck");return(0,n.uX)(),(0,n.CE)("a",{href:"javascript:;",class:(0,l.C4)(["download",r.updaterColor]),onClick:t[0]||(t[0]=e=>r.handleUpdate()),title:r.updaterText},[(0,n.Lk)("span",null,[(0,n.Lk)("span",null,(0,l.v_)(r.item.Version),1),r.updater.list[r.item.MachineId]?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[1==r.updater.list[r.item.MachineId].Status?((0,n.uX)(),(0,n.Wv)(p,{key:0,size:"14",class:"loading"},{default:(0,n.k6)((()=>[(0,n.bF)(d)])),_:1})):2==r.updater.list[r.item.MachineId].Status?((0,n.uX)(),(0,n.Wv)(p,{key:1,size:"14"},{default:(0,n.k6)((()=>[(0,n.bF)(g)])),_:1})):3==r.updater.list[r.item.MachineId].Status||5==r.updater.list[r.item.MachineId].Status?((0,n.uX)(),(0,n.CE)(n.FK,{key:2},[(0,n.bF)(p,{size:"14",class:"loading"},{default:(0,n.k6)((()=>[(0,n.bF)(d)])),_:1}),0==r.updater.list[r.item.MachineId].Length?((0,n.uX)(),(0,n.CE)("span",s,"0%")):((0,n.uX)(),(0,n.CE)("span",i,(0,l.v_)(parseInt(r.updater.list[r.item.MachineId].Current/r.updater.list[r.item.MachineId].Length*100))+"%",1))],64)):6==r.updater.list[r.item.MachineId].Status?((0,n.uX)(),(0,n.Wv)(p,{key:3,size:"14",class:"yellow"},{default:(0,n.k6)((()=>[(0,n.bF)(v)])),_:1})):(0,n.Q3)("",!0)],64)):((0,n.uX)(),(0,n.Wv)(p,{key:1,size:"14"},{default:(0,n.k6)((()=>[(0,n.bF)(g)])),_:1}))])],10,o)}a(4114);var u=a(3830),c=a(144),d=a(1219),p=a(2933),g=a(2248),v=a(920),h=a(7477),m=a(9383),f={props:["item","config"],components:{Download:h.f5X,Loading:h.Rhj,CircleCheck:h.rW7},setup(e){const t=(0,u.B)(),a=(0,n.EW)((()=>t.value.hasAccess("UpdateSelf"))),l=(0,n.EW)((()=>t.value.hasAccess("UpdateOther"))),o=(0,m.T)(),s=(0,n.EW)((()=>t.value.signin.Version)),i=(0,n.EW)((()=>o.value.current.Version)),r=(0,n.EW)((()=>`${i.value}->${o.value.current.DateTime}\n${o.value.current.Msg.map(((e,t)=>`${t+1}、${e}`)).join("\n")}`)),h=(0,n.EW)((()=>o.value.list[e.item.MachineId]?o.value.list[e.item.MachineId].Status<=2?e.item.Version!=s.value?`与服务器版本(${s.value})不一致，建议更新`:i.value!=e.item.Version?`不是最新版本(${i.value})，建议更新\n${r.value}`:`是最新版本，但我无法阻止你喜欢更新\n${r.value}`:{3:"正在下载",4:"已下载",5:"正在解压",6:"已解压，请重启"}[o.value.list[e.item.MachineId].Status]:"未检测到更新")),f=(0,n.EW)((()=>e.item.Version!=s.value?"red":o.value.list[e.item.MachineId]&&i.value!=e.item.Version?"yellow":"green")),k=()=>{if(!e.config)return;if(!a.value)return;const t=o.value.list[e.item.MachineId];if(t)if([0,1,3,5].indexOf(t.Status)>=0)d.nk.error("操作中，请稍后!");else if(6!=t.Status){if(2==t.Status){const t=(0,c.KR)(i.value),a=[(0,n.h)(g.P9,{label:`仅[${e.item.MachineName}] -> ${i.value}(最新版本)`,value:i.value})];e.config&&l.value&&a.push((0,n.h)(g.P9,{label:`[所有] -> ${i.value}(最新版本)`,value:`all->${i.value}`})),e.item.Version!=s.value&&i.value!=s.value&&(a.push((0,n.h)(g.P9,{label:`仅[${e.item.MachineName}] -> ${s.value}(服务器版本)`,value:s.value})),e.config&&l.value&&a.push((0,n.h)(g.P9,{label:`[所有] -> ${s.value}(服务器版本)`,value:`all->${s.value}`}))),(0,p.s)({title:"选择版本",message:()=>(0,n.h)(g.AV,{modelValue:t.value,placeholder:"请选择",style:"width:20rem;","onUpdate:modelValue":e=>{t.value=e}},a),confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{const a={MachineId:e.item.MachineId,Version:t.value.replace("all->",""),All:t.value.indexOf("all->")>=0};a.All&&(a.MachineId=""),(0,v.lJ)(a)})).catch((()=>{}))}}else p.s.confirm("确定关闭程序吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{exit(e.item.MachineId)})).catch((()=>{}));else d.nk.error("未检测到更新")};return{item:(0,n.EW)((()=>e.item)),updater:o,updaterText:h,updaterColor:f,handleUpdate:k}}},k=a(1241);const b=(0,k.A)(f,[["render",r],["__scopeId","data-v-56d38c60"]]);var C=b},7150:function(e,t,a){a.d(t,{A:function(){return ce}});var n=a(6768),l=a(4232),o=a.p+"img/memory.a28433e5.svg",s=a.p+"img/wechat.5c371c5d.jpg",i=a.p+"img/alipay.ff9b1e7c.jpg";const r=e=>((0,n.Qi)("data-v-da8e5ef0"),e=e(),(0,n.jt)(),e),u={class:"status-wrap flex"},c={class:"copy"},d=r((()=>(0,n.Lk)("img",{src:o,alt:"memory"},null,-1))),p=r((()=>(0,n.Lk)("span",null,"赞助",-1))),g=[d,p],v={href:"https://github.com/snltty/linker",target:"_blank"},h=r((()=>(0,n.Lk)("div",{class:"flex-1"},null,-1))),m={class:"export"},f={class:"api"},k={class:"server"},b=r((()=>(0,n.Lk)("div",{class:"pay"},[(0,n.Lk)("img",{src:s,alt:""}),(0,n.Lk)("img",{src:i,alt:""})],-1)));function C(e,t,a,o,s,i){const r=(0,n.g2)("Export"),d=(0,n.g2)("Api"),p=(0,n.g2)("Server"),C=(0,n.g2)("el-dialog");return(0,n.uX)(),(0,n.CE)("div",u,[(0,n.Lk)("div",c,[(0,n.Lk)("a",{href:"javascript:;",class:"memory",title:"赞助一笔，让作者饱餐一顿",onClick:t[0]||(t[0]=e=>o.state.showPay=!0)},g),(0,n.Lk)("a",v,"©linker "+(0,l.v_)(o.self.Version),1)]),h,(0,n.Lk)("div",m,[(0,n.bF)(r,{config:o.config},null,8,["config"])]),(0,n.Lk)("div",f,[(0,n.bF)(d,{config:o.config},null,8,["config"])]),(0,n.Lk)("div",k,[(0,n.bF)(p,{config:o.config},null,8,["config"])]),(0,n.bF)(C,{modelValue:o.state.showPay,"onUpdate:modelValue":t[1]||(t[1]=e=>o.state.showPay=e),title:"赞助linker",width:"300",top:"1vh"},{default:(0,n.k6)((()=>[b])),_:1},8,["modelValue"])])}var w=a(144);const y={href:"javascript:;",title:"此设备的管理接口"};function V(e,t,a,o,s,i){const r=(0,n.g2)("Tools"),u=(0,n.g2)("el-icon"),c=(0,n.g2)("el-popconfirm");return o.config?((0,n.uX)(),(0,n.CE)("div",{key:0,class:(0,l.C4)(["status-api-wrap",{connected:o.connected}])},[(0,n.bF)(c,{"confirm-button-text":"清除","cancel-button-text":"更改",title:"确定你的操作？",onCancel:o.handleShow,onConfirm:o.handleResetConnect},{reference:(0,n.k6)((()=>[(0,n.Lk)("a",y,[(0,n.bF)(u,{size:"16"},{default:(0,n.k6)((()=>[(0,n.bF)(r)])),_:1}),(0,n.eW)(" 管理接口 ")])])),_:1},8,["onCancel","onConfirm"])],2)):(0,n.Q3)("",!0)}var L=a(3830),S=a(4),F=a(7477),_={components:{Tools:F.S0q},props:["config"],setup(e){const t=(0,L.B)(),a=(0,n.EW)((()=>t.value.api.connected)),l=()=>{localStorage.setItem("api-cache",""),window.location.reload()},o=()=>{(0,S.e3)(),(0,S.a1)(`ws://${window.location.hostname}:12345`,"snltty")};return{config:e.config,connected:a,handleShow:o,handleResetConnect:l}}},A=a(1241);const I=(0,A.A)(_,[["render",V],["__scopeId","data-v-4470fcde"]]);var x=I;const E=["title"],W={key:0,class:"progress"},T={key:1,class:"progress"},$={class:"dialog-footer t-c"};function M(e,t,a,o,s,i){const r=(0,n.g2)("Promotion"),u=(0,n.g2)("el-icon"),c=(0,n.g2)("Loading"),d=(0,n.g2)("Download"),p=(0,n.g2)("CircleCheck"),g=(0,n.g2)("el-input"),v=(0,n.g2)("el-form-item"),h=(0,n.g2)("el-form"),m=(0,n.g2)("el-button"),f=(0,n.g2)("el-dialog");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",{class:(0,l.C4)(["status-server-wrap",{connected:o.state.connected}])},[(0,n.Lk)("a",{href:"javascript:;",title:"更改你的连接设置",onClick:t[0]||(t[0]=(...e)=>o.handleConfig&&o.handleConfig(...e))},[(0,n.bF)(u,{size:"16"},{default:(0,n.k6)((()=>[(0,n.bF)(r)])),_:1}),(0,n.eW)(" 信标服务器")]),(0,n.Lk)("a",{href:"javascript:;",title:"服务端的程序版本",onClick:t[1]||(t[1]=(...e)=>o.handleUpdate&&o.handleUpdate(...e)),class:(0,l.C4)(["download",o.updateColor()])},[(0,n.Lk)("span",null,(0,l.v_)(o.state.version),1),o.updaterCurrent.Version?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[1==o.updaterCurrent.Status?((0,n.uX)(),(0,n.Wv)(u,{key:0,size:"14",class:"loading"},{default:(0,n.k6)((()=>[(0,n.bF)(c)])),_:1})):2==o.updaterServer.Status?((0,n.uX)(),(0,n.Wv)(u,{key:1,size:"14"},{default:(0,n.k6)((()=>[(0,n.bF)(d)])),_:1})):3==o.updaterServer.Status||5==o.updaterServer.Status?((0,n.uX)(),(0,n.CE)(n.FK,{key:2},[(0,n.bF)(u,{size:"14",class:"loading"},{default:(0,n.k6)((()=>[(0,n.bF)(c)])),_:1}),0==o.updaterServer.Length?((0,n.uX)(),(0,n.CE)("span",W,"0%")):((0,n.uX)(),(0,n.CE)("span",T,(0,l.v_)(parseInt(o.updaterServer.Current/o.updaterServer.Length*100))+"%",1))],64)):6==o.updaterServer.Status?((0,n.uX)(),(0,n.Wv)(u,{key:3,size:"14",class:"yellow"},{default:(0,n.k6)((()=>[(0,n.bF)(p)])),_:1})):(0,n.Q3)("",!0)],64)):((0,n.uX)(),(0,n.Wv)(u,{key:1,size:"14"},{default:(0,n.k6)((()=>[(0,n.bF)(d)])),_:1}))],10,E)],2),(0,n.bF)(f,{modelValue:o.state.show,"onUpdate:modelValue":t[5]||(t[5]=e=>o.state.show=e),title:"连接设置",width:"300"},{footer:(0,n.k6)((()=>[(0,n.Lk)("div",$,[(0,n.bF)(m,{onClick:t[4]||(t[4]=e=>o.state.show=!1),loading:o.state.loading},{default:(0,n.k6)((()=>[(0,n.eW)("取消")])),_:1},8,["loading"]),(0,n.bF)(m,{type:"primary",onClick:o.handleSave,loading:o.state.loading},{default:(0,n.k6)((()=>[(0,n.eW)("确定保存")])),_:1},8,["onClick","loading"])])])),default:(0,n.k6)((()=>[(0,n.Lk)("div",null,[(0,n.bF)(h,{model:o.state.form,rules:o.state.rules,"label-width":"6rem"},{default:(0,n.k6)((()=>[(0,n.bF)(v,{label:"机器名",prop:"name"},{default:(0,n.k6)((()=>[(0,n.bF)(g,{modelValue:o.state.form.name,"onUpdate:modelValue":t[2]||(t[2]=e=>o.state.form.name=e),maxlength:"12","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,n.bF)(v,{label:"分组名",prop:"groupid"},{default:(0,n.k6)((()=>[(0,n.bF)(g,{modelValue:o.state.form.groupid,"onUpdate:modelValue":t[3]||(t[3]=e=>o.state.form.groupid=e),type:"password","show-password":"",maxlength:"36","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue"])],64)}var X=a(9299),z=a(1219),B=a(2933),U=a(920),K={components:{Promotion:F.Yk4,Download:F.f5X,Loading:F.Rhj,CircleCheck:F.rW7},props:["config"],setup(e){const t=(0,L.B)(),a=(0,n.EW)((()=>t.value.hasAccess("Config"))),l=(0,n.EW)((()=>t.value.hasAccess("UpdateServer"))),o=(0,w.KR)({Version:"",Msg:[],DateTime:"",Status:0,Length:0,Current:0}),s=(0,w.KR)({Version:"",Status:0,Length:0,Current:0}),i=(0,n.EW)((()=>`${o.value.Version}->${o.value.DateTime}\n${o.value.Msg.map(((e,t)=>`${t+1}、${e}`)).join("\n")}`)),r=(0,w.Kh)({show:!1,loading:!1,connected:(0,n.EW)((()=>t.value.signin.Connected)),version:(0,n.EW)((()=>t.value.signin.Version)),form:{name:t.value.config.Client.Name,groupid:t.value.config.Client.GroupId},rules:{}}),u=()=>{(0,U.Vk)().then((e=>{o.value.DateTime=e.DateTime,o.value.Version=e.Version,o.value.Status=e.Status,o.value.Length=e.Length,o.value.Current=e.Current,o.value.Msg=e.Msg,setTimeout((()=>{u()}),1e3)})).catch((()=>{setTimeout((()=>{u()}),1e3)}))},c=()=>{(0,U.BJ)().then((e=>{s.value.Version=e.Version,s.value.Status=e.Status,s.value.Length=e.Length,s.value.Current=e.Current,s.value.Status>2&&s.value.Status<6&&setTimeout((()=>{c()}),1e3)})).catch((()=>{setTimeout((()=>{c()}),1e3)}))},d=()=>o.value.Version?s.value.Status<=2?r.version!=o.value.Version?`不是最新版本(${o.value.Version})，建议更新\n${i.value}`:`是最新版本，但我无法阻止你喜欢更新\n${i.value}`:{3:"正在下载",4:"已下载",5:"正在解压",6:"已解压，请重启"}[s.value.Status]:"未检测到更新",p=()=>r.version!=o.value.Version?"yellow":"green",g=()=>{e.config&&l.value&&(o.value.Version?[0,1,3,5].indexOf(s.value.Status)>=0?z.nk.error("操作中，请稍后!"):6!=s.value.Status?2==o.value.Status&&B.s.confirm("确定更新服务端吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,U.y2)(o.value.Version).then((()=>{setTimeout((()=>{c()}),1e3)}))})).catch((()=>{})):B.s.confirm("确定关闭服务端吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,U.aP)()})).catch((()=>{})):z.nk.error("未检测到更新"))},v=()=>{e.config&&a.value&&(r.form.name=t.value.config.Client.Name,r.form.groupid=t.value.config.Client.GroupId,r.show=!0)},h=()=>{r.loading=!0,(0,X.rd)(r.form).then((()=>{r.loading=!1,r.show=!1,z.nk.success("已操作")})).catch((e=>{r.loading=!1,z.nk.success("操作失败!")}))};return(0,n.sV)((()=>{u(),c()})),{config:e.config,state:r,handleConfig:v,handleSave:h,updaterCurrent:o,updaterServer:s,handleUpdate:g,updateText:d,updateColor:p}}};const j=(0,A.A)(K,[["render",M],["__scopeId","data-v-360b8353"]]);var D=j;const N=e=>((0,n.Qi)("data-v-146e7c02"),e=e(),(0,n.jt)(),e),P={key:0,class:"status-export-wrap"},G={class:"port-wrap"},R=N((()=>(0,n.Lk)("div",{class:"text"}," 导出配置，作为子设备运行，如果使用docker，容器映射configs文件夹即可 ",-1))),O={class:"body"},Q={class:"card-header"},J={class:"flex",style:{"margin-bottom":"1rem"}},q={style:{"margin-left":"2rem"}},Y=N((()=>(0,n.Lk)("span",null,"设备名 : ",-1))),H=N((()=>(0,n.Lk)("span",null,"管理密码 : ",-1))),Z={class:"flex"},ee=N((()=>(0,n.Lk)("span",null,"Action参数(自定义验证) : ",-1)));function te(e,t,a,l,o,s){const i=(0,n.g2)("Share"),r=(0,n.g2)("el-icon"),u=(0,n.g2)("el-checkbox"),c=(0,n.g2)("el-popover"),d=(0,n.g2)("el-input"),p=(0,n.g2)("Access"),g=(0,n.g2)("el-card"),v=(0,n.g2)("el-button"),h=(0,n.g2)("el-dialog");return l.config&&l.hasExport?((0,n.uX)(),(0,n.CE)("div",P,[(0,n.Lk)("a",{href:"javascript:;",title:"此设备的管理接口",onClick:t[0]||(t[0]=e=>l.state.show=!0)},[(0,n.bF)(r,{size:"16"},{default:(0,n.k6)((()=>[(0,n.bF)(i)])),_:1}),(0,n.eW)(" 导出配置 ")]),(0,n.bF)(h,{class:"options-center",title:"导出配置","destroy-on-close":"",modelValue:l.state.show,"onUpdate:modelValue":t[6]||(t[6]=e=>l.state.show=e),center:"",width:"580",top:"1vh"},{footer:(0,n.k6)((()=>[(0,n.bF)(v,{plain:"",onClick:t[5]||(t[5]=e=>l.state.show=!1),loading:l.state.loading},{default:(0,n.k6)((()=>[(0,n.eW)("取消")])),_:1},8,["loading"]),(0,n.bF)(v,{type:"success",plain:"",onClick:l.handleExport,loading:l.state.loading},{default:(0,n.k6)((()=>[(0,n.eW)("确定导出")])),_:1},8,["onClick","loading"])])),default:(0,n.k6)((()=>[(0,n.Lk)("div",G,[R,(0,n.Lk)("div",O,[(0,n.bF)(g,{shadow:"never"},{header:(0,n.k6)((()=>[(0,n.Lk)("div",Q,[(0,n.Lk)("div",J,[(0,n.Lk)("div",null,[(0,n.bF)(c,{placement:"top-start",title:"tips",width:200,trigger:"hover",content:"这将生成唯一ID，多台设备使用产生冲突，挤压下线"},{reference:(0,n.k6)((()=>[(0,n.bF)(u,{disabled:l.onlyNode,modelValue:l.state.single,"onUpdate:modelValue":t[1]||(t[1]=e=>l.state.single=e),label:"单设备"},null,8,["disabled","modelValue"])])),_:1})]),(0,n.Lk)("div",q,[Y,(0,n.bF)(d,{disabled:!l.state.single,modelValue:l.state.name,"onUpdate:modelValue":t[2]||(t[2]=e=>l.state.name=e),maxlength:"12","show-word-limit":"",style:{width:"15rem"}},null,8,["disabled","modelValue"])]),(0,n.Lk)("div",null,[H,(0,n.bF)(d,{type:"password","show-password":"",disabled:l.onlyNode,modelValue:l.state.apipassword,"onUpdate:modelValue":t[3]||(t[3]=e=>l.state.apipassword=e),maxlength:"36","show-word-limit":"",style:{width:"15rem"}},null,8,["disabled","modelValue"])])]),(0,n.Lk)("div",Z,[(0,n.Lk)("div",null,[ee,(0,n.bF)(d,{modelValue:l.state.actionArg,"onUpdate:modelValue":t[4]||(t[4]=e=>l.state.actionArg=e),style:{width:"34.2rem"}},null,8,["modelValue"])])])])])),default:(0,n.k6)((()=>[(0,n.bF)(p,{ref:"accessDom",machineid:l.machineId},null,8,["machineid"])])),_:1})])])])),_:1},8,["modelValue"])])):(0,n.Q3)("",!0)}var ae=a(8835),ne=a(2348),le={components:{Share:F.SYj,Access:ne.A},props:["config"],setup(e){const t=(0,L.B)(),a=(0,n.EW)((()=>t.value.hasAccess("Export"))),l=(0,n.EW)((()=>t.value.config.Client.OnlyNode)),o=(0,n.EW)((()=>t.value.config.Client.Id)),s=(0,w.Kh)({show:!1,loading:!1,single:!0,name:"",actionArg:t.value.config.Client.ServerInfo.Arg||"",apipassword:t.value.config.Client.CApi.ApiPassword}),i=(0,w.KR)(null),r=()=>{if(!a.value)return;const e={access:i.value.getValue(),single:s.single,name:s.name,actionArg:s.actionArg,apipassword:s.apipassword};if(e.actionArg)try{if("object"!=typeof JSON.parse(e.actionArg))return void z.nk.error("Action参数错误，需要JSON格式")}catch(t){return void z.nk.error("Action参数错误，需要JSON格式")}if(e.single){if(!e.name)return void z.nk.error("请输入设备名")}else e.name="";if(!e.single||s.name)return e;z.nk.error("请输入管理密码")},u=()=>{const e=document.createElement("a");s.single?e.download=`client-node-export-${s.name}.zip`:e.download="client-node-export.zip",e.href="/client-node-export.zip",document.body.appendChild(e),e.click(),document.body.removeChild(e)},c=()=>{const e=r();e&&(s.loading=!0,(0,ae.P$)(e).then((()=>{s.loading=!1,s.show=!1,z.nk.success("导出成功"),u()})).catch((()=>{s.loading=!1})))};return{config:e.config,onlyNode:l,hasExport:a,machineId:o,state:s,accessDom:i,handleExport:c}}};const oe=(0,A.A)(le,[["render",te],["__scopeId","data-v-146e7c02"]]);var se=oe,ie=a(2126),re={components:{Api:x,Server:D,Export:se,UpdaterBtn:ie.A},props:["config"],setup(e){const t=(0,L.B)(),a=(0,n.EW)((()=>t.value.self)),l=(0,w.Kh)({showPay:!1});return{state:l,config:e.config,self:a}}};const ue=(0,A.A)(re,[["render",C],["__scopeId","data-v-da8e5ef0"]]);var ce=ue}}]);