"use strict";(self["webpackChunklinker_web"]=self["webpackChunklinker_web"]||[]).push([[9],{5837:function(e,l,a){a.r(l),a.d(l,{default:function(){return te}});var t=a(6768);const n={class:"net-wrap app-wrap"},o={class:"inner absolute flex flex-column flex-nowrap"},r={class:"head"},s={class:"body flex-1 relative"},u={class:"status"};function d(e,l,a,d,i,c){const h=(0,t.g2)("Head"),m=(0,t.g2)("List"),p=(0,t.g2)("Status");return(0,t.uX)(),(0,t.CE)("div",n,[(0,t.Lk)("div",o,[(0,t.Lk)("div",r,[(0,t.bF)(h)]),(0,t.Lk)("div",s,[(0,t.bF)(m)]),(0,t.Lk)("div",u,[(0,t.bF)(p,{config:!1})])])])}var i=a(3830);const c=e=>((0,t.Qi)("data-v-85710086"),e=e(),(0,t.jt)(),e),h={class:"head-wrap"},m={class:"tools flex"},p=c((()=>(0,t.Lk)("span",{class:"label"},"服务器 ",-1))),g=c((()=>(0,t.Lk)("span",{class:"flex-1"},null,-1))),v={class:"dialog-footer t-c"};function f(e,l,a,n,o,r){const s=(0,t.g2)("el-option"),u=(0,t.g2)("el-select"),d=(0,t.g2)("Edit"),i=(0,t.g2)("el-icon"),c=(0,t.g2)("el-button"),f=(0,t.g2)("Refresh"),k=(0,t.g2)("el-input"),w=(0,t.g2)("el-form-item"),F=(0,t.g2)("el-form"),b=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.Lk)("div",h,[(0,t.Lk)("div",m,[p,(0,t.bF)(u,{modelValue:n.state.server,"onUpdate:modelValue":l[0]||(l[0]=e=>n.state.server=e),placeholder:"服务器",style:{width:"12rem"},size:"small"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(n.state.servers,(e=>((0,t.uX)(),(0,t.Wv)(s,{key:e.Host,label:e.Name,value:e.Host},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),g,(0,t.bF)(c,{size:"small",onClick:n.handleEdit},{default:(0,t.k6)((()=>[(0,t.eW)(" 编辑"),(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)(d)])),_:1})])),_:1},8,["onClick"]),(0,t.bF)(c,{size:"small",onClick:n.handleRefresh},{default:(0,t.k6)((()=>[(0,t.eW)(" 刷新(F5)"),(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)(f)])),_:1})])),_:1},8,["onClick"])])]),(0,t.bF)(b,{modelValue:n.state.show,"onUpdate:modelValue":l[5]||(l[5]=e=>n.state.show=e),title:"设置",width:"260"},{footer:(0,t.k6)((()=>[(0,t.Lk)("div",v,[(0,t.bF)(c,{onClick:l[4]||(l[4]=e=>n.state.show=!1),loading:n.state.loading},{default:(0,t.k6)((()=>[(0,t.eW)("取消")])),_:1},8,["loading"]),(0,t.bF)(c,{type:"primary",onClick:n.handleSave,loading:n.state.loading},{default:(0,t.k6)((()=>[(0,t.eW)("确定保存")])),_:1},8,["onClick","loading"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",null,[(0,t.bF)(F,{model:n.state.form,rules:n.state.rules,"label-width":"7rem"},{default:(0,t.k6)((()=>[(0,t.bF)(w,{label:"服务器",prop:"host"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{modelValue:n.state.form.host,"onUpdate:modelValue":l[1]||(l[1]=e=>n.state.form.host=e)},null,8,["modelValue"])])),_:1}),(0,t.bF)(w,{label:"中继密钥",prop:"relaySecretKey"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{modelValue:n.state.form.relaySecretKey,"onUpdate:modelValue":l[2]||(l[2]=e=>n.state.form.relaySecretKey=e),type:"password","show-password":"",maxlength:"36","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,t.bF)(w,{label:"分组号",prop:"groupid"},{default:(0,t.k6)((()=>[(0,t.bF)(k,{modelValue:n.state.form.groupid,"onUpdate:modelValue":l[3]||(l[3]=e=>n.state.form.groupid=e),type:"password","show-password":"",maxlength:"36","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue"])],64)}var k=a(144),w=a(7477),F=a(4);const b=e=>(0,F.zG)("netclient/save",e);var C=a(1219),L={components:{Edit:w.ffu,Refresh:w.C42},setup(){const e=(0,i.B)(),l=(0,k.Kh)({server:"linker.snltty.com:1802",servers:[],groupid:"snltty",show:!1,loading:!1,form:{host:"",relaySecretKey:"",groupid:""},rules:{}});(0,t.wB)((()=>e.value.config.Running.Client.Servers),(()=>{l.servers=(e.value.config.Running.Client.Servers||[]).slice(0,1),l.server=e.value.config.Client.Server,l.groupid=e.value.config.Client.GroupId}));const a=()=>{l.form.host=l.server,l.form.groupid=l.groupid,l.form.relaySecretKey=e.value.config.Running.Relay.Servers.filter((e=>e.Host==l.form.host))[0].SecretKey,l.show=!0},n=()=>{l.loading=!0,b(l.form).then((()=>{l.loading=!1,l.show=!1,C.nk.success("操作成功!")})).catch((()=>{l.loading=!1,C.nk.error("操作失败!")}))},o=()=>{window.location.reload()};return{state:l,handleRefresh:o,handleEdit:a,handleSave:n}}},y=a(1241);const V=(0,y.A)(L,[["render",f],["__scopeId","data-v-85710086"]]);var P=V;const S=e=>((0,t.Qi)("data-v-09f507a4"),e=e(),(0,t.jt)(),e),_={class:"net-list-wrap flex flex-column absolute"},E={class:"flex-1 scrollbar"},x={class:"flex"},I=S((()=>(0,t.Lk)("div",{class:"flex-1"},null,-1))),D={class:"tuntap"},U={class:"page t-c"},z={class:"page-wrap t-c"};function A(e,l,a,n,o,r){const s=(0,t.g2)("DeviceName"),u=(0,t.g2)("UpdaterBtn"),d=(0,t.g2)("TuntapShow"),i=(0,t.g2)("el-pagination"),c=(0,t.g2)("TuntapEdit"),h=(0,t.g2)("DeviceEdit");return(0,t.uX)(),(0,t.CE)("div",_,[(0,t.Lk)("div",E,[(0,t.Lk)("ul",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(n.devices.page.List,((e,l)=>((0,t.uX)(),(0,t.CE)("li",{key:l},[(0,t.Lk)("dl",null,[(0,t.Lk)("dt",x,[(0,t.Lk)("div",null,[(0,t.bF)(s,{onEdit:n.handleDeviceEdit,item:e},null,8,["onEdit","item"])]),I,(0,t.Lk)("div",null,[(0,t.bF)(u,{config:!1,item:e},null,8,["item"])])]),(0,t.Lk)("dd",D,[n.tuntap.list[e.MachineId]?((0,t.uX)(),(0,t.Wv)(d,{key:0,onEdit:n.handleTuntapEdit,item:e},null,8,["onEdit","item"])):(0,t.Q3)("",!0)])])])))),128))])]),(0,t.Lk)("div",U,[(0,t.Lk)("div",z,[(0,t.bF)(i,{size:"small",background:"",layout:"prev,pager, next","pager-count":5,total:n.devices.page.Count,"page-size":n.devices.page.Request.Size,"current-page":n.devices.page.Request.Page,onCurrentChange:n.handlePageChange,onSizeChange:n.handlePageSizeChange,"page-sizes":[10,20,50,100,255]},null,8,["total","page-size","current-page","onCurrentChange","onSizeChange"])])]),n.tuntap.showEdit?((0,t.uX)(),(0,t.Wv)(c,{key:0,modelValue:n.tuntap.showEdit,"onUpdate:modelValue":l[0]||(l[0]=e=>n.tuntap.showEdit=e),onChange:n.handleTuntapRefresh},null,8,["modelValue","onChange"])):(0,t.Q3)("",!0),n.devices.showDeviceEdit?((0,t.uX)(),(0,t.Wv)(h,{key:1,modelValue:n.devices.showDeviceEdit,"onUpdate:modelValue":l[1]||(l[1]=e=>n.devices.showDeviceEdit=e),onChange:n.handlePageChange,data:n.devices.deviceInfo},null,8,["modelValue","onChange","data"])):(0,t.Q3)("",!0)])}var T=a(8104),R=a(7985),W=a(9383),K=a(3929),X=a(5649),B=a(8809),N=a(9120);const Q=e=>((0,t.Qi)("data-v-9e9e60a4"),e=e(),(0,t.jt)(),e),G=Q((()=>(0,t.Lk)("span",null,"/",-1))),H={class:"t-c w-100"};function M(e,l,a,n,o,r){const s=(0,t.g2)("el-form-item"),u=(0,t.g2)("el-input"),d=(0,t.g2)("el-checkbox"),i=(0,t.g2)("el-button"),c=(0,t.g2)("el-form"),h=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.Wv)(h,{modelValue:n.state.show,"onUpdate:modelValue":l[5]||(l[5]=e=>n.state.show=e),"close-on-click-modal":!1,title:"组网设置",top:"1vh",width:"270"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",null,[(0,t.bF)(c,{ref:"ruleFormRef",model:n.state.ruleForm,rules:n.state.rules,"label-width":"0"},{default:(0,t.k6)((()=>[(0,t.bF)(s,{prop:"gateway",style:{"margin-bottom":"0"}},{default:(0,t.k6)((()=>[(0,t.eW)(" 赐予此设备IP，其它设备可通过此IP访问 ")])),_:1}),(0,t.bF)(s,{label:"",prop:"IP",style:{"margin-bottom":"0"}},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:n.state.ruleForm.IP,"onUpdate:modelValue":l[0]||(l[0]=e=>n.state.ruleForm.IP=e),style:{width:"14rem"}},null,8,["modelValue"]),G,(0,t.bF)(u,{onChange:n.handlePrefixLengthChange,modelValue:n.state.ruleForm.PrefixLength,"onUpdate:modelValue":l[1]||(l[1]=e=>n.state.ruleForm.PrefixLength=e),style:{width:"4rem"}},null,8,["onChange","modelValue"])])),_:1}),(0,t.bF)(s,{label:"",prop:"ShowDelay"},{default:(0,t.k6)((()=>[(0,t.bF)(d,{modelValue:n.state.ruleForm.ShowDelay,"onUpdate:modelValue":l[2]||(l[2]=e=>n.state.ruleForm.ShowDelay=e),label:"显示延迟",size:"large"},null,8,["modelValue"]),(0,t.bF)(d,{modelValue:n.state.ruleForm.AutoConnect,"onUpdate:modelValue":l[3]||(l[3]=e=>n.state.ruleForm.AutoConnect=e),label:"自动连接？",size:"large"},null,8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"",prop:"Btns"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",H,[(0,t.bF)(i,{onClick:l[4]||(l[4]=e=>n.state.show=!1)},{default:(0,t.k6)((()=>[(0,t.eW)("取消")])),_:1}),(0,t.bF)(i,{type:"primary",onClick:n.handleSave},{default:(0,t.k6)((()=>[(0,t.eW)("确认")])),_:1},8,["onClick"])])])),_:1})])),_:1},8,["model","rules"])])])),_:1},8,["modelValue"])}a(4114);var j=a(5241),O={props:["modelValue"],emits:["change","update:modelValue"],components:{Delete:w.epd,Plus:w.FWt},setup(e,{emit:l}){const a=(0,i.B)(),n=(0,T.W)(),o=(0,k.KR)(null),r=(0,k.Kh)({show:!0,bufferSize:a.value.bufferSize,ruleForm:{IP:n.value.current.IP,LanIPs:n.value.current.LanIPs.slice(0),Masks:n.value.current.Masks.slice(0),PrefixLength:n.value.current.PrefixLength||24,Gateway:n.value.current.Gateway,ShowDelay:n.value.current.ShowDelay,AutoConnect:n.value.current.AutoConnect,Upgrade:n.value.current.Upgrade,Forwards:0==n.value.current.Forwards.length?[{ListenAddr:"0.0.0.0",ListenPort:0,ConnectAddr:"0.0.0.0",ConnectPort:0}]:n.value.current.Forwards.slice(0)},rules:{}});(0,t.wB)((()=>r.show),(e=>{e||setTimeout((()=>{l("update:modelValue",e)}),300)}));const s=()=>{var e=+r.ruleForm.PrefixLength;(e>32||e<16||isNaN(e))&&(e=24),r.ruleForm.PrefixLength=e},u=()=>{const e=JSON.parse(JSON.stringify(n.value.current));e.IP=r.ruleForm.IP||"0.0.0.0";const{lanips:a,masks:t}=r.ruleForm.LanIPs.reduce(((e,l,a)=>(l&&r.ruleForm.Masks[a]&&(e.lanips.push(l),e.masks.push(r.ruleForm.Masks[a])),e)),{lanips:[],masks:[]});e.LanIPs=a,e.Masks=t,e.PrefixLength=+r.ruleForm.PrefixLength,e.Gateway=r.ruleForm.Gateway,e.ShowDelay=r.ruleForm.ShowDelay,e.AutoConnect=r.ruleForm.AutoConnect,e.Upgrade=r.ruleForm.Upgrade,e.Forwards=r.ruleForm.Forwards,e.Forwards.forEach((e=>{e.ListenPort=+e.ListenPort,e.ConnectPort=+e.ConnectPort})),(0,j.ac)(e).then((()=>{r.show=!1,C.nk.success("已操作！"),l("change")})).catch((()=>{C.nk.error("操作失败！")}))};return{state:r,ruleFormRef:o,handlePrefixLengthChange:s,handleSave:u}}};const q=(0,y.A)(O,[["render",M],["__scopeId","data-v-9e9e60a4"]]);var J=q,Y={components:{StarFilled:w.BQ2,UpdaterBtn:K.A,DeviceName:X.A,DeviceEdit:B.A,TuntapShow:N.A,TuntapEdit:J},setup(e){(0,i.B)();const l=(0,k.Kh)({}),{devices:a,machineId:n,_getSignList:o,_getSignList1:r,handleDeviceEdit:s,handlePageChange:u,handlePageSizeChange:d,handleDel:c,clearDevicesTimeout:h}=(0,R.r)(),{tuntap:m,_getTuntapInfo:p,handleTuntapRefresh:g,clearTuntapTimeout:v,handleTuntapEdit:f,sortTuntapIP:w}=(0,T.O)(),{_getUpdater:b,clearUpdaterTimeout:C}=(0,W.d)();return(0,t.sV)((()=>{(0,F.jH)((e=>{e&&(u(),o(),g())})),o(),r(),p(),b()})),(0,t.hi)((()=>{h(),v(),C()})),{state:l,devices:a,handleDeviceEdit:s,machineId:n,handlePageChange:u,handlePageSizeChange:d,handleDel:c,tuntap:m,handleTuntapEdit:f,handleTuntapRefresh:g}}};const Z=(0,y.A)(Y,[["render",A],["__scopeId","data-v-09f507a4"]]);var $=Z,ee=a(8233),le={components:{Head:P,List:$,Status:ee.A},setup(){return(0,i.v)(),document.addEventListener("contextmenu",(function(e){e.preventDefault()})),{}}};const ae=(0,y.A)(le,[["render",d],["__scopeId","data-v-fae0ef60"]]);var te=ae}}]);